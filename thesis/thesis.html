<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title></title> 
<!--<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)">
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="thesis.tex"> 
<meta name="date" content="2016-05-08 23:47:00">
<link rel="stylesheet" type="text/css" href="thesis/thesis.css">
</head><body 
>

<form action="http://games.fkmt.de/docuPdf">
      <input type="submit" value="Download as PDF">
</form>

                                                                                         
<!--l. 5--><p class="noindent" >
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 7--><p class="noindent" >
<!--l. 10--><p class="noindent" >      <span 
class="ecbx-2488">Design and Development of a</span>
   <span 
class="ecbx-2488">Business-Game-Architecture for</span>
          <span 
class="ecbx-2488">Round-Based Games:</span>
<span 
class="ecbx-2488">Business Game Description (BGD)</span>
<span 
class="ecbx-2488">and Business Game Engine (BGE)</span>
<!--l. 12--><p class="noindent" >Master thesis at Information Services and Electronic Markets<br />
Prof. Dr. Andreas Geyer-Schulz <br />
Institute of Information Systems and Marketing<br />
Department of Economics and Business Engineering<br />
Karlsruhe Institute of Technology<br /><br />
of<br />
<span 
class="ecbx-1200">Felix Kiechle </span><br />
Registration Number: 1454042 
<!--l. 22--><p class="noindent" >Supervisor:<br />
<div class="tabular"> <table id="TBL-1" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-1-1"  
class="td11"> Prof. Dr. Andreas Geyer-Schulz   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-1"  
class="td11"> M.Sc. Fabian Ball                      </td>
</tr><tr  
 style="    vertical-align:baseline;" id="TBL-1-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-3-1"
class="td11">                              </td>
</tr></table></div>
<div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1"><col 
id="TBL-2-2"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"  
class="td11">                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-1"  
class="td11"> Date of Submission:</td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-2"  
class="td11"> 11. January 2016   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"  
class="td11">                   </td>
</tr></table></div>
</div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
_________________________________________________________________________________________
<!--l. 5--><p class="noindent" >Ich versichere hiermit wahrheitsgemäß, die Arbeit selbständig angefertigt, alle benutzten
Hilfsmittel vollständig und genau angegeben und alles kenntlich gemacht zu haben, was aus
Arbeiten anderer unverändert oder mit Abänderung entnommen wurde.
<!--l. 7--><p class="noindent" >Ich stimme der Publikation dieser Arbeit auf der Webseite der Abteilung für Informationsdienste
und elektronische Märkte des Instituts für Informationswirtschaft und Marketing am Karlsruher
Institut für Technologie (KIT) zu.
<!--l. 9--><p class="noindent" >Karlsruhe, den 11. January 2016 
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!--l. 134--><p class="noindent" >
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!--l. 2--><p class="noindent" >Thanks to Jonas Brügner for discussions and ideas on the architecture design and Fabian Ball and
Andreas Sonnenbichler for advice on the definition of the framework for round-based
games.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!--l. 143--><p class="noindent" >
                                                                                         
                                                                                         
<h2 class="likechapterHead"><a 
 id="x1-1000"></a>Contents</h2> <div class="tableofcontents">
<span class="chapterToc" >1 <a 
href="#x1-30001" id="QQ2-1-3">Introduction</a></span>
<br /><span class="chapterToc" >2 <a 
href="#x1-40002" id="QQ2-1-4">Related work</a></span>
<br />&#x00A0;<span class="sectionToc" >2.1 <a 
href="#x1-50002.1" id="QQ2-1-5">Business games</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >2.1.1 <a 
href="#x1-60002.1.1" id="QQ2-1-6">History and purpose</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >2.1.2 <a 
href="#x1-70002.1.2" id="QQ2-1-7">Taxonomy</a></span>
<br />&#x00A0;<span class="sectionToc" >2.2 <a 
href="#x1-80002.2" id="QQ2-1-8">Stand-alone applications</a></span>
<br />&#x00A0;<span class="sectionToc" >2.3 <a 
href="#x1-90002.3" id="QQ2-1-9">Frameworks</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >2.3.1 <a 
href="#x1-100002.3.1" id="QQ2-1-10">Business Model Description Language (BMDL) and Business
Model Development System (BMDS)</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >2.3.1.1 <a 
href="#x1-110002.3.1.1" id="QQ2-1-11">BMDL</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >2.3.1.2 <a 
href="#x1-120002.3.1.2" id="QQ2-1-15">BMDS</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >2.3.2 <a 
href="#x1-130002.3.2" id="QQ2-1-16">Yokohama Business Game (YBG)</a></span>
<br /><span class="chapterToc" >3 <a 
href="#x1-140003" id="QQ2-1-17">The game class supported by BGE</a></span>
<br />&#x00A0;<span class="sectionToc" >3.1 <a 
href="#x1-150003.1" id="QQ2-1-18">Common features</a></span>
<br />&#x00A0;<span class="sectionToc" >3.2 <a 
href="#x1-160003.2" id="QQ2-1-19">N-player round-based games</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.2.1 <a 
href="#x1-170003.2.1" id="QQ2-1-20">A general framework</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.2.2 <a 
href="#x1-180003.2.2" id="QQ2-1-21">Applying the framework</a></span>
<br /><span class="chapterToc" >4 <a 
href="#x1-230004" id="QQ2-1-27">Architecture design</a></span>
<br />&#x00A0;<span class="sectionToc" >4.1 <a 
href="#x1-240004.1" id="QQ2-1-28">Software requirements</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.1.1 <a 
href="#x1-250004.1.1" id="QQ2-1-29">Description mechanism</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.1.2 <a 
href="#x1-260004.1.2" id="QQ2-1-30">Game development environment</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.1.3 <a 
href="#x1-270004.1.3" id="QQ2-1-31">Simulation environment</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.1.4 <a 
href="#x1-280004.1.4" id="QQ2-1-32">Playing environment</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.1.5 <a 
href="#x1-290004.1.5" id="QQ2-1-33">Analysis environment</a></span>
<br />&#x00A0;<span class="sectionToc" >4.2 <a 
href="#x1-300004.2" id="QQ2-1-34">Business Game Description (BGD)</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.2.1 <a 
href="#x1-310004.2.1" id="QQ2-1-35">BGD object model</a></span>
                                                                                         
                                                                                         
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.1.1 <a 
href="#x1-320004.2.1.1" id="QQ2-1-37">Parameter object</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.1.2 <a 
href="#x1-330004.2.1.2" id="QQ2-1-38">Variable object</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.1.3 <a 
href="#x1-370004.2.1.3" id="QQ2-1-42">Score function</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.1.4 <a 
href="#x1-380004.2.1.4" id="QQ2-1-43">Questionnaire object</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.1.5 <a 
href="#x1-390004.2.1.5" id="QQ2-1-44">Utility and Mathematics object</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.2.2 <a 
href="#x1-430004.2.2" id="QQ2-1-48">BGD development</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.2.1 <a 
href="#x1-440004.2.2.1" id="QQ2-1-49">Automatic game verification</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.2.2 <a 
href="#x1-470004.2.2.2" id="QQ2-1-52">Security considerations</a></span>
<br />&#x00A0;<span class="sectionToc" >4.3 <a 
href="#x1-500004.3" id="QQ2-1-55">Business Game Engine (BGE)</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.1 <a 
href="#x1-510004.3.1" id="QQ2-1-56">Development environment</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >4.3.2 <a 
href="#x1-520004.3.2" id="QQ2-1-57">Simulation and playing environment</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.2.1 <a 
href="#x1-530004.3.2.1" id="QQ2-1-58">Player</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.2.2 <a 
href="#x1-540004.3.2.2" id="QQ2-1-59">Round</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >4.3.2.3 <a 
href="#x1-550004.3.2.3" id="QQ2-1-60">Game and simulation flow</a></span>
<br /><span class="chapterToc" >5 <a 
href="#x1-580005" id="QQ2-1-63">Implementation</a></span>
<br />&#x00A0;<span class="sectionToc" >5.1 <a 
href="#x1-590005.1" id="QQ2-1-65">Choice of technology</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.1.1 <a 
href="#x1-600005.1.1" id="QQ2-1-66">BGD object model</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.1.2 <a 
href="#x1-610005.1.2" id="QQ2-1-67">Client-server-communication: the WebSocket Protocol</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.1.3 <a 
href="#x1-620005.1.3" id="QQ2-1-68">Server-side JavaScript</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >5.1.3.1 <a 
href="#x1-630005.1.3.1" id="QQ2-1-69">Asynchronous execution model of JavaScript</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >5.1.3.2 <a 
href="#x1-640005.1.3.2" id="QQ2-1-71">JavaScript on the server: Node.js</a></span>
<br />&#x00A0;&#x00A0;&#x00A0;<span class="subsubsectionToc" >5.1.3.3 <a 
href="#x1-650005.1.3.3" id="QQ2-1-75">The big picture: Two event loops and WebSockets</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.1.4 <a 
href="#x1-660005.1.4" id="QQ2-1-77">NoSQL Database</a></span>
<br />&#x00A0;<span class="sectionToc" >5.2 <a 
href="#x1-670005.2" id="QQ2-1-78">Module realisation</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.2.1 <a 
href="#x1-680005.2.1" id="QQ2-1-79">Startpage</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.2.2 <a 
href="#x1-690005.2.2" id="QQ2-1-81">Online editor and feedback screen</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.2.3 <a 
href="#x1-700005.2.3" id="QQ2-1-83">Entrance hall and game engine</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.2.4 <a 
href="#x1-710005.2.4" id="QQ2-1-87">Game analysis</a></span>
<br />&#x00A0;<span class="sectionToc" >5.3 <a 
href="#x1-720005.3" id="QQ2-1-88">Dependencies</a></span>
<br />&#x00A0;<span class="sectionToc" >5.4 <a 
href="#x1-730005.4" id="QQ2-1-90">Installation guide</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.4.1 <a 
href="#x1-740005.4.1" id="QQ2-1-91">Prerequisites</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.4.2 <a 
href="#x1-750005.4.2" id="QQ2-1-92">BGE installation</a></span>
                                                                                         
                                                                                         
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.4.3 <a 
href="#x1-760005.4.3" id="QQ2-1-93">Run it locally</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.4.4 <a 
href="#x1-770005.4.4" id="QQ2-1-94">Deployment</a></span>
<br /><span class="chapterToc" >6 <a 
href="#x1-780006" id="QQ2-1-95">Conclusion and outlook</a></span>
<br />&#x00A0;<span class="sectionToc" >6.1 <a 
href="#x1-790006.1" id="QQ2-1-96">Conclusion</a></span>
<br />&#x00A0;<span class="sectionToc" >6.2 <a 
href="#x1-800006.2" id="QQ2-1-97">Future work</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >6.2.1 <a 
href="#x1-810006.2.1" id="QQ2-1-98">Roles</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >6.2.2 <a 
href="#x1-820006.2.2" id="QQ2-1-99">Advanced entrance hall</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >6.2.3 <a 
href="#x1-830006.2.3" id="QQ2-1-100">Advanced analysis environment</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >6.2.4 <a 
href="#x1-840006.2.4" id="QQ2-1-102">Tabular output</a></span>
<br /><span class="appendixToc" >A <a 
href="#x1-85000A" id="QQ2-1-104">Appendix</a></span>
<br />&#x00A0;<span class="sectionToc" >A.1 <a 
href="#x1-86000A.1" id="QQ2-1-105">Stone-paper-scissors</a></span>
<br />&#x00A0;<span class="sectionToc" >A.2 <a 
href="#x1-87000A.2" id="QQ2-1-107">Beergame</a></span>
<br /><span class="chapterToc" > <a 
href="#Q1-1-109">Bibliography</a></span>
</div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!--l. 146--><p class="noindent" >
                                                                                         
                                                                                         
<h2 class="likechapterHead"><a 
 id="x1-2000"></a>List   of   Figures</h2><div class="tableofcontents"><span class="lofToc" >4.1&#x00A0;<a 
href="#x1-31001r1">UML   diagram   of   the   Business   Game
Description  (BGD)  model  with  chapter  references.</a></span><br /><span class="lofToc" >5.1&#x00A0;<a 
href="#x1-58001r1">BGE
architecture overview</a></span><br /><span class="lofToc" >5.2&#x00A0;<a 
href="#x1-64002r2">Node.js architecture overview. Source:
stackoverflow.com/questions/36491385</a></span><br /><span class="lofToc" >5.3&#x00A0;<a 
href="#x1-65001r3">BGE architecture: Two event
loops and WebSockets.</a></span><br /><span class="lofToc" >5.4&#x00A0;<a 
href="#x1-68001r4">Startpage module</a></span><br /><span class="lofToc" >5.5&#x00A0;<a 
href="#x1-69001r5">Editor and feedback
screen module</a></span><br /><span class="lofToc" >5.6&#x00A0;<a 
href="#x1-70003r6">Screenshot of two players playing the <span 
class="ecti-1200">SaltSeller</span>
business game after two rounds have been played</a></span><br /><span class="lofToc" >5.7&#x00A0;<a 
href="#x1-70004r7">Example of a
questionnaire which is displayed after the game has finished</a></span><br /><span class="lofToc" >6.1&#x00A0;<a 
href="#x1-83001r1">Example
UI for a local query criteria rule generator</a></span><br />
</div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;1</span><br /><a 
 id="x1-30001"></a>Introduction</h2>
<!--l. 4--><p class="noindent" >Simulations are an essential tool to teach pilots, power plant operators, managers and experts in
complex decision situations. Simulations are used to train regular work processes as well as
emergencies: landing a plane during a storm can be best trained with the help of realistic
simulators.
<!--l. 8--><p class="noindent" >Management simulations, also referred to as business games, gaming simulations, business
simulations or serious games, are used to train managers, experts and students to get a better
understanding of the effects of decisions in complex systems like markets and supply
chains. They are designed to teach management principles, strategies, dynamics and
sustainability. One of the earliest examples is the Beer Distribution Game (beergame)
<span class="cite">[<a 
href="#XJForrester1961">For61</a>,&#x00A0;<a 
href="#Xjarmain">Jar63</a>,&#x00A0;<a 
href="#Xbeergame">Ste89</a>]</span>. It demonstrates the dynamics of a supply chain and illustrates the bullwhip
effect.
<!--l. 12--><p class="noindent" >Many business games are round-based. This means that the game is played for one or several
rounds and that the players have to take one or several decisions in each round independently from
each other. These decisions, and possibly also the decisions from previous rounds, result
in one or several outcomes of a round. The players take their decisions based on the
game history and based on their individual strategy. For example in the Beergame, each
player represents a part of the supply chain and has to decide in each round which
amount of beer he is going to order. He takes this decision based on the orders from
his client in the supply chain, which arrive with a delay of one or several rounds, and
based on his inventory. Storing beer results in inventory costs, unfulfilled orders lead to
backlog costs. The players are requested to minimise the costs over the whole supply chain
while only having local information about the orders they receive and the costs they
produce.
<!--l. 15--><p class="noindent" >Another example is the Salt Seller business game. Here, players have to set prices for a commodity
in a competitive market and experience in each round the effects on market share and profit
resulting from their decisions <span class="cite">[<a 
href="#Xsaltseller">KUS<sup><span 
class="cmr-8">+</span></sup>15</a>]</span>. The Salt Seller simulator aims to convey an understanding
for the general dynamics of stable markets <span class="cite">[<a 
href="#Xsterman">Ste14</a>, p.90ff.]</span>.
<!--l. 17--><p class="noindent" >The goal of this thesis is to provide an architecture with which any round-based business game can
be developed easily and played by multiple users. The amount of coding in a computer simulation
to realise just the market models of such games is quite manageable. They can be translated into a
few input and output variables together with some state-transition-functions, which define how to
calculate the outputs from the current inputs and the game history.
<!--l. 19--><p class="noindent" >The main effort to allow gameplaying for multiple users in a distributed Internet-based
environment with Web-Browsers as front-ends lies elsewhere. If developed individually, every game
needs to specify its own mechanisms in order to deal with multiplayer synchronization, data base
handling and game visualization, which results in a huge overhead. Simulation development
becomes unattractive and expensive and it needs computer science know-how which is not
always available in the educational background where such games are conceived and
played.
<!--l. 21--><p class="noindent" >This thesis provides the design and implementation of a gaming engine (BGE) which automates
the redundant programming parts related to browser-based multiplayer gameplay, including the
visualization and storage of game results. It introduces a description mechanism (BGD) for
round-based business games within an online editing environment so that game developers only
have to implement their simulation or gaming model while the rest is taken care off by the
                                                                                         
                                                                                         
architecture presented in this work.
<!--l. 23--><p class="noindent" >The outline of the thesis follows the chronology of the research. A first literature review in the next
chapter surveys work on a simulation toolkit for round-based games that has been carried out in
Japan. Next, a framework for general n-person round-based games is introduced in chapter 3,
providing a clear definition of the class of round-based games. As a main contribution of this
thesis, chapter 4 proposes an object-based architecture for round-based games, using a general
purpose programming language, followed by a prototype implementation employing the most
recent (web)technologies.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;2</span><br /><a 
 id="x1-40002"></a>Related work</h2>
<!--l. 4--><p class="noindent" >After a short review of business games this chapter surveys the work on a framework for
round-based games that has been carried out in Japan.
<h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-50002.1"></a>Business games</h3>
<!--l. 9--><p class="noindent" >This section provides a brief overview on business games reviewing history, purpose and ways of
classification.
<!--l. 11--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x1-60002.1.1"></a>History and purpose</h4>
<!--l. 14--><p class="noindent" >Greco et al. <span class="cite">[<a 
href="#Xgreco">GBN13</a>]</span> describe business games (BGs) as games within a business environment that
can lead to one or both of the following results: the training of players in business skills
(hard and/or soft skills) or the quantitative and/or qualitative evaluation of the players&#8217;
performances.
<!--l. 16--><p class="noindent" >Triggered by the integration of developments in war games, operations research, computer
technology and education theory, BGs arrived on the scene in the late 1950s for example with the
development of the American Management Association (AMA) decision simulation game <span class="cite">[<a 
href="#Xricciardi">RM57</a>]</span>.
In the following years, games such as the Beer Distribution Game <span class="cite">[<a 
href="#Xbeergame">Ste89</a>,&#x00A0;<a 
href="#Xjarmain">Jar63</a>,&#x00A0;<a 
href="#XJForrester1961">For61</a>]</span> or the
Markstrat Simulation Game <span class="cite">[<a 
href="#XJLarreche1977">LG77</a>]</span> were released and remained popular until today <span class="cite">[<a 
href="#Xstratx">Str15</a>]</span>. An
exhaustive survey about the historical development of the field of business games is presented by
Wolfe <span class="cite">[<a 
href="#Xwolfe93">Wol93</a>]</span>.
<!--l. 20--><p class="noindent" >Today the field of business games is influenced by current technology developments such as natural
language processing and advanced graphics processing, new business models like learning on
demand and online feedback mechanisms based on artificial intelligence <span class="cite">[<a 
href="#Xsummers">Sum04</a>]</span>. BGs also serve as
experimental environment for training computer players, also referred to as artificial agents or
virtual opponents, and for studying deviations of human players from rationality. Furthermore,
BGs are used as incentives to make crowd based online work (crowdsourcing) more
attractive and effective <span class="cite">[<a 
href="#Xrokicki_competitive_2014">RCZS14</a>]</span>. They are implemented by global enterprises like Google,
Microsoft, American Express, Caterpillar, etc.&#x00A0;to train their employees and managers
<span class="cite">[<a 
href="#Xuskov_serious_2014">US14</a>]</span>.
<!--l. 25--><p class="noindent" >Since their inception, the main purpose of BGs has been to teach. Over the years BGs
have become very popular in management education. Nowadays, almost every MBA
program requires students to play one or more management simulations, and BGs are even
more commonly applied at the undergraduate level <span class="cite">[<a 
href="#Xfaria">Far98</a>]</span>. In addition, role-playing in
the business game context can improve soft-skills such as team work, leadership, and
practicing concepts and skills used in strategic management, marketing, finance, and project
management.
                                                                                         
                                                                                         
<!--l. 30--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.1.2   </span> <a 
 id="x1-70002.1.2"></a>Taxonomy</h4>
<!--l. 33--><p class="noindent" >Eilon&#8217;s early taxonomy <span class="cite">[<a 
href="#Xeilon">Eil63</a>]</span> classifies BGs according to design characteristics (computer/
non-computer, total enterprise/functional, ...) and expected use (management training, selling
purpose, research).
<!--l. 35--><p class="noindent" >Other taxonomies focus on a specific aspect of a game, such as the web technologies used <span class="cite">[<a 
href="#Xweb">Ber14</a>]</span>
or the skills that are mediated (product development, project management, logistic skills, risk
management) <span class="cite">[<a 
href="#Xskill">RH11</a>]</span>.
<!--l. 37--><p class="noindent" >A complete taxonomy of BGs is presented by Greco et al. <span class="cite">[<a 
href="#Xgreco">GBN13</a>]</span>. It combines and extends
previous work <span class="cite">[<a 
href="#Xtax1">MG00</a>,&#x00A0;<a 
href="#Xtax2">ASS03</a>,&#x00A0;<a 
href="#Xtax3">EA07</a>]</span> in this field. Greco et al. classify BGs along five dimensions:
application environment; elements of the user interface; target groups, goals, and feedback; user
relation and model. Each dimension is described by an enumeration of characteristics and
sub-characteristics (see <span class="cite">[<a 
href="#Xgreco">GBN13</a>]</span>). A game can be categorised by a subset of all possible
characteristics.
<!--l. 48--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-80002.2"></a>Stand-alone applications</h3>
<!--l. 51--><p class="noindent" >An implementation of a business game is called stand-alone application if the game is developed
from scratch using its own methods for multiplayer synchronization, data base handling and game
visualization.
<!--l. 53--><p class="noindent" >Numerous (round-based) business games exist as stand-alone applications. For example, Jacobs
<span class="cite">[<a 
href="#Xsa2">Jac00</a>]</span> or Ravid and Sheizaf <span class="cite">[<a 
href="#Xsa1">RR00</a>]</span> use Java applets in order to realise the Beer Distribution
Game.
<!--l. 58--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-90002.3"></a>Frameworks</h3>
<!--l. 61--><p class="noindent" >In contrast to a stand-alone application, frameworks support game development and game play for
a whole class of games. The goal of this thesis is to build such a framework for the class of
round-based games. Previous work on this field has been carried out in Japan for several
years.
<!--l. 63--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.3.1   </span> <a 
 id="x1-100002.3.1"></a>Business Model Description Language (BMDL) and Business Model Development System
(BMDS)</h4>
                                                                                         
                                                                                         
<!--l. 66--><p class="noindent" >In 1997 a business simulation course of the Tsukuba University in Japan adopted a new approach
allowing their MBA students to develop their own business simulations instead of playing existing
conventional business games. The experience of creating their own business models was supposed
to convey a better understanding of management skills and of good management decisions. Since
only few people had the computer skills and the programming experience needed to implement a
whole simulator, a simulation toolkit was developed with the intention to enable easy simulation
development for everyone. This toolkit, also referred to as compiler, consists of a business
model description language (BMDL) and a business model development system (BMDS)
<span class="cite">[<a 
href="#Xbmdl3">FSS<sup><span 
class="cmr-8">+</span></sup>99</a>,&#x00A0;<a 
href="#Xbmdl2">TSK<sup><span 
class="cmr-8">+</span></sup>99</a>,&#x00A0;<a 
href="#Xbmdl1">TTK<sup><span 
class="cmr-8">+</span></sup>02</a>]</span>.
<!--l. 68--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">2.3.1.1   </span> <a 
 id="x1-110002.3.1.1"></a>BMDL</h5>
<!--l. 72--><p class="noindent" >BMDL is a description language especially invented to create business simulations. It
supports all the mechanisms needed for round-based business games. The language
consists of a set of 17 keywords (commands) of which the most important ones are
presented here. A complete specification of the language can be found in the paper <span 
class="ecti-1200">A</span>
<span 
class="ecti-1200">compiler for business simulations: Towards business model development by yourselves</span>
<span class="cite">[<a 
href="#Xbmdl1">TTK<sup><span 
class="cmr-8">+</span></sup>02</a>]</span>.
      <dl class="description"><dt class="description">
<span 
class="ecbx-1200">Def.</span> </dt><dd 
class="description">Game independent settings are defined using the def-command. Every game must
      define a game name, the maximal number of players as well as the maximal number
      of rounds to play. In BMDL, players are also referred to as teams.
      </dd><dt class="description">
<span 
class="ecbx-1200">Gcon&amp;scon.</span> </dt><dd 
class="description">Constants are defined using the gcon- or scon-command. The definition of
      both commands is <span 
class="ecti-1200">gcon/scon constant-name value</span>. Gcon introduces a single-valued
      constant.  Scon  is  an  enumeration  of  constants.  Here,  the  number  of  values  must
      correspond  to  the  number  of  rounds  so  that  one  value  exists  for  each  round.  An
      additional value can exist for the initial state of the constant.
      </dd><dt class="description">
<span 
class="ecbx-1200">Ivar.</span> </dt><dd 
class="description">This command defines an input variable. In a round-based game, each player has to
      take one or several decisions in each round. One input variable corresponds to one
      decision. In BMDL, the domain of input variables is numeric. It can refer to an interval
      or a fixed set of values.
      </dd><dt class="description">
<span 
class="ecbx-1200">Tvar.</span> </dt><dd 
class="description">This command defines a so-called team variable. Its definition is <span 
class="ecti-1200">tvar variable-name</span>
      <span 
class="ecti-1200">initial-value</span>.   A   team   variable   could   be   described   as   a   calculated,   numeric,
      player-specific outcome of a round. This outcome is calculated accessing the game
      history and constants. The game history consists of the players&#8217; input decisions of the
      current and of previous rounds as well as the realisation of team variables of previous
      rounds including their initial-value. Team variable values of the current round can also
      be accessed if they have already been calculated.
                                                                                         
                                                                                         
      </dd><dt class="description">
<span 
class="ecbx-1200">Tlet.</span> </dt><dd 
class="description">This command defines how a team variable is calculated in each round. Its definition
      is <span 
class="ecti-1200">tlet expression </span>while expression is a piece of code using the syntax and the functions
      of the C Programming Language.
      <!--l. 81--><p class="noindent" >The following example shows how the tlet-command works. It assumes a simulation
      with the input variable <span 
class="ecti-1200">price </span>and the team variables <span 
class="ecti-1200">sales </span>and <span 
class="ecti-1200">pr</span>. The profit ratio <span 
class="cmmi-12">pr</span>
      indicates increasing or decreasing profit in the current round compared to the previous
      round. In BMDL, this would be translated into <span 
class="cmmi-12">tlet</span><span style="margin-left:3.26212pt" class="tmspace"></span><span 
class="cmmi-12">pr </span><span 
class="cmr-12">= (</span><span 
class="cmmi-12">sales </span><span 
class="cmsy-10x-x-120">* </span><span 
class="cmmi-12">price</span><span 
class="cmr-12">)</span><span 
class="cmmi-12">&#x2215;</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">sales</span><span 
class="cmr-12">@1 </span><span 
class="cmsy-10x-x-120">*</span>
      <span 
class="cmmi-12">price</span><span 
class="cmr-12">@1)</span>. It introduces the relative @-notation in order to access variable values of
      previous rounds. Tables <a 
href="#x1-11002r2">2.2<!--tex4ht:ref: tab:bmdl1 --></a> and <a 
href="#x1-11003r3">2.3<!--tex4ht:ref: tab:bmdl2 --></a> show an example for the first two rounds and two
      players supposing the initial state of the game as defined in table <a 
href="#x1-11001r1">2.1<!--tex4ht:ref: tab:bmdl0 --></a>.
      <div class="table">
      <!--l. 83--><p class="noindent" ><a 
 id="x1-11001r1"></a><hr class="float"><div class="float" 
> <!--tex4ht:inline--><div class="tabular"> <table id="TBL-3" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1"></colgroup><colgroup id="TBL-3-2g"><col 
id="TBL-3-2"><col 
id="TBL-3-3"><col 
id="TBL-3-4"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-1-1"  
class="td11">             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-2"  
class="td11"> price  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-3"  
class="td11"> sales  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-1-4"  
class="td11"> profit ratio (pr)  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-2-1"  
class="td11"> player/team 1  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-2"  
class="td11"> 0.50  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-3"  
class="td11">  60   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-4"  
class="td11">       1           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-1"  
class="td11"> player/team 2  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-2"  
class="td11"> 0.50  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-3"  
class="td11">  60   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-3-3-4"  
class="td11">       1           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-4-1"  
class="td11">              </td></tr></table></div>
<br /> <div class="caption" 
><span class="id">Table&#x00A0;2.1: </span><span  
class="content">Initial state of the example game</span></div><!--tex4ht:label?: x1-11001r1 -->
      </div><hr class="endfloat" />
      </div>
      <div class="table">
      <!--l. 95--><p class="noindent" ><a 
 id="x1-11002r2"></a><hr class="float"><div class="float" 
> <!--tex4ht:inline--><div class="tabular"> <table id="TBL-4" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1"></colgroup><colgroup id="TBL-4-2g"><col 
id="TBL-4-2"><col 
id="TBL-4-3"><col 
id="TBL-4-4"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-1-1"  
class="td11">             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-1-2"  
class="td11"> price  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-1-3"  
class="td11"> sales  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-1-4"  
class="td11"> profit ratio (pr)  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-2-1"  
class="td11"> player/team 1  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-2-2"  
class="td11"> 1.00  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-2-3"  
class="td11">  45   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-2-4"  
class="td11">     <img 
src="thesis0x.png" alt="45-
30"  class="frac" align="middle"> <span 
class="cmr-12">=</span> <img 
src="thesis1x.png" alt="3
2"  class="frac" align="middle">          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-3-1"  
class="td11"> player/team 2  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-3-2"  
class="td11"> 2.00  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-3-3"  
class="td11">  10   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-3-4"  
class="td11">     <img 
src="thesis2x.png" alt="20-
30"  class="frac" align="middle"> <span 
class="cmr-12">=</span> <img 
src="thesis3x.png" alt="2
3"  class="frac" align="middle">          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-4-4-1"  
class="td11">              </td></tr></table></div>
<br /> <div class="caption" 
><span class="id">Table&#x00A0;2.2: </span><span  
class="content">Example game in round 1</span></div><!--tex4ht:label?: x1-11002r2 -->
      </div><hr class="endfloat" />
      </div>
      <div class="table">
      <!--l. 107--><p class="noindent" ><a 
 id="x1-11003r3"></a><hr class="float"><div class="float" 
> <!--tex4ht:inline--><div class="tabular"> <table id="TBL-5" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-5-1g"><col 
id="TBL-5-1"></colgroup><colgroup id="TBL-5-2g"><col 
id="TBL-5-2"><col 
id="TBL-5-3"><col 
id="TBL-5-4"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-5-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-1-1"  
class="td11">             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-1-2"  
class="td11"> price  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-1-3"  
class="td11"> sales  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-1-4"  
class="td11"> profit ratio (pr)  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-2-1"  
class="td11"> player/team 1  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-2-2"  
class="td11"> 3.00  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-2-3"  
class="td11">  5    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-2-4"  
class="td11">     <img 
src="thesis4x.png" alt="1545-"  class="frac" align="middle"> <span 
class="cmr-12">=</span> <img 
src="thesis5x.png" alt="13"  class="frac" align="middle">          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-3-1"  
class="td11"> player/team 2  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-3-2"  
class="td11"> 2.00  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-3-3"  
class="td11">  15   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-3-4"  
class="td11">     <img 
src="thesis6x.png" alt="30-
20"  class="frac" align="middle"> <span 
class="cmr-12">=</span> <img 
src="thesis7x.png" alt="3
2"  class="frac" align="middle">          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-4-1"  
class="td11">              </td></tr></table></div>
<br /> <div class="caption" 
><span class="id">Table&#x00A0;2.3: </span><span  
class="content">Example game in round 2</span></div><!--tex4ht:label?: x1-11003r3 -->
      </div><hr class="endfloat" />
      </div>
      </dd></dl>
<!--l. 120--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">2.3.1.2   </span> <a 
 id="x1-120002.3.1.2"></a>BMDS</h5>
<!--l. 125--><p class="noindent" >After a business game has been developed in BMDL it must be translated so that multiple players
can play against each other in their browsers.
                                                                                         
                                                                                         
<!--l. 127--><p class="noindent" >The module responsible for this translation is referred to as the BMDL translator
<span class="cite">[<a 
href="#Xbmdl3">FSS<sup><span 
class="cmr-8">+</span></sup>99</a>,&#x00A0;<a 
href="#Xbmdl2">TSK<sup><span 
class="cmr-8">+</span></sup>99</a>,&#x00A0;<a 
href="#Xbmdl1">TTK<sup><span 
class="cmr-8">+</span></sup>02</a>]</span> or as Game Generator (GG) system <span class="cite">[<a 
href="#Xybg1">Tan08</a>]</span>. It is a Perl script that
reads the BMDL file and generates Common Gateway Interface (CGI) programs written in C.
These so-called business-game-runtime-system-components are then deployed on a standard web
server and the game can be played by multiple users in the browser.
<!--l. 129--><p class="noindent" >The web server also needs to run a database where variable values as shown in the example above
can be stored after player-input or after round-calculation and from which variable values can be
retrieved for calculations in later rounds.
<!--l. 131--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">2.3.2   </span> <a 
 id="x1-130002.3.2"></a>Yokohama Business Game (YBG)</h4>
<!--l. 134--><p class="noindent" >The work on BMDL and BMDS was quite successful. Students evaluated it as interesting
and recommendable to others and requested to use it in further lessons. Most students
rated the complexity of the course as moderate compared to an earlier approach where
supplementary programming tasks in C made the understanding of business models too difficult
<span class="cite">[<a 
href="#Xbmdl3">FSS<sup><span 
class="cmr-8">+</span></sup>99</a>,&#x00A0;<a 
href="#Xbmdl2">TSK<sup><span 
class="cmr-8">+</span></sup>99</a>,&#x00A0;<a 
href="#Xbmdl1">TTK<sup><span 
class="cmr-8">+</span></sup>02</a>]</span>.
<!--l. 136--><p class="noindent" >In addition to many game implementations within the simulation course, BMDS was used for a
business game simulating the selection of investment projects <span class="cite">[<a 
href="#Xbmdsinvest">YTT09</a>]</span>. Moreover, it was extended
so that artificial agents could be employed along with real players <span class="cite">[<a 
href="#Xbmdsagent1">KT03</a>,&#x00A0;<a 
href="#Xbmdsagent2">STT<sup><span 
class="cmr-8">+</span></sup>03</a>]</span>.
<!--l. 138--><p class="noindent" >BMDS was further developed as a system called Yokohama Business Game (YBG). The work on
YBG was carried on for several years with a first release of YBG1.0 in 2002 and the final release of
YBG2007 in 2007. Many games exist for the YBG platform and it is, or has been used
in 70 universities including universities in the US, China and France. A public game
server<span class="footnote-mark"><a 
href="thesis2.html#fn1x2"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-13001f1"></a> 
is available in Japanese language <span class="cite">[<a 
href="#Xybg1">Tan08</a>,&#x00A0;<a 
href="#Xybg2">TS10</a>]</span>.
<!--l. 140--><p class="noindent" >The main improvements of YBG are described in the paper <span 
class="ecti-1200">Facilitating Business Gaming</span>
<span 
class="ecti-1200">Simulation Modeling </span><span class="cite">[<a 
href="#Xybg1">Tan08</a>]</span>. It introduces a web-based game development environment so
that BMDL games can be developed remotely without having to invoke the GG script
manually.
<!--l. 142--><p class="noindent" >This environment includes different mechanisms to facilitate the game development process. A
template structures an empty BMDL file into different sections (constants, inputs, outputs) that
every game needs to specify. A conceptual game development framework tries to structure the
thinking process which has to be gone through in order to create a business game from the first
idea to the complete program.
<!--l. 144--><p class="noindent" >Above all, the development environment provides means to detect syntax and logical errors in the
BMDL code. The latter can only be detected at runtime, which is why YBG introduces two
different simulation mechanisms. In the first approach, the person simulating the game manually
enters the inputs of each round for each player and checks if this results in the expected outputs.
                                                                                         
                                                                                         
Since this method can be time consuming given a game with many inputs and players, the second
approach makes use of artificial agents which are automatically generating the input
values.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;3</span><br /><a 
 id="x1-140003"></a>The game class supported by BGE</h2>  This chapter describes the class of games that can
be deployed on the business game architecture proposed in this thesis (BGE). It shows common
features among these games and introduces a general framework for <span 
class="cmmi-12">n</span>-player round-based
games.
<h3 class="sectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-150003.1"></a>Common features</h3>
<!--l. 8--><p class="noindent" >All business games that are designed to run on BGE share the following characteristics of which
some are based on the taxonomy of Greco et al. <span class="cite">[<a 
href="#Xgreco">GBN13</a>]</span>.
      <dl class="description"><dt class="description">
<span 
class="ecbx-1200">Browser-based.</span> </dt><dd 
class="description">The games run in a web browser and include texts and charts. They are
      played over a computer network (LAN, Internet).
      </dd><dt class="description">
<span 
class="ecbx-1200">Single-/multiplayer.</span> </dt><dd 
class="description">The games are played by one or more players. Each game defines
      an interval assigning the minimal and maximal number of players. Most BGs will be
      designed as multiplayer games where at least two opponents compete against each
      other. Virtual opponents can be integrated with little effort. This permits a single
      player to play a multiplayer game against virtual opponents or to simulate the game
      having virtual opponents compete against each other.
      </dd><dt class="description">
<span 
class="ecbx-1200">Round-based.</span> </dt><dd 
class="description">The games are round-based in contrast to e.g.&#x00A0;a flight simulator where
      interventions within the simulation are almost continuous. In each round (or period),
      the players take decisions based on the game history and independent from the other
      players&#8217; decision of this round. Every player must enter his or her decision for the
      next period within a certain time. The time frame to take a decision is synchronised
      between all parties which means the players act simultaneously. If one party does not
      respond within the time frame it is removed from the game. Thus all parties have
      the same time to reflect and take a decision, assuming a fast interconnection with low
      latency. In contrast to games with alternating rounds like for example chess, where
      one player decides after the other, decisions in round-based business games are taken
      simultaneously.
      </dd><dt class="description">
<span 
class="ecbx-1200">Indirect user interaction.</span> </dt><dd 
class="description">Interaction between the players is indirect, since they submit
      their  decisions  independently  from  each  other.  There  are  no  means  of  direct
      interactions,  e.g.  an  integrated  communication  channel.  It  is  open  to  the  game
      moderator,  respectively  the  intention  of  the  game  session  in  question,  whether
      communication between players is prohibited or not. There is no direct support for
      team-building eventhough teams can always be realised by allowing several players to
      play in front of one computer.
      </dd><dt class="description">
<span 
class="ecbx-1200">Player evaluation.</span> </dt><dd 
class="description">The goals of the games are not absolute (as a fixed score on a scale)
      but relative to the opponents or to previous sessions of the game. In most BGs the
      players will be evaluated individually. A collective score evaluating the performance of
      all players together can be implemented as well.
                                                                                         
                                                                                         
      </dd><dt class="description">
<span 
class="ecbx-1200">Data collection.</span> </dt><dd 
class="description">The  complete  game  data  is  stored  for  later  analysis  of  the  players&#8217;
      behaviour and strategies.</dd></dl>
<!--l. 23--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-160003.2"></a>N-player round-based games</h3>
<!--l. 25--><p class="noindent" >This section introduces a general framework for <span 
class="cmmi-12">n</span>-player round-based games by utilizing inputs,
outputs, fixed parameters, state transition functions, a score function, and a stopping condition.
The framework is then applied to the round-based game <span 
class="ecti-1200">stone-paper-scissors</span>.
<!--l. 29--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.2.1   </span> <a 
 id="x1-170003.2.1"></a>A general framework</h4>
<!--l. 32--><p class="noindent" >A <span 
class="cmmi-12">n</span>-player round-based game is defined through the 7-tuple <span 
class="cmr-12">(</span><span 
class="cmmi-12">In,P,Out,S</span><sub><span 
class="cmr-8">0</span></sub><span 
class="cmmi-12">,</span><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /></span><span 
class="cmmi-12">,score,sc</span><span 
class="cmr-12">)</span>. The
index <span 
class="cmmi-12">t </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="msbm-10x-x-120">&#x2115;</span><span 
class="cmr-12">(1 </span><span 
class="cmsy-10x-x-120">&#x2264; </span><span 
class="cmmi-12">t </span><span 
class="cmsy-10x-x-120">&#x2264; </span><span 
class="cmmi-12">T</span><span 
class="cmr-12">) </span>represents one round from round 1 to round <span 
class="cmmi-12">T</span>. A round is also called turn
or period.
      <dl class="description"><dt class="description">
<span 
class="ecbx-1200">Inputs.</span> </dt><dd 
class="description"><span 
class="cmmi-12">In </span><span 
class="cmr-12">= </span><img 
src="thesis8x.png" alt="( in )
(    1)
   ..
   inl"  class="left" align="middle"> is a vector of input variables as e.g. <span 
class="cmmi-12">In </span><span 
class="cmr-12">= </span><img 
src="thesis9x.png" alt="(                )
       price
  marketing_exp"  class="left" align="middle"> . An
      input variable is in turn a vector with an entry for every player <span 
class="cmmi-12">n</span>. The number of input
      variables <span 
class="cmmi-12">l </span>is assumed to be constant in <span 
class="cmmi-12">t</span>, which means a game has the same inputs in
      every round. The domain <span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">in</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-12">)</span><span 
class="cmmi-12">,i </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,l</span><span 
class="cmsy-10x-x-120">} </span>has to be chosen depending on the game,
      generally, <span 
class="msbm-10x-x-120">&#x211D; </span>can be a good choice.
      <!--l. 44--><p class="noindent" >In each round <span 
class="cmmi-12">t</span>, <span 
class="cmmi-12">n </span>players or virtual opponents submit <span 
class="cmmi-12">l </span>input values <span 
class="cmmi-12">in</span><sub><span 
class="cmmi-8">ij</span></sub><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> <span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">in</span><sub>
<span 
class="cmmi-8">i</span></sub><span 
class="cmr-12">)</span><span 
class="cmmi-12">,i </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,l</span><span 
class="cmsy-10x-x-120">}</span><span 
class="cmmi-12">,</span>
      <span 
class="cmmi-12">j </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n</span><span 
class="cmsy-10x-x-120">}</span><span 
class="cmmi-12">,t </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,T</span><span 
class="cmsy-10x-x-120">} </span>which results in the input matrix <span 
class="cmmi-12">In</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> with
                                                                                         
                                                                                         
      <table 
class="align">
                     <tr><td 
class="align-odd"><span 
class="cmmi-12">In</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis10x.png" alt="(   (t)       (t))
  in11  .. in1n
(   ..   ..   .. )
  in(t)  .. in(t)
    l1       ln"  class="left" align="middle"> <span 
class="cmsy-10x-x-120">&#x2208;</span><img 
src="thesis11x.png" alt="(                     )
 D (in1 ) &#x00D7; &#x22C5;&#x22C5;&#x22C5; &#x00D7; D (inl)"  class="left" align="middle"><sup><span 
class="cmmi-8">n</span></sup><span 
class="cmmi-12">.</span></td>                  <td 
class="align-even"></td>                  <td 
class="align-label"><a 
 id="x1-17001r1"></a>(3.1)                     </td></tr></table>
      One could say that <span 
class="cmmi-12">In</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> is the instance of <span 
class="cmmi-12">n </span>input variable vectors.
      </dd><dt class="description">
<span 
class="ecbx-1200">Parameters.</span> </dt><dd 
class="description"><span 
class="cmmi-12">P </span>is a set of fixed parameters (constants), e.g. a pre-defined number of rounds, a
      minimal/maximal number of players, a timeout to take a decision or an economic constant.
      <span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">p</span><span 
class="cmr-12">) </span>with <span 
class="cmmi-12">p </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmmi-12">P </span>is the domain of a parameter.
      </dd><dt class="description">
<span 
class="ecbx-1200">Outputs.</span> </dt><dd 
class="description"><span 
class="cmmi-12">Out </span><span 
class="cmr-12">= </span><img 
src="thesis12x.png" alt="(     )
  out1
(  .. )
  outk"  class="left" align="middle"> is a vector of output variables. As with inputs, the number of outputs
      <span 
class="cmmi-12">k </span>is assumed to be constant in <span 
class="cmmi-12">t</span>. Output variables resemble input variables. They are a
      vector with length <span 
class="cmmi-12">n </span>and their domain <span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">out</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-12">)</span><span 
class="cmmi-12">,i </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,k</span><span 
class="cmsy-10x-x-120">} </span>is game-dependent.
      <!--l. 59--><p class="noindent" >The outcome of a round or rather the game state in <span 
class="cmmi-12">t </span>is described by the output matrix
      <span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup>, which sums up the realisation of the output variables in <span 
class="cmmi-12">t</span>. It is
      <table 
class="align">
                 <tr><td 
class="align-odd"><span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis13x.png" alt="(    (t)        (t))
  out11  ..  out1n
(  ..    ..    ..  )
  out(t)  ..  out(t)
     k1        kn"  class="left" align="middle"> <span 
class="cmsy-10x-x-120">&#x2208;</span><img 
src="thesis14x.png" alt="(                        )
 D (out1) &#x00D7; &#x22C5;&#x22C5;&#x22C5; &#x00D7; D (outk)"  class="left" align="middle"><sup><span 
class="cmmi-8">n</span></sup><span 
class="cmmi-12">.</span></td>              <td 
class="align-even"></td>              <td 
class="align-label"><a 
 id="x1-17002r2"></a>(3.2)                 </td></tr></table>
      </dd><dt class="description">
<span 
class="ecbx-1200">Initial game state.</span> </dt><dd 
class="description">The initial game state <span 
class="cmmi-12">S</span><sub><span 
class="cmr-8">0</span></sub> defines the state of the game at <span 
class="cmmi-12">t </span><span 
class="cmsy-10x-x-120">&#x2264; </span><span 
class="cmr-12">0 </span>before it has
      been started. It is fully described by the initial state of every output variable and
      thus
                                                                                         
                                                                                         
      <table 
class="align">
                                                <tr><td 
class="align-odd"><span 
class="cmmi-12">S</span><sub><span 
class="cmr-8">0</span></sub> <span 
class="cmr-12">:= </span><span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(0)</span></sup><span 
class="cmmi-12">.</span></td>                                        <td 
class="align-even"></td>                                        <td 
class="align-label"><a 
 id="x1-17003r3"></a>(3.3)                                                </td></tr></table>
      </dd><dt class="description">
<span 
class="ecbx-1200">State transition functions.</span> </dt><dd 
class="description"><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /> </span>is a set of functions transforming the game state from round <span 
class="cmmi-12">t </span>to
      <span 
class="cmmi-12">t </span><span 
class="cmr-12">+ 1</span>. Hence, these functions are used to calculate the game&#8217;s outputs of a round <span 
class="cmmi-12">t </span>from the
      parameters and the game history. It is <span 
class="cmsy-10x-x-120">|<img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" />| </span><span 
class="cmr-12">= </span><span 
class="cmmi-12">k </span>which means there exists exactly one
      transition function per output variable and <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">i</span></sub> <span 
class="cmsy-10x-x-120">&#x2208;<img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /></span><span 
class="cmmi-12">,i </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,k</span><span 
class="cmsy-10x-x-120">} </span>is used to calculate the
      output variable <span 
class="cmmi-12">out</span><sub><span 
class="cmmi-8">i</span></sub>. Each <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">i</span></sub> is defined as
      <table 
class="align">
                     <tr><td 
class="align-odd"><span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">i</span></sub></td>                         <td 
class="align-even"><span 
class="cmr-12">:</span> <span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">out</span><span 
class="cmr-12">) </span><span 
class="cmsy-10x-x-120">&#x00D7; </span><span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">in</span><span 
class="cmr-12">) </span><span 
class="cmsy-10x-x-120">&#x00D7; </span><span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">P</span><span 
class="cmr-12">) </span><span 
class="cmsy-10x-x-120">&#x00D7; </span><span 
class="cmmi-12">playerIDs </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">out</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-12">)</span><span 
class="cmmi-12">,</span></td>                                    <td 
class="align-label"><a 
 id="x1-17004r4"></a>(3.4)                     </td></tr></table>
      with <span 
class="cmmi-12">playerIDs </span><span 
class="cmr-12">:= </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n</span><span 
class="cmsy-10x-x-120">}</span>.
      <!--l. 78--><p class="noindent" >A game state is an output in time <span 
class="cmmi-12">t </span>so that the output matrix from equation <a 
href="#x1-17002r2">3.2<!--tex4ht:ref: eq:output --></a> can be
      written as
                                                                                         
                                                                                         
      <table 
class="align">
  <tr><td 
class="align-odd"><span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis15x.png" alt="(       (t)   (t)                 (t)    (t)     )
  f1(Out   ,In   ,P,1)  .. f1(Out   ,In  ,P, n)
(          ..           ..           ..         )
  fk(Out(t),In (t),P,1)  .. fk(Out (t),In (t),P,n)"  class="left" align="middle"> <span 
class="cmr-12">=: </span><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup><span 
class="cmmi-12">,In</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup><span 
class="cmmi-12">,P</span><span 
class="cmr-12">)</span><span 
class="cmmi-12">.</span></td>  <td 
class="align-even"></td>  <td 
class="align-label">
<a 
 id="x1-17005r5"></a>(3.5)    </td></tr></table>
      <!--l. 86--><p class="noindent" >The game history can be accessed as
      <table 
class="align">
                     <tr><td 
class="align-odd"><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup><span 
class="cmmi-12">,In</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup><span 
class="cmmi-12">,P</span><span 
class="cmr-12">) = </span><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">f</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmsy-8">-</span><span 
class="cmr-8">1)</span></sup><span 
class="cmmi-12">,In</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmsy-8">-</span><span 
class="cmr-8">1)</span></sup><span 
class="cmmi-12">,P</span><span 
class="cmr-12">)</span><span 
class="cmmi-12">,In</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup><span 
class="cmmi-12">,P</span><span 
class="cmr-12">)</span><span 
class="cmmi-12">.</span></td>                 <td 
class="align-even"></td>                 <td 
class="align-label"><a 
 id="x1-17006r6"></a>(3.6)                     </td></tr></table>
      </dd><dt class="description">
<span 
class="ecbx-1200">Score function.</span> </dt><dd 
class="description">A player&#8217;s result or score of a round is calculated with the help of the <span 
class="cmmi-12">score</span>
      function. It is
                                                                                         
                                                                                         
      <table 
class="align">
                             <tr><td 
class="align-odd"><span 
class="cmmi-12">score</span><span 
class="cmr-12">:</span> <span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">P</span><span 
class="cmr-12">) </span><span 
class="cmsy-10x-x-120">&#x00D7; </span><span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">out</span><span 
class="cmr-12">) </span><span 
class="cmsy-10x-x-120">&#x00D7; </span><span 
class="cmmi-12">playerIDs </span><span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="msbm-10x-x-120">&#x211D;</span><span 
class="cmmi-12">,</span></td>                        <td 
class="align-even"></td>                        <td 
class="align-label"><a 
 id="x1-17007r7"></a>(3.7)                             </td></tr></table>
      with <span 
class="cmmi-12">playerIDs </span>as defined before.
      <!--l. 97--><p class="noindent" >In each round the score function is applied for every player and the results are written to a
      variable <span 
class="cmmi-12">roundScore</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> which is a vector of length <span 
class="cmmi-12">n </span>just as an input or output variable. The
      result over all so-far played periods is defined as
      <table 
class="align">
                          <tr><td 
class="align-odd"><span 
class="cmmi-12">accumulatedScore</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> <span 
class="cmr-12">:=</span> <span 
class="cmex-10x-x-120">&#x2211;</span>
  <sub><span 
class="cmmi-8">s</span><span 
class="cmr-8">=1</span></sub><sup><span 
class="cmmi-8">t</span></sup><span 
class="cmmi-12">roundScore</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">s</span><span 
class="cmr-8">)</span></sup><span 
class="cmmi-12">.</span></td>                      <td 
class="align-even"></td>                      <td 
class="align-label"><a 
 id="x1-17008r8"></a>(3.8)                          </td></tr></table>
      It is possible to define a collective score function with
      <table 
class="align">
                                   <tr><td 
class="align-odd"><span 
class="cmmi-12">collectiveScore</span><span 
class="cmr-12">:</span> <span 
class="cmmi-12">P </span><span 
class="cmsy-10x-x-120">&#x00D7; </span><span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> <span 
class="cmsy-10x-x-120">&#x2192; </span><span 
class="msbm-10x-x-120">&#x211D;</span></td>                                      <td 
class="align-even"></td>                                      <td 
class="align-label"><a 
 id="x1-17009r9"></a>(3.9)                                   </td></tr></table>
      which assesses the performance of all players together for a period <span 
class="cmmi-12">t</span>.
                                                                                         
                                                                                         
      </dd><dt class="description">
<span 
class="ecbx-1200">Stopping condition.</span> </dt><dd 
class="description"><span 
class="cmmi-12">sc </span>is a stopping condition. If this condition is met, the game ends. A
      stopping condition can be e.g. a pre-defined number of rounds.</dd></dl>
<!--l. 107--><p class="noindent" >It is important to mention that in many games the players do not receive complete information
about all game describing variables. Additionally, <span 
class="cmmi-12">P</span>, <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /></span>, <span 
class="cmmi-12">score </span>and <span 
class="cmmi-12">sc </span>can be generalised and
defined dependent on <span 
class="cmmi-12">t </span>as well, e.g. in the German card game <span 
class="ecti-1200">Skat </span><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /> </span>is defined differently when
playing <span 
class="ecti-1200">Null</span>. Furthermore, all tuple parts could also be made dependent on the number of players
<span 
class="cmmi-12">n</span>.
<!--l. 111--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.2.2   </span> <a 
 id="x1-180003.2.2"></a>Applying the framework</h4>
<!--l. 113--><p class="noindent" >This subsection provides an easy example for the application of the framework by applying it to
the the round-based game <span 
class="ecti-1200">stone-paper-scissors</span>.
<!--l. 115--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-190003.2.2"></a><span 
class="ecbx-1200">Initialization.</span></span>
Utilizing the framework introduced above, stone-paper-scissors can be described as
following:
      <ul class="itemize1">
      <li class="itemize"><span 
class="cmmi-12">In </span><span 
class="cmr-12">= </span><img 
src="thesis16x.png" alt="(      )
 choice"  class="left" align="middle"> . In stone-paper-scissors the players solely have to take one decision
      in each round and decide between one of three options. Therefore, there is only <span 
class="ecbx-1200">one</span>
      <span 
class="ecbx-1200">input variable</span>. It is called <span 
class="cmmi-12">choice </span>with <span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">choice</span><span 
class="cmr-12">) = </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmmi-12">stone,paper,scissors</span><span 
class="cmsy-10x-x-120">}</span>.
      </li>
      <li class="itemize"><span 
class="cmmi-12">P  </span><span 
class="cmr-12">= </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmmi-12">maxrounds,minplayers,maxplayers</span><span 
class="cmsy-10x-x-120">}</span>. The rules of stone-paper- scissors are
      very simple and there are no game specific <span 
class="ecbx-1200">parameters </span>as for example economic
      constants. However, every game needs to agree on the number of rounds to be played,
      the minimal and maximal number of players who can participate in the game as well
      as the maximal time to take a decision. Since stone-paper-scissors is a 2-player game
      consisting of three rounds, it is <span 
class="cmmi-12">minplayers </span><span 
class="cmr-12">= 2</span>, <span 
class="cmmi-12">maxplayers </span><span 
class="cmr-12">= 2 </span>and <span 
class="cmmi-12">maxrounds </span><span 
class="cmr-12">= 3</span>.
      </li>
      <li class="itemize"><span 
class="cmmi-12">Out </span><span 
class="cmr-12">= </span><img 
src="thesis17x.png" alt="(              )
 roundW  inner"  class="left" align="middle"> . The only output in stone-paper-scissors is the information
      about winner and loser of the round or if the round ended in a draw. That being
      the case, there is only <span 
class="ecbx-1200">one output variable </span>which is called <span 
class="ecti-1200">roundWinner</span>. It has the
      domain <span 
class="cmmi-12">D</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">roundWinner</span><span 
class="cmr-12">) = </span><span 
class="cmsy-10x-x-120">{-</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">0</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">} </span>where -1 stands for defeat, 0 for tie and 1 for
      victory. The initial state <span 
class="cmmi-12">S</span><sub><span 
class="cmr-8">0</span></sub> of the game is <span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(0)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis18x.png" alt="(     )
  0  0"  class="left" align="middle"> .
                                                                                         
                                                                                         
      </li>
      <li class="itemize"><span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-46.png" alt="F" class="10-120x-x-46" /> </span><span 
class="cmr-12">=  </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmmi-12">calculateRoundWinner</span><span 
class="cmsy-10x-x-120">}</span>.  One  output  to  calculate  results  in  <span 
class="ecbx-1200">one  state</span>
      <span 
class="ecbx-1200">transition function</span>. This function calculates the output variable <span 
class="cmmi-12">roundWinner </span>for a
      player <span 
class="cmmi-12">i </span>and a round <span 
class="cmmi-12">t </span>from the input choices of both players as shown in algorithm <a 
href="#x1-19001r1">1<!--tex4ht:ref: alg:roundWinner --></a>.
      With <span 
class="cmmi-12">calculateRoundWinner</span><span 
class="cmr-12">:</span> <span 
class="cmmi-12">I</span><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">t</span><span 
class="cmr-8">)</span></sup> <span 
class="cmsy-10x-x-120">&#x00D7;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">2</span><span 
class="cmsy-10x-x-120">}&#x2192;{-</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">0</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">}</span>, the definition of the function
      is quite simple; it only needs the current inputs in order to determine the new game
      state. In more sophisticated games the transition functions are more complex accessing
      the complete game history and <span 
class="cmmi-12">P </span>as shown in equation <a 
href="#x1-17004r4">3.4<!--tex4ht:ref: eq:transition2 --></a>.
      </li>
      <li class="itemize">The <span 
class="ecbx-1200">score function </span>of stone-paper-scissors is also very simple. The score is 1,-1 or 0
      for victory, defeat or tie and thus it just returns the result of the <span 
class="cmmi-12">roundWinner </span>output
      variable of the current round. In other games the score function e.g. combines several
      outputs and weighs them.
      </li>
      <li class="itemize">The <span 
class="ecbx-1200">stopping condition </span>checks whether the current round <span 
class="cmmi-12">t </span>is greater than the
      pre-defined number of rounds <span 
class="cmmi-12">maxrounds</span>. Consequently it is <span 
class="cmmi-12">sc </span><span 
class="cmr-12">: </span><span 
class="cmmi-12">t &#x003E; </span><span 
class="cmr-12">3</span>.</li></ul>
<div class="algorithm">
                                                                                         
                                                                                         
<!--l. 133--><p class="noindent" ><a 
 id="x1-19001r1"></a><hr class="float"><div class="float" 
>
                                                                                         
                                                                                         
 <div class="caption" 
><span class="id">Algorithm 1: </span><span  
class="content"></span></div><!--tex4ht:label?: x1-19001r1 -->
<div class="algorithmic">
        <span class="label-14.09651pt">
 <span 
class="ecrm-1000">1:</span> </span>&#xA0;<span 
class="algorithmic"><span 
class="ecbx-1200">function</span>&#x00A0;<span 
class="eccc-1200"><span 
class="small-caps">C</span><span 
class="small-caps">A</span><span 
class="small-caps">L</span><span 
class="small-caps">C</span><span 
class="small-caps">U</span><span 
class="small-caps">L</span><span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span>R<span 
class="small-caps">O</span><span 
class="small-caps">U</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>W<span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">N</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span></span>(playerID)         </span><br class="algorithmic"/><span class="label-14.09651pt">  <span 
class="ecrm-1000">2:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="cmmi-12">choice</span><span 
class="cmr-12">1 </span><span 
class="cmsy-10x-x-120">&#x2190;</span> get <span 
class="ecti-1200">choice </span>of player one for round <span 
class="ecti-1200">t</span>                <img  src="thesis19x.png" alt="&#x22B3;  "  class="math" > stone=0, scissors=1,     paper=2         </span><br class="algorithmic"/><span class="label-14.09651pt">  <span 
class="ecrm-1000">3:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="cmmi-12">choice</span><span 
class="cmr-12">2 </span><span 
class="cmsy-10x-x-120">&#x2190;</span> get <span 
class="ecti-1200">choice </span>of player two for round <span 
class="ecti-1200">t</span>         </span><br class="algorithmic"/><span class="label-14.09651pt">  <span 
class="ecrm-1000">4:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="ecbx-1200">if</span>&#x00A0;<span 
class="cmmi-12">playerID </span><span 
class="cmr-12">= 1</span>&#x00A0;<span 
class="ecbx-1200">then</span>         </span><br class="algorithmic"/><span class="label-14.09651pt">  <span 
class="ecrm-1000">5:</span> </span>&#xA0;<span  class="algorithmic">           <span 
class="cmmi-12">diff </span><span 
class="cmsy-10x-x-120">&#x2190; </span><span 
class="cmmi-12">choice</span><span 
class="cmr-12">1 </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">choice</span><span 
class="cmr-12">2</span>         </span><br class="algorithmic"/><span class="label-14.09651pt">  <span 
class="ecrm-1000">6:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="ecbx-1200">else</span>&#x00A0;<span 
class="ecbx-1200">if</span>&#x00A0;<span 
class="cmmi-12">playerID </span><span 
class="cmr-12">= 2</span>&#x00A0;<span 
class="ecbx-1200">then</span>         </span><br class="algorithmic"/><span class="label-14.09651pt">  <span 
class="ecrm-1000">7:</span> </span>&#xA0;<span  class="algorithmic">           <span 
class="cmmi-12">diff </span><span 
class="cmsy-10x-x-120">&#x2190; </span><span 
class="cmmi-12">choice</span><span 
class="cmr-12">2 </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">choice</span><span 
class="cmr-12">1</span>         </span><br class="algorithmic"/><span class="label-14.09651pt">  <span 
class="ecrm-1000">8:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="ecbx-1200">end</span>&#x00A0;<span 
class="ecbx-1200">if</span>         </span><br class="algorithmic"/><span class="label-14.09651pt">  <span 
class="ecrm-1000">9:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="ecbx-1200">if</span>&#x00A0;<span 
class="cmmi-12">diff </span><span 
class="cmr-12">= </span><span 
class="cmsy-10x-x-120">-</span><span 
class="cmr-12">1</span> or <span 
class="cmmi-12">diff </span><span 
class="cmr-12">= 2</span>&#x00A0;<span 
class="ecbx-1200">then</span>         </span><br class="algorithmic"/><span class="label-14.09651pt"> <span 
class="ecrm-1000">10:</span> </span>&#xA0;<span  class="algorithmic">           <span 
class="cmmi-12">result </span><span 
class="cmsy-10x-x-120">&#x2190; </span><span 
class="cmr-12">1</span>         </span><br class="algorithmic"/><span class="label-14.09651pt"> <span 
class="ecrm-1000">11:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="ecbx-1200">else</span>&#x00A0;<span 
class="ecbx-1200">if</span>&#x00A0;<span 
class="cmmi-12">diff </span><span 
class="cmr-12">= 0</span>&#x00A0;<span 
class="ecbx-1200">then</span>         </span><br class="algorithmic"/><span class="label-14.09651pt"> <span 
class="ecrm-1000">12:</span> </span>&#xA0;<span  class="algorithmic">           <span 
class="cmmi-12">result </span><span 
class="cmsy-10x-x-120">&#x2190; </span><span 
class="cmr-12">0</span>         </span><br class="algorithmic"/><span class="label-14.09651pt"> <span 
class="ecrm-1000">13:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="ecbx-1200">else</span>         </span><br class="algorithmic"/><span class="label-14.09651pt"> <span 
class="ecrm-1000">14:</span> </span>&#xA0;<span  class="algorithmic">           <span 
class="cmmi-12">result </span><span 
class="cmsy-10x-x-120">&#x2190;-</span><span 
class="cmr-12">1</span>         </span><br class="algorithmic"/><span class="label-14.09651pt"> <span 
class="ecrm-1000">15:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="ecbx-1200">end</span>&#x00A0;<span 
class="ecbx-1200">if</span>         </span><br class="algorithmic"/><span class="label-14.09651pt"> <span 
class="ecrm-1000">16:</span> </span>&#xA0;<span  class="algorithmic">     <span 
class="ecbx-1200">return </span><span 
class="cmmi-12">result</span>         </span><br class="algorithmic"/><span class="label-14.09651pt"> <span 
class="ecrm-1000">17:</span> </span>&#xA0;<span  class="algorithmic"><span 
class="ecbx-1200">end</span>&#x00A0;<span 
class="ecbx-1200">function</span></span>
</div>
                                                                                         
                                                                                         
</div><hr class="endfloat" />
</div>
<!--l. 157--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-200003.2.2"></a><span 
class="ecbx-1200">First round.</span></span>
Assuming player one chooses <span 
class="ecti-1200">stone </span>and player two chooses <span 
class="ecti-1200">paper</span>. This results in the input matrix
<span 
class="cmmi-12">In</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis20x.png" alt="(stone   paper)"  class="left" align="middle"> <span 
class="cmr-12">= </span><img 
src="thesis21x.png" alt="(0  2)"  class="left" align="middle"> .
<!--l. 166--><p class="noindent" >Applying the state transition function <span 
class="cmmi-12">calculateRoundWinner </span>for both players in order to
transfer the game state to <span 
class="cmmi-12">t </span><span 
class="cmr-12">= 1 </span>results in the output matrix <span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis22x.png" alt="(- 1 1)"  class="left" align="middle"> . The
score function returns the same values which leads to <span 
class="cmmi-12">roundScore</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis23x.png" alt="(    )
  - 1
   1"  class="left" align="middle"> and
<br 
class="newline" /><span 
class="cmmi-12">accumulatedScore</span><sup><span 
class="cmr-8">(1)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis24x.png" alt="( - 1 )

   1"  class="left" align="middle"> .
<!--l. 174--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-210003.2.2"></a><span 
class="ecbx-1200">Second round.</span></span>
It is assumed that <span 
class="cmmi-12">In</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis25x.png" alt="(                  )
 scissors  scissors"  class="left" align="middle"> <span 
class="cmr-12">= </span><img 
src="thesis26x.png" alt="(    )
 1  1"  class="left" align="middle"> , which means the round ended in
a draw. For <span 
class="cmmi-12">t </span><span 
class="cmr-12">= 2 </span>it is <span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis27x.png" alt="(    )
 0  0"  class="left" align="middle"> which results in <span 
class="cmmi-12">roundScore</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis28x.png" alt="( )
 0
 0"  class="left" align="middle"> and
<span 
class="cmmi-12">accumulatedScore</span><sup><span 
class="cmr-8">(2)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis29x.png" alt="(    )
  - 1
   1"  class="left" align="middle"> .
<!--l. 186--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-220003.2.2"></a><span 
class="ecbx-1200">Last round.</span></span>
With <span 
class="cmmi-12">In</span><sup><span 
class="cmr-8">(3)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis30x.png" alt="(paper   scissors )"  class="left" align="middle"> <span 
class="cmr-12">= </span><img 
src="thesis31x.png" alt="(2   1)"  class="left" align="middle"> it is <span 
class="cmmi-12">Out</span><sup><span 
class="cmr-8">(3)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis32x.png" alt="(- 1  1)"  class="left" align="middle"> , <br 
class="newline" /><span 
class="cmmi-12">roundScore</span><sup><span 
class="cmr-8">(3)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis33x.png" alt="(    )
  - 1
   1"  class="left" align="middle"> and <span 
class="cmmi-12">accumulatedScore</span><sup><span 
class="cmr-8">(3)</span></sup> <span 
class="cmr-12">= </span><img 
src="thesis34x.png" alt="(   )
 - 2
  2"  class="left" align="middle"> . The game ends because the stopping
condition is met. Player two wins the game with a total score of <span 
class="cmr-12">2 </span><span 
class="cmmi-12">&#x003E; </span><span 
class="cmsy-10x-x-120">-</span><span 
class="cmr-12">2</span>.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!--l. 1--><p class="noindent" >
                                                                                         
                                                                                         
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;4</span><br /><a 
 id="x1-230004"></a>Architecture design</h2>
<!--l. 4--><p class="noindent" >This chapter describes the requirements for a business-games architecture and shows how a
Business Game Description (BGD) mechanism and a Business Game Engine (BGE) can be
designed in order to meet these requirements.
<h3 class="sectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-240004.1"></a>Software requirements</h3>
<!--l. 9--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.1.1   </span> <a 
 id="x1-250004.1.1"></a>Description mechanism</h4>
<!--l. 12--><p class="noindent" >In order to enable game writers to write their own round-based business games a programming
language or game-description mechanism is needed which covers all aspects of round-based games
as described in section <a 
href="#x1-160003.2">3.2<!--tex4ht:ref: sec:round --></a>:
      <ul class="itemize1">
      <li class="itemize">The game writer must be able to define <span 
class="ecbx-1200">input variables </span>as well as the input domain.
      The latter is needed for the validation of user input. Furthermore, he must be able to
      decide if the players are asked for a variable or predefined input (empty text field vs.
      checkbox).
      </li>
      <li class="itemize"><span 
class="ecbx-1200">Parameters </span>must  be  supported,  including  the  definition  of  the  domain,  so  that
      parameter changes can be validated. This is useful if other users than the original game
      writer have the privilege to change parameter values or to prevent careless mistakes.
      </li>
      <li class="itemize">The description mechanism must support the declaration of <span 
class="ecbx-1200">output variables </span>as well
      as the definition of the output domain and the initial state of the variable. Output
      variables must be linked with a <span 
class="ecbx-1200">state transition function </span>in order to specify how
      the output is calculated. This function must be able to access the set of parameters
      and the game history as described in equation <a 
href="#x1-17004r4">3.4<!--tex4ht:ref: eq:transition2 --></a>. The outputs of previous rounds
      and of earlier declared output variables of this round should also be accessible in order
      to facilitate the implementation of the state transition functions. For the rest of this
      thesis, the term game history will be used in the broader sense including outputs.
      </li>
      <li class="itemize">Furthermore  it  must  be  possible  to  define  a  <span 
class="ecbx-1200">score  function  </span>and  a  <span 
class="ecbx-1200">stopping</span>
      <span 
class="ecbx-1200">condition</span>. The latter can be defined for example in form of a parameter indicating
      the maximal number of rounds.</li></ul>
<!--l. 20--><p class="noindent" >Apart from supporting the pure description features of round-based games, the description
mechanism should
      <ul class="itemize1">
      <li class="itemize">define an interface for virtual opponents which enables simulations or game sessions
      with real players against virtual opponents,
                                                                                         
                                                                                         
      </li>
      <li class="itemize">provide a mechanism to define questionnaires between game rounds and/or at the
      beginning or end of the game,
      </li>
      <li class="itemize">provide means to define how round results, game history and results of the entire game
      are presented to the players.</li></ul>
<!--l. 27--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.1.2   </span> <a 
 id="x1-260004.1.2"></a>Game development environment</h4>
<!--l. 30--><p class="noindent" >If the description mechanism from the last subsection is available, the game writer needs a system
or process which allows to
      <ul class="itemize1">
      <li class="itemize">write games and transmit the game description to the architecture,
      </li>
      <li class="itemize">validate its syntax and semantics and receive feedback on possible mistakes,
      </li>
      <li class="itemize">save and register the game in the architecture if the syntax and semantics check has
      passed.</li></ul>
<!--l. 37--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.1.3   </span> <a 
 id="x1-270004.1.3"></a>Simulation environment</h4>
<!--l. 40--><p class="noindent" >After having registered a new game it should be made available for simulation. Here, in contrast to
a real game session, the inputs for each round and for each player are provided by the simulation
environment. Simulation allows the game developer to test the state transition functions and the
correctness of the entire game by verifying if a given input results in the expected output. It can
further be used to adjust game parameters. The simulation environment should provide means for
debugging in order to locate and understand errors which might occur during game
execution.
<!--l. 42--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.1.4   </span> <a 
 id="x1-280004.1.4"></a>Playing environment</h4>
<!--l. 45--><p class="noindent" >A game which has been successfully registered and proven to work correctly should be made
available as online multiplayer game. The playing environment should meet two main
requirements:
                                                                                         
                                                                                         
      <dl class="description"><dt class="description">
<span 
class="ecbx-1200">Entrance hall.</span> </dt><dd 
class="description">This describes a mechanism to join players together who want to play the
      same game. Players should be informed about their waiting status if the minimal
      number of players for the game is not yet reached. The game is started after the minimal
      number of players is reached.
      <!--l. 50--><p class="noindent" >Alternatively the automatic starting behaviour could be changed for a manual start
      triggered by the game creator. The game creator is the first person who joined the
      game. He might also be given the possibility to add virtual opponents to the game.
      </dd><dt class="description">
<span 
class="ecbx-1200">Game engine.</span> </dt><dd 
class="description"><span 
class="ecti-1200">Game engine </span>describes a system which enables real time game play of
      multiple users. It must collect the user input and distribute it to an instance,
      which
           <ul class="itemize1">
           <li class="itemize">calculates the outputs by invoking the state transition functions,
           </li>
           <li class="itemize">distributes and shows the results to the players according to the game description,
           </li>
           <li class="itemize">handles timeout if a player does not provide his input decision within a predefined
           time frame,
           </li>
           <li class="itemize">saves all game states, parameters, etc. to the database for later analysis.</li></ul>
      <!--l. 58--><p class="noindent" >The game engine might also provide a mechanism to render questionnaires and display them
      to the players if included in the game description.</dd></dl>
<!--l. 61--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.1.5   </span> <a 
 id="x1-290004.1.5"></a>Analysis environment</h4>
<!--l. 64--><p class="noindent" >The analysis environment should a) provide a mechanism to retrieve the collected data of all game
sessions of a specific game from the database and deliver it to the user for example as
csv-export. It might further b) include various possibilities to filter for specific parts of the
game data before exporting it or it might c) provide an online view of selected game
data.
<!--l. 66--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-300004.2"></a>Business Game Description (BGD)</h3>
<!--l. 69--><p class="noindent" >As seen in the requirements of section <a 
href="#x1-250004.1.1">4.1.1<!--tex4ht:ref: subsec:req:description --></a>, a mechanism is needed with which game developers
can write their own round-based business games. This feature is called Business Game Description
(BGD) and there are the following two major ways to approach it:
                                                                                         
                                                                                         
      <dl class="description"><dt class="description">
<span 
class="ecbx-1200">New programming language.</span> </dt><dd 
class="description">One possibility would be to invent a new programming
      language with its own syntax and keywords which meets all requirements from section
      <a 
href="#x1-250004.1.1">4.1.1<!--tex4ht:ref: subsec:req:description --></a>. The set of keywords could be kept small compared to a conventional programming
      language and a language exclusively built in order to describe round-based games
      would be compact and easy to learn. After having defined this language it would be
      necessary to build either a compiler or a converter to another programming language.
      Writing a complete compiler for different architectures seems rather unfeasible in terms
      of resources. Writing a converter would be the second option, which is for example
      followed in the work of Tsuda et al.&#x00A0;on BMDL <span class="cite">[<a 
href="#Xbmdl1">TTK<sup><span 
class="cmr-8">+</span></sup>02</a>]</span> as introduced in section
      <a 
href="#x1-100002.3.1">2.3.1<!--tex4ht:ref: subsec:bmdl --></a>. Yet, even a converter still needs a parser which complicates the processing of
      the language <span class="cite">[<a 
href="#Xjapanisch">Tan11</a>]</span> and which is error-prone and time-consuming to build. Moreover,
      libraries or existing projects which could facilitate the implementation of the system
      do not exist for a newly created language.
      </dd><dt class="description">
<span 
class="ecbx-1200">General purpose language.</span> </dt><dd 
class="description">In  the  second  approach  the  game  itself  is  written  in
      an  object-oriented  general  purpose  programming  language.  For  game  developers
      completely new to programming this might pose an obstacle, although it should be
      quite easy to adopt existing examples in order to create a new game. The use of an
      existing programming language maintains a high flexibility since almost everything
      can be expressed and since a large variety of libraries and projects such as syntax
      highlighting,  syntax  checking,  code  reformatting  etc.  exist  which  can  be  used  to
      facilitate the editing process (sections <a 
href="#x1-440004.2.2.1">4.2.2.1<!--tex4ht:ref: subsub:verification --></a> and <a 
href="#x1-690005.2.2">5.2.2<!--tex4ht:ref: sub:module:editor --></a>). It is no longer necessary to
      write a resource-intensive parser which is the main reason for choosing this second
      approach in order to create the Business Game Description mechanism.</dd></dl>
<!--l. 76--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.2.1   </span> <a 
 id="x1-310004.2.1"></a>BGD object model</h4>
<!--l. 79--><p class="noindent" >Figure <a 
href="#x1-31001r1">4.1<!--tex4ht:ref: fig:uml --></a> shows the objects which are used in the Business Game Description mechanism. The
Game object is the central element of BGD. It holds all methods that are needed to describe a
round-based business game. At game development time, the game writer calls these methods in his
game code in order to define and retrieve parameters, inputs, outputs and so on as explained in the
following subsections.
<!--l. 81--><p class="noindent" >Doing so, the game writer does not need to instantiate the Game object in his code. He just calls
the methods as if the Game object had been instantiated before. When some players want to play
his game and start it, the game engine creates a new instance of Game. It then loads his code from
the database and invokes it which will populate this very instance of Game with the
parameters, inputs, outputs, state transition functions etc. which are needed to play his
game.
<!--l. 83--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-31001r1"></a>
                                                                                         
                                                                                         
<!--l. 85--><p class="noindent" ><img 
src="figures/gameUml.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;4.1: </span><span  
class="content">UML diagram of the Business Game Description (BGD) model with chapter
references.</span></div><!--tex4ht:label?: x1-31001r1 -->
                                                                                         
                                                                                         
<!--l. 88--><p class="noindent" ></div><hr class="endfigure">
<h5 class="subsubsectionHead"><span class="titlemark">4.2.1.1   </span> <a 
 id="x1-320004.2.1.1"></a>Parameter object</h5>
<!--l. 93--><p class="noindent" >A parameter is a constant. The parameter object therefore holds two main attributes, which are
the parameter name and the parameter value. The first is of type string, the latter can
be string or numeric, depending on the game. In most cases, parameter values will be
numeric.
<!--l. 95--><p class="noindent" >As stated in the requirements of section <a 
href="#x1-250004.1.1">4.1.1<!--tex4ht:ref: subsec:req:description --></a> it should also be possible to specify the parameter
domain. This is done using a so-called validation expression. A validation expression is an array of
one or several expressions represented by strings. Every time the game code is saved to the
database, e.g. after it got created or after some changes took place, the parameter value will be
matched against each of these expressions, resulting in an error if one of them fails. For example,
if a game developer wants to express that the domain of his parameter <span 
class="cmmi-12">p</span><span 
class="cmr-12">1 </span>is defined
as <span 
class="cmmi-12">p</span><span 
class="cmr-12">1 </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">0</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">} </span>the validation expression would be <img 
src="thesis35x.png" alt="(            )
    &#8221; &#x2265; 0&#8221;
(   &#8221; &#x2264; 1&#8221;   )
  &#8221;%1  ==  0&#8221;"  class="left" align="middle"> , with % being the
modulo operator. If someone would try to set <span 
class="cmmi-12">p</span><span 
class="cmr-12">1 = 1</span><span 
class="cmmi-12">.</span><span 
class="cmr-12">5 </span>the validation would fail at the
third expression because <span 
class="cmr-12">1</span><span 
class="cmmi-12">.</span><span 
class="cmr-12">5%1 = 0</span><span 
class="cmmi-12">.</span><span 
class="cmr-12">5</span><span 
class="cmmi-12">&#x2260;</span><span 
class="cmr-12">0</span>. The concept of validation expressions will
also be used to specify the domain of input and output variables as shown in the next
subsection.
<!--l. 99--><p class="noindent" >At game development time, in order to define a new parameter, the game developer calls the
<span 
class="ecti-1200">game.addParameter() </span>method, specifying name, value and the validationExpression, the latter
being an optional parameter. At game play, when his code gets invoked, this will implicitly result
in the instantiation of a new parameter object by the game engine which will be added to the
parameter collection of the game object.
<!--l. 101--><p class="noindent" >As shown in equation <a 
href="#x1-17004r4">3.4<!--tex4ht:ref: eq:transition2 --></a> and <a 
href="#x1-17007r7">3.7<!--tex4ht:ref: eq:score --></a> the state transition functions as well as the score function need
access to the set of parameters. In the game code, this is done with the <span 
class="ecti-1200">game.getPara-</span>
<br 
class="newline" /><span 
class="ecti-1200">meter() </span>method. By specifying the name of the requested parameter this method returns the
parameter value.
<!--l. 103--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.2.1.2   </span> <a 
 id="x1-330004.2.1.2"></a>Variable object</h5>
<!--l. 106--><p class="noindent" >As seen in section <a 
href="#x1-160003.2">3.2<!--tex4ht:ref: sec:round --></a>, input and output variables play a fundamental role in round-based business
games. In BGD, both are defined by passing a <span 
class="ecti-1200">Variable </span>object to one of the <span 
class="ecti-1200">game.add...Variable()</span>
methods. The exact definition of these methods and the parameters they take will be explained in
the following paragraphs.
<!--l. 108--><p class="noindent" >When the game is played, the game engine creates a new Game object and executes the game
code. The Variable object, which was passed to the function, will be added to the Game object&#8217;s
array of input or output variables, depending on whether it was an instance of InputVariable or
OutputVariable respectively.
                                                                                         
                                                                                         
<!--l. 110--><p class="noindent" >In order to retrieve the value of a variable for a given player and a given round, the game
developer can use the <span 
class="ecti-1200">game.get() </span>function. He will need this for example in the state
transition functions in order to fetch values of input and output variables from the game
history.
<!--l. 112--><p class="noindent" >If a state transition function <span 
class="cmmi-12">calcOut</span><span 
class="cmr-12">2</span>, which calculates output <span 
class="cmmi-12">out</span><span 
class="cmr-12">2</span>, retrieves <span 
class="cmmi-12">out</span><span 
class="cmr-12">1 </span>of this round,
then <span 
class="cmmi-12">out</span><span 
class="cmr-12">1 </span>must be added before <span 
class="cmmi-12">out</span><span 
class="cmr-12">2</span>, since the output variables are being calculated in the order
in which they are added in the game code.
<!--l. 114--><p class="noindent" >Finally, each Variable object must specify the <span 
class="ecti-1200">name </span>attribute and the name of the variables must
be unique within one game, since it will be used for example in the <span 
class="ecti-1200">game.get() </span>function as an
identifier. The Variable object may further define the <span 
class="cmmi-12">initialV alue </span>and <span 
class="cmmi-12">calculationFunction</span>
attribute as shown below.
<!--l. 116--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-340004.2.1.2"></a><span 
class="ecbx-1200">Input variable.</span></span>
An input can be defined calling the <span 
class="ecti-1200">game.addInputVariable() </span>method. This method takes two
parameters of which the first one is obligatory and of type <span 
class="ecti-1200">InputVariable</span>. Thus, in order to create a
new input, the game author first has to instantiate a InputVariable object in his game
code.
<!--l. 118--><p class="noindent" >As seen in the requirements of section <a 
href="#x1-250004.1.1">4.1.1<!--tex4ht:ref: subsec:req:description --></a> two types of inputs exist, such of variable and
such of predefined type. Both must specify the <span 
class="ecti-1200">default </span>attribute. If a player leaves the
game before it has ended or if he exceeds the maximal time to take a decision he will
be expelled from the game and the default value will be his input for the remaining
rounds.
<!--l. 120--><p class="noindent" >A variable input type is represented by the <span 
class="ecti-1200">TextField </span>object. It must specify the <span 
class="ecti-1200">type </span>attribute for
input validation which can either take the value "number" or the value "string". It may
additionally specify a validation expression in order to set out the exact subdomain of textual or
numeric input.
<!--l. 122--><p class="noindent" >The predefined input type can either be of style <span 
class="ecti-1200">checkbox </span>or <span 
class="ecti-1200">scrolldown</span>. Both must define an array
of values which represent the different options between which the player can choose. Of course, the
default value must be one of these options.
<!--l. 124--><p class="noindent" >An input object may also define the <span 
class="ecti-1200">calculationFunction </span>attribute which must be of type <span 
class="ecti-1200">Function</span>
and which represents in the context of input variables the interface to virtual opponents. It is
defined in the same manner as state transition functions from equation <a 
href="#x1-17004r4">3.4<!--tex4ht:ref: eq:transition2 --></a>. Instead of calculating
an output, this function defines how an input can be automatically generated. It is required if the
game should be available for simulation or if virtual opponents should be added to games with
real players. This is why it is strongly recommended to implement such a function.
In most cases it will be enough to return for example a random number, but it also
lays the foundation for sophisticated artificial agents since the game author can access
the complete game history and use any kind of programming he likes. The concept of
<span 
class="ecti-1200">calculationFunctions </span>will be explained in more detail in the next paragraph about output
variables.
<!--l. 126--><p class="noindent" >An input variable may further define an initial value. This is mathematically not needed, as seen in
equation <a 
href="#x1-17003r3">3.3<!--tex4ht:ref: eq:s0 --></a>, which shows that <span 
class="cmmi-12">S</span><sub><span 
class="cmr-8">0</span></sub> is fully described by the initial states of the output variables.
Nevertheless it has proven practical for some game implementations.
                                                                                         
                                                                                         
<!--l. 128--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-350004.2.1.2"></a><span 
class="ecbx-1200">Chart.</span></span>
As presented at the beginning of the last paragraph, the <span 
class="ecti-1200">game.addInputVariable() </span>method takes
two parameters of which the second is an optional Chart object. If it is specified, the players will
see a chart in each round which shows the values of this input variable of every player of the
previous rounds. The Chart object describes how this chart should look like. Chart objects are not
restricted to input variables but are used as a general concept to visualise the outcome of a
variable, using the attributes <span 
class="cmmi-12">caption</span>, <span 
class="cmmi-12">type</span>, <span 
class="cmmi-12">unit</span>, <span 
class="cmmi-12">xInit </span>and <span 
class="cmmi-12">xIncrement</span>. So far, the types
<span 
class="ecti-1200">pieChart</span>, <span 
class="ecti-1200">columnChart </span>and <span 
class="ecti-1200">lineChart </span>are supported. Per default, columnChart and lineChart show
a value (e.g. price) over all previous rounds while pieChart visualises a proportion (e.g. market
share) of the previous round. The caption attribute allows to define a title for the chart. Unit
defines the unit of measurement (e.g. %, euros, etc.) of the variable. The xInit and
xIncrement attributes are used in columnChart and lineChart to define the entries of the
x-Axis.
<!--l. 130--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-360004.2.1.2"></a><span 
class="ecbx-1200">Output variable.</span></span>
With <span 
class="ecti-1200">game.addPlayerVariable() </span>and <span 
class="ecti-1200">game.addRoundVariable() </span>two <br 
class="newline" />methods exist in order to introduce a new output variable in the game code. This may seem
strange since the framework for round-based BGs from section <a 
href="#x1-160003.2">3.2<!--tex4ht:ref: sec:round --></a> knows only one type of output.
The difference between both can be explained assuming a business game which implements an
output variable <span 
class="ecti-1200">market demand </span>which changes in each period and which is calculated as a random
number. In a given period, the market demand is supposed to be the same for each player.
Mathematically, it is not necessary to differentiate such an output from one that is
different for every player. In the output matrix from equation <a 
href="#x1-17002r2">3.2<!--tex4ht:ref: eq:output --></a> this market demand
variable would just result in one row with identical numbers for every player. However, in
terms of programming it makes sense to distinguish between a <span 
class="ecti-1200">Player(output)Variable</span>
and a <span 
class="ecti-1200">Round(output)Variable </span>since the latter needs to be calculated and stored only
once per round while the first needs to be calculated and stored per round and per
player.
<!--l. 133--><p class="noindent" >Similar as the value of an input variable, the value of an output variable can be retrieved from the
game history with the <span 
class="ecti-1200">game.get() </span>function. In case of a round-specific OutputVariable the <span 
class="ecti-1200">playerID</span>
parameter is optional and is ignored if specified. In case of a player-specific OutputVariable the
<span 
class="ecti-1200">playerID </span>is obligatory, resulting in an error if not specified. The <span 
class="ecti-1200">game.get() </span>function
takes also the <span 
class="ecti-1200">roundIndex </span>as a mandatory parameter, specifying the round index for
which the output value should be fetched. Supposing a BGD implementation where the
first round has <span 
class="cmmi-12">roundIndex </span><span 
class="cmr-12">= 0 </span>for the rest of this chapter, any access to a negative
roundIndex will return the initial state of the variable which is part of the initial game state
<span 
class="cmmi-12">S</span><sub><span 
class="cmr-8">0</span></sub>.
<!--l. 135--><p class="noindent" >Both output-adding methods introduced at the beginning of this paragraph take two
parameters: the first being obligatory and of type OutputVariable, the second being an
optional Chart object. As with the inputs, the Chart object is used to visualise outputs. In
summary, the OutputVariable object resembles InputVariable. It must define the name and
the calculationFunction attribute and it should define an initial value and a validation
                                                                                         
                                                                                         
expression.
<!--l. 137--><p class="noindent" >The <span 
class="ecti-1200">calculationFunction </span>attribute links the OutputVariable object to a function. This function
represents the algorithm which defines how the output is calculated. It is thus the programmatic
counterpart to a state transition function as introduced in equation <a 
href="#x1-17004r4">3.4<!--tex4ht:ref: eq:transition2 --></a>. If the function is linked
with a player-specific OutputVariable (or an InputVariable as described in the last paragraph)
it must be defined with <span 
class="ecti-1200">playerID </span>as parameter. If it is linked with a round-specific
OutputVariable it must be defined without parameters. It must always return a value which is
within the domain of the output (or input) variable which it is supposed to calculate.
When the game is played, the game engine calls this function every round in order
to calculate the output (or input) value. For a player-specific OutputVariable or an
InputVariable it will be called for each player with the playerID of the current player passed as
parameter. For a round-specific OutputVariable it will be called once per round without
parameters.
<!--l. 139--><p class="noindent" >Defining an attribute of type <span 
class="ecti-1200">Function </span>may seem strange. This is why it should be noted here that
the programming language used to implement BGD should for the sake of efficiency support
first-class functions and closures. The first means that a function is nothing else than an object
which can be for example stored in a variable or passed as parameter to another function. Like
this the calculationFunction attribute of a Variable object can be of type Function. A
closure means that a function has access to the variables from the context from which it
was called. The implementation described in chapter <a 
href="#x1-580005">5<!--tex4ht:ref: cha:implementation --></a> provides further details on this
topic.
<!--l. 141--><p class="noindent" >As mentioned before, an OutputVariable object should have the initialValue and <br 
class="newline" />validationExpression attribute which means it is strongly recommended to include them in every
game implementation. A missing initialValue means that the game state <span 
class="cmmi-12">S</span><sub><span 
class="cmr-8">0</span></sub> is not fully described.
Any access to the missing part will result in an error. The validationExpression in output variables
is extremely useful in order to validate the correctness of the implementation of the
state transition functions. If an error in some function or in the interaction between
several functions produces an output value which is not within the correct domain, the
error from a failing validation expression can accelerate and facilitate the debugging
process.
<!--l. 144--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.2.1.3   </span> <a 
 id="x1-370004.2.1.3"></a>Score function</h5>
<!--l. 147--><p class="noindent" >The game developer can register a score function by passing it as a parameter to the
<br 
class="newline" /><span 
class="ecti-1200">game.addScore() </span>method. The score function should look like a <span 
class="ecti-1200">calculationFunction </span>of a
PlayerVariable as described in the last subsection and follow the definition from equation <a 
href="#x1-17007r7">3.7<!--tex4ht:ref: eq:score --></a>.
Consequently it is a function which takes the playerID as parameter and which returns a score
value <span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="msbm-10x-x-120">&#x211D;</span>. Every game should implement a score function, since otherwise it won&#8217;t have a winner
and the players cannot get evaluated individually.
<!--l. 149--><p class="noindent" >Internally, the concept of the score function uses the same mechanism as variables. The
<br 
class="newline" /><span 
class="ecti-1200">game.addScore() </span>call will result in the automatic creation of two OutputVariable objects,
                                                                                         
                                                                                         
one being player-specific and one being round-specific. Both are added at the end of
the Game object&#8217;s array of output variables. Since they are added at the end, when
playing the game, all other outputs of all previous rounds including the current one have
been calculated before and can be accessed in the <span 
class="ecti-1200">calculationFunction </span>of the two new
objects.
<!--l. 151--><p class="noindent" >The first of these new OutputVariables is called <span 
class="ecti-1200">roundScore </span>and its <span 
class="ecti-1200">calculationFunction </span>is
the player-specific score function specified by the game developer. The second is called
<span 
class="ecti-1200">accumulatedScore</span>. Its calculationFunction is automatically generated and defined as introduced in
equation <a 
href="#x1-17008r8">3.8<!--tex4ht:ref: eq:accumulated --></a>. If an optional Chart object was passed as second parameter to the <span 
class="ecti-1200">game.addScore()</span>
method, it will be used to visualise the <span 
class="ecti-1200">accumulatedScore </span>variable which shows in each round the
total score of each player so far reached.
<!--l. 153--><p class="noindent" >The <span 
class="ecti-1200">game.addCollectiveScore() </span>method is the second score-related functionality of the Game
object. Game developers can use it to register a <span 
class="ecti-1200">collective score </span>function which evaluates the
performance of the players altogether in one period as defined in equation <a 
href="#x1-17009r9">3.9<!--tex4ht:ref: eq:collectivescore --></a>. For example in
the <span 
class="ecti-1200">Beergame</span>, which was described by John Sterman <span class="cite">[<a 
href="#Xbeergame">Ste89</a>]</span>, the players are asked
to minimise the collective costs over the whole supply chain (collective score) while
only having local information about their own costs (individual score). The concept
of collective scores can be used to model such a behaviour. Internally it works in the
same way as the individual score, adding two OutputVariables <span 
class="ecti-1200">collectiveRoundScore </span>and
<span 
class="ecti-1200">accumulatedCollectiveScore</span>.
<!--l. 155--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.2.1.4   </span> <a 
 id="x1-380004.2.1.4"></a>Questionnaire object</h5>
<!--l. 158--><p class="noindent" >Questionnaires as formulated in the requirements of section <a 
href="#x1-250004.1.1">4.1.1<!--tex4ht:ref: subsec:req:description --></a> can be included to a game by
calling the <span 
class="ecti-1200">game.addQuestionnaire() </span>method in the game code. It takes as first parameter the
name of the questionnaire, as second parameter a Questionnaire object and as last parameter a
position array.
<!--l. 160--><p class="noindent" >A Questionnaire object has a name and a position which are implicitly set by the <br 
class="newline" /><span 
class="cmmi-12">addQuestionnaire</span><span 
class="cmr-12">() </span>method. It further holds an array of <span 
class="ecti-1200">Questions</span>, of which each defines a
question name, a question text and an answer. The answer attribute can be either of type string or
of type array of strings. If it is of type string it can take the values "string" or "number",
indicating a question with variable input which may be textual or numeric. An answer of type
array of strings represents a question with predefined answers; each element in the array
becomes one of the options between which the player can choose in order to answer the
question.
<!--l. 163--><p class="noindent" >The last parameter, the position array, must be an array of numbers <span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="msbm-10x-x-120">&#x2115;</span> <span 
class="cmex-10x-x-120">&#x22C3;</span>
 <span 
class="cmsy-10x-x-120">{</span><span 
class="cmr-12">0</span><span 
class="cmsy-10x-x-120">} </span>defining
the point in time where the questionnaire will be shown. This means that the same
questionnaire can occur once or several times at different rounds of the game. Each entry in the
array stands for a round before which the questionnaire will turn up. A number bigger
than the maximal number of rounds of the game means that the questionnaire will
appear at the end while 0 indicates that it will appear before the first round of the
game.
                                                                                         
                                                                                         
<!--l. 165--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.2.1.5   </span> <a 
 id="x1-390004.2.1.5"></a>Utility and Mathematics object</h5>
<!--l. 168--><p class="noindent" >Both utility and mathematics objects provide access to functions which are supposed to facilitate
the game development and are not directly supported by the general purpose programming
language in which BGD is implemented. So far, one utility and four mathematical functions are
exemplarily specified. Future game implementations may bring up the need for further
functionality.
<!--l. 170--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-400004.2.1.5"></a><span 
class="ecbx-1200">Utility.</span></span>
With <span 
class="ecti-1200">game.util.getWeekNumber() </span>the game developer can get the calendar week of a date by
passing the corresponding date object to this function. This is useful for game implementations
where one period consists of one calendar week and their numbering e.g. in a chart should start
with the current week.
<!--l. 172--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-410004.2.1.5"></a><span 
class="ecbx-1200">Mathematics.</span></span>
There are two mathematical functions <span 
class="ecti-1200">random() </span>and <span 
class="ecti-1200">randomInt() </span>which are intended to help with
random numbers since those are often needed for implementations of artificial agents. Both take a
numeric minimum <span 
class="cmmi-12">min </span>and maximum <span 
class="cmmi-12">max </span>value as parameter and return a random value <span 
class="cmmi-12">rv </span>with
<span 
class="cmmi-12">rv </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmr-12">[</span><span 
class="cmmi-12">min,max</span><span 
class="cmr-12">)</span>, where <span 
class="cmmi-12">rv </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="msbm-10x-x-120">&#x211D; </span>for the first function and <span 
class="cmmi-12">rv </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="msbm-10x-x-120">&#x2124; </span>for the second function
respectively.
<!--l. 174--><p class="noindent" >The mathematics functions <span 
class="ecti-1200">proportionalDistribution() </span>and <span 
class="ecti-1200">inverseDistribution() </span>are inspired from
the BMDL <span 
class="ecti-1200">prop </span>and <span 
class="ecti-1200">pinv </span>commands <span class="cite">[<a 
href="#Xbmdl1">TTK<sup><span 
class="cmr-8">+</span></sup>02</a>]</span> and are useful for many game implementations.
Assuming a game where two players have to decide upon a price <span 
class="cmmi-12">p</span><sub><span 
class="cmr-8">1</span></sub> and <span 
class="cmmi-12">p</span><sub><span 
class="cmr-8">2</span></sub> in each period for a
product they want to sell. If the market volume is 100 tons (<span 
class="cmmi-12">distrV al</span>) and <span 
class="cmmi-12">p</span><sub><span 
class="cmr-8">1</span></sub> <span 
class="cmr-12">= 75</span><span 
class="feymr-10x-x-120">&#x20AC;</span>
(<span 
class="cmmi-12">distrByV al</span><sub><span 
class="cmr-8">1</span></sub>) and <span 
class="cmmi-12">p</span><sub><span 
class="cmr-8">2</span></sub> <span 
class="cmr-12">= 25</span><span 
class="feymr-10x-x-120">&#x20AC; </span>(<span 
class="cmmi-12">distrByV al</span><sub><span 
class="cmr-8">2</span></sub>) a proportional distribution of this market would mean
that player one can sell 75 tons at 75<span 
class="feymr-10x-x-120">&#x20AC; </span>and player two can sell 25 tons at 25<span 
class="feymr-10x-x-120">&#x20AC;</span>. However, the more
realistic distribution in this example would be a (proportional) inverse distribution, where player
one with the high price can only sell 25 tons and player two with the low price can sell 75
tons.
<!--l. 176--><p class="noindent" >For player <span 
class="cmmi-12">i </span>with <span 
class="cmmi-12">i </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n</span><span 
class="cmsy-10x-x-120">} </span>the proportional distribution is
                                                                                         
                                                                                         
<table 
class="align">
                     <tr><td 
class="align-odd"><span 
class="cmmi-12">propDistr</span><sub><span 
class="cmmi-8">i</span></sub> <span 
class="cmr-12">=</span> <img 
src="thesis36x.png" alt="    distrV al
&#x2211;n----------------
  i=1distrByV  ali"  class="frac" align="middle"> <span 
class="cmsy-10x-x-120">* </span><span 
class="cmmi-12">distrByV al</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmmi-12">,</span></td>                     <td 
class="align-even"></td>                     <td 
class="align-label"><a 
 id="x1-41001r1"></a>(4.1)                     </td></tr></table>
while the inverse distribution is defined as
<table 
class="align">
                      <tr><td 
class="align-odd"><span 
class="cmmi-12">invDistr</span><sub><span 
class="cmmi-8">i</span></sub> <span 
class="cmr-12">=</span> <img 
src="thesis37x.png" alt="&#x2211;----distrV-al-----
  n  propDistr -i 1
  i=1"  class="frac" align="middle"> <span 
class="cmsy-10x-x-120">* </span><span 
class="cmmi-12">propDistr</span><sub><span 
class="cmmi-8">i</span></sub><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sup><span 
class="cmmi-12">.</span></td>                      <td 
class="align-even"></td>                      <td 
class="align-label"><a 
 id="x1-41002r2"></a>(4.2)                      </td></tr></table>
<!--l. 185--><p class="noindent" >This reflects the three obligatory parameters of both distribution functions. The first parameter is
the <span 
class="ecti-1200">playerID</span>. The second parameter is called <span 
class="ecti-1200">distributionValue</span>. It may either be a number or the
name of a round-specific output variable. In the example above the distributionValue was 100
(tons). Supposed that the market volume is stored in the round-specific output variable with the
name of <span 
class="cmmi-12">marketV ol</span>, this name can just be passed as second parameter to one of the distribution
functions. The game engine will then retrieve the value of <span 
class="cmmi-12">marketV ol </span>for the current
round to calculate and set it as distributionValue. Passing the name of a player-specific
output variable or of an input variable (which is also player-specific) will result in an
error.
<!--l. 187--><p class="noindent" >The third parameter is called <span 
class="ecti-1200">distributeByVariableName</span>. This must be the name of a
player-specific output variable or the name of an input variable by which the distributionValue
should be proportionally or inversely distributed, as e.g. <span 
class="cmmi-12">price </span>in the example above.
<!--l. 189--><p class="noindent" >The fourth parameter <span 
class="ecti-1200">optionalRoundIndex </span>is optional. It is an array of (two) numeric entries <span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="msbm-10x-x-120">&#x2124;</span>.
OptionalRoundIndex[0] <span 
class="cmsy-10x-x-120">&#x2264; </span><span 
class="cmmi-12">t,t </span><span 
class="cmsy-10x-x-120">&#x2208;{</span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,T</span><span 
class="cmsy-10x-x-120">} </span>specifies the round index for the distributionValue, if it
refers to a variable. Using the example above it could be e.g.&#x00A0;expressed to always use the market
volume of the previous round instead of the current round as distribution value by setting
optionalRoundIndex[0] = currentroundIndex-1. OptionalRoundIndex[1] <span 
class="cmsy-10x-x-120">&#x2264; </span><span 
class="cmmi-12">t </span>is used as round index
for the distributeByVariable. If one or both values are not specified or if the whole parameter is
missing, the current round will be used for calculation.
                                                                                         
                                                                                         
<!--l. 192--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-420004.2.1.5"></a><span 
class="ecbx-1200">Others.</span></span>
Last but not least the two functions <span 
class="ecti-1200">game.getCurrentRound() </span>and <br 
class="newline" /><span 
class="ecti-1200">game.getNumberOfPlayers() </span>should be mentioned for their importance, even though they do not
belong to the Mathematics or Utility objects but directly to the Game object. The first returns the
index of the current round the game is in at the moment, where the round index for the first round
starts at zero. This feature is needed in virtually every state transition function in order to retrieve
an in/output of the current round, the previous round, and so on. The second function returns the
number of players <span 
class="cmmi-12">playerCount </span>that are actually playing the game (at runtime). This is also an
important functionality in many implementations since the developer at development time
does not know yet how many players are going to play but only provides the minimal
and maximal number of players. It can be used to retrieve variable values from the
game history for <span 
class="ecti-1200">all </span>players, using a loop from 0 to <span 
class="cmmi-12">playerCount </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1 </span>and assuming a
BGD implementation where <span 
class="cmmi-12">playerIDs </span><span 
class="cmr-12">= </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmr-12">0</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">1</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">}</span>. It is used for example in the
collectiveScore function of the Beergame where the costs over all players need to be summed
up.
<!--l. 194--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.2.2   </span> <a 
 id="x1-430004.2.2"></a>BGD development</h4>
<!--l. 197--><p class="noindent" >The requirements of section <a 
href="#x1-260004.1.2">4.1.2<!--tex4ht:ref: subsec:req:develop --></a> specify a development mechanism which should allow developers
to write, verify and transmit their game code and to register it in the system. Two major
approaches to realise this behaviour can be distinguished:
      <dl class="description"><dt class="description">
<span 
class="ecbx-1200">Manual verification.</span> </dt><dd 
class="description">The game developer writes his BGD-code in a text editor of his
      choice and transmits it via email or via an upload mechanism to a central human control
      instance. This instance performs a manual or semi-automatic check for malicious code
      and for mistakes. Syntax errors or minor semantic errors can be corrected by the control
      instance. If the code then works correctly it can be registered in the architecture. If it
      contains more severe errors the game developer is provided with feedback and asked
      to review his code.
      <!--l. 202--><p class="noindent" >Since BGD uses a general purpose programming language for game implementation,
      security concerns must be taken into account, because executing untrusted game code
      could harm the system. A manual code check would minimise this risk, at least if
      carried out with proper care. On the other hand it is a rather inflexible, time consuming
      and expensive solution, because it needs an experienced reviewer who is constantly
      occupied by game verification. It is unattractive for the game developer as well who
      wants to have immediate feedback on his implementation and does not want to wait
      for the reviewing-process.
                                                                                         
                                                                                         
      </dd><dt class="description">
<span 
class="ecbx-1200">Automatic verification.</span> </dt><dd 
class="description">Automatic verification means the installation of a system which
      automatises all steps previously undertaken by a manual reviewer. This implies that
      the game developer can upload his code as a file or write it within the system and have
      it then automatically checked for syntax and semantic errors as well as for malicious
      code. If the code is free of such errors and can be trusted, it is saved and registered
      in the system, otherwise the developer is provided with feedback. This approach is
      preferred since it makes the entire system more attractive and thus more likely to be
      used for active game development of round-based business games.</dd></dl>
<!--l. 207--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.2.2.1   </span> <a 
 id="x1-440004.2.2.1"></a>Automatic game verification</h5>
<!--l. 210--><p class="noindent" >The automatic verification system of the BGD development environment must provide feedback on
possible errors. It can be differentiated whether the error is related to the syntax or to the
semantics of the game code.
<!--l. 212--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-450004.2.2.1"></a><span 
class="ecbx-1200">Syntax.</span></span>
The syntax of BGD is defined by the programming language that is used for its implementation. A
typical syntax error would be for example a missing bracket. Open source parsers exist for all
major programming languages providing feedback if the parsing was successful or if and where
problems were detected. All further checks beyond the syntax of the code should only take place
after the syntax check has succeeded.
<!--l. 214--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-460004.2.2.1"></a><span 
class="ecbx-1200">Semantics.</span></span>
A semantically correct game implementation provides all the mechanisms and objects that are
needed to describe a round-based business game as seen in section <a 
href="#x1-170003.2.1">3.2.1<!--tex4ht:ref: subsec:framework --></a> and <a 
href="#x1-310004.2.1">4.2.1<!--tex4ht:ref: subsec:bgd:model --></a>. A semantic test
can for example check if all necessary state transition functions are specified but it cannot prove
the correctness of their implementation. This can be done only at runtime, for example in a
simulation.
<!--l. 216--><p class="noindent" >With <span 
class="ecti-1200">error</span>, <span 
class="ecti-1200">warning </span>and <span 
class="ecti-1200">success </span>three different alert levels can be distinguished. An error
signifies a missing or incorrect implementation of a feature that would always result in
failure at runtime. If a semantic error is detected, feedback should be provided and the
code should not be tested further or registered in the system. Checks should ensure
that
      <ul class="itemize1">
      <li class="itemize">all default parameters (<span 
class="cmmi-12">maxrounds</span>, <span 
class="cmmi-12">minplayers</span>, <span 
class="cmmi-12">maxplayers</span>, <span 
class="cmmi-12">timeout</span>) are specified,
                                                                                         
                                                                                         
      </li>
      <li class="itemize">all parameter values match against their validation expressions, if provided,
      </li>
      <li class="itemize">each variable has a name and that this name is unique among all variables,
      </li>
      <li class="itemize">at least one input variable is defined,
      </li>
      <li class="itemize">each input variable defines a semantically correct InputType object, which means that
      all obligatory attributes are set and the default value matches the domain,
      </li>
      <li class="itemize">each output variable specifies a calculation function,
      </li>
      <li class="itemize">each questionnaire has a unique name, a numeric position array and an array of valid
      Question objects with at least one entry.</li></ul>
<!--l. 228--><p class="noindent" >Warning or success means that the game can be further tested or registered in the system. A
warning signifies a missing feature that might result in failure at runtime. Feedback should be
provided and it should be tested that
      <ul class="itemize1">
      <li class="itemize">each input variable provides a calculation function because this is for example needed
      for simulation,
      </li>
      <li class="itemize">each output variable provides an initial value because otherwise the game might fail
      at runtime if the initial game state is accessed,
      </li>
      <li class="itemize">each output variable defines a validation expression in order to detect errors in state
      transition functions and facilitate their debugging,
      </li>
      <li class="itemize">the game provides a score function.</li></ul>
<!--l. 236--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.2.2.2   </span> <a 
 id="x1-470004.2.2.2"></a>Security considerations</h5>
<!--l. 239--><p class="noindent" >In a client-server architecture the central security-related question is whether the potentially
harmful game code gets executed on the server or on the client.
                                                                                         
                                                                                         
<!--l. 241--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-480004.2.2.2"></a><span 
class="ecbx-1200">Server-side.</span></span>
If untrusted code is executed on the server, strong security measures must be taken. The following
list shows possible measures with their advantages and disadvantages. All measures can also be
used in combination.
      <ul class="itemize1">
      <li class="itemize">The code can be searched with the help of regular expressions in order to forbid access
      to global variables or to critical functionality such as access to the file-system etc. This
      approach is quite weak and provides only little security since regular expressions are
      error-prone, need a lot of testing and it is very hard to cover every loophole the attacker
      might take.
      </li>
      <li class="itemize">When the code or parts of it get executed, a new worker process can be started,
      executing the piece of code in question. A new process is automatically separated from
      the process(es) of the server, which means it cannot access the same space of memory.
      If possible, this process should be started with limited privileges. The ability to do so
      depends on the technology that is used on the server as well as the platform it runs
      on.
      <!--l. 246--><p class="noindent" >In  general,  this  measure  requires  that  the  complete  inter-process  communication
      between  the  system  and  the  worker  process  must  be  established  over  a  pipe.
      This implies that all communication objects must be serializable, complicating the
      implementation of such a system. Depending on the technology used, functionality
      might exist which facilitates inter-process communication.
      <!--l. 248--><p class="noindent" >It furthermore results in the creation of many processes since each execution of for
      example a state transition function means running untrusted code which has to be
      secured in a new process. Depending on the number of games that currently run on
      the server and the number of variables and players of each game this measure produces
      a lot of overhead and can have a significant impact on the server&#8217;s performance.
      </li>
      <li class="itemize">In  order  to  reduce  this  overhead  one  could  try  to  start  only  one  worker  process
      responsible  for  every  execution  of  untrusted  code.  In  addition  to  the  necessity  of
      inter-process-communication this approach is very hard to synchronise.</li></ul>
<!--l. 252--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-490004.2.2.2"></a><span 
class="ecbx-1200">Client-side.</span></span>
In the case of BGD, speaking of a client means the browser of the player(s) since all games are
supposed to be browser-based. Consequently, security concerns need not be considered when
running untrusted code on the client-side since this is done everyday on the internet and taken care
off by the browser&#8217;s sandbox.
                                                                                         
                                                                                         
<!--l. 254--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-500004.3"></a>Business Game Engine (BGE)</h3>
<!--l. 257--><p class="noindent" >The term <span 
class="ecti-1200">Business Game Engine </span>(BGE) is used for the architecture as a whole. Business Game
Description (BGD) as well as all required environments from section <a 
href="#x1-240004.1">4.1<!--tex4ht:ref: sec:requirements --></a> are thus part of
BGE.
<!--l. 259--><p class="noindent" >Architecturally, BGE is a client-server environment with a database. One of its modules is the
<span 
class="ecti-1200">startpage</span>, which is comparable to the index.html file or the home page of a website. It should
contain a list with the names of all available business games on this instance of BGE and provides
access to all environments, namely the development, simulation, playing and analysis environment.
The development, simulation and playing environment are further discussed in the following
sections.
<!--l. 261--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.3.1   </span> <a 
 id="x1-510004.3.1"></a>Development environment</h4>
<!--l. 264--><p class="noindent" >For game development, BGE features the automatic verification development mechanism from
section <a 
href="#x1-430004.2.2">4.2.2<!--tex4ht:ref: subsec:bgd:develop --></a>. It consists of the modules <span 
class="ecti-1200">Online editor </span>and <span 
class="ecti-1200">Feedback screen </span>and accesses the
database. A full implementation provides at least the functionality <span 
class="ecti-1200">create</span>, <span 
class="ecti-1200">edit </span>and
<span 
class="ecti-1200">delete</span>.
      <dl class="description"><dt class="description">
<span 
class="ecbx-1200">Create.</span> </dt><dd 
class="description">Linked from the startpage the editor module is loaded. The game developer can
      input his BGD code here. The feedback screen module informs of possible syntax and
      semantic errors and might inform if parts of the code are considered to be malicious.
      If all tests have passed, the game code can be allowed to be written to the database,
      together with an unique game name, a password and optionally additional information
      about the developer, game content and so on. The password is used to grant access to
      the privileged operations edit and delete.
      </dd><dt class="description">
<span 
class="ecbx-1200">Edit.</span> </dt><dd 
class="description">Linked from the start page in combination with the choice of a specific game from the
      game list, the game code of this game is loaded into the editor module if the user is
      privileged to do so. He can then edit and save the game code under the same conditions
      as described in the <span 
class="ecti-1200">create </span>functionality. Parameter changes for instance are performed
      in this way.
      <!--l. 270--><p class="noindent" >In its easiest implementation, the edit functionality just updates the game code in
      the database. In order to log which version of a game was played in a specific game
      session, the current game code should be saved together with every game session. Other
      realisations might forbid editing an existing game which has already been played or
      implement a code history. The first implies creating a new game for every new version of
      a game with existing game data, which reduces flexibility. The latter is more expensive
      to implement since concurrent edits of different clients must by synchronised.
                                                                                         
                                                                                         
      </dd><dt class="description">
<span 
class="ecbx-1200">Delete.</span> </dt><dd 
class="description">This functionality deletes a game from the database if the correct password is
      provided.</dd></dl>
<!--l. 274--><p class="noindent" >The development environment might also implement a <span 
class="ecti-1200">show code </span>functionality which shows the
code in read-only mode without asking for a password.
<!--l. 276--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">4.3.2   </span> <a 
 id="x1-520004.3.2"></a>Simulation and playing environment</h4>
<!--l. 279--><p class="noindent" >Similar to the edit or delete functionality from above, the simulation and playing environment is
linked from the startpage after the user has chosen one specific game he wants to simulate or
play.
<!--l. 281--><p class="noindent" >The Game object introduced in the UML diagram in figure <a 
href="#x1-31001r1">4.1<!--tex4ht:ref: fig:uml --></a> holds an array of Round and Player
objects that were not discussed so far. This is the case, because they cannot be addressed by the
game developer at development time but become important at runtime, when simulating or
playing the game.
<!--l. 283--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.3.2.1   </span> <a 
 id="x1-530004.3.2.1"></a>Player</h5>
<!--l. 286--><p class="noindent" >The Player object describes a player using a name, nickname and email address. This selection is
only a proposition. In an BGE implementation where only registered users are allowed to play it
might be enough to use the playerID since all other information is already available in the
database. In an open BGE implementation other player-describing attributes might be
added.
<!--l. 288--><p class="noindent" >When a player <span 
class="cmmi-12">p</span><span 
class="cmr-12">1 </span>wants to play a game called <span 
class="cmmi-12">easyBG</span>, BGE creates a Player object <span 
class="cmmi-12">p</span><span 
class="cmr-12">1</span>_<span 
class="cmmi-12">obj </span>that
describes him and checks among all currently existing Game objects for a game with the name of
<span 
class="cmmi-12">easyBG </span>that has the <span 
class="ecti-1200">isOpen </span>attribute set to <span 
class="cmmi-12">true</span>. If such an object is found, the player joins it,
which means <span 
class="cmmi-12">p</span><span 
class="cmr-12">1</span>_<span 
class="cmmi-12">obj </span>is added to the Game object&#8217;s array of players. If such an object is not found,
either because all games of this type have already been started (<span 
class="cmmi-12">isOpen </span><span 
class="cmr-12">= </span><span 
class="cmmi-12">false</span>) or because no
such game exists at the moment, a new Game object is instantiated. Its name is <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj</span>, it is
open, <span 
class="cmmi-12">p</span><span 
class="cmr-12">1</span>_<span 
class="cmmi-12">obj </span>is the first object in its array of players and it is now waiting for other players to
join.
<!--l. 290--><p class="noindent" >The functionality described above is part of the <span 
class="ecti-1200">entrance hall </span>module of BGE. Depending on its
implementation, the game is started after the minimum number of players is reached or after the
game creator (the first player who joined the game) starts the game. In case of the latter,
additional virtual opponents can be added to the game, resulting in the <span 
class="ecti-1200">isBot </span>attribute of their
Player objects to be set to <span 
class="ecti-1200">true</span>.
<!--l. 292--><p class="noindent" >In the easiest implementation of the Player object, as already mentioned at the end of section
<a 
href="#x1-390004.2.1.5">4.2.1.5<!--tex4ht:ref: subsub:util --></a>, the playerIDs correspond to the indices of the Game object&#8217;s player array. This
                                                                                         
                                                                                         
means that <span 
class="cmmi-12">playerIDs </span><span 
class="cmr-12">= </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmr-12">0</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">}</span>. Supposing that <span 
class="cmmi-12">p</span><span 
class="cmr-12">1</span>_<span 
class="cmmi-12">obj.playerID </span><span 
class="cmr-12">= 1 </span>this means
that <span 
class="cmmi-12">p</span><span 
class="cmr-12">1 </span>was the second player who joined the game and that <span 
class="cmmi-12">game.players</span><span 
class="cmr-12">[1] </span>contains
<span 
class="cmmi-12">p</span><span 
class="cmr-12">1</span>_<span 
class="cmmi-12">obj</span>.
<!--l. 294--><p class="noindent" >If a game is simulated but not really played, a random number <span 
class="cmmi-12">rand </span>of artificial agent Player
objects is created, with <span 
class="cmmi-12">rand </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmr-12">[</span><span 
class="cmmi-12">minplayers,maxplayers</span><span 
class="cmr-12">] </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="msbm-10x-x-120">&#x2115; </span>and the game is started
immediately.
<!--l. 296--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.3.2.2   </span> <a 
 id="x1-540004.3.2.2"></a>Round</h5>
<!--l. 299--><p class="noindent" >Round objects become important after the game has been started. They are used to fully describe
the round of a game. When a new round is started, a new Round object is created and added to
the Game object&#8217;s array of rounds. During and at the end of the round, input and output values
are written to this Round object. The BGE module responsible for handling games that have been
started is called <span 
class="ecti-1200">game engine</span>.
<!--l. 301--><p class="noindent" >The content of a Round object, which means the majority of its attributes as well as their domain,
is dependent on the game that is played. Let us assume <span 
class="ecti-1200">easyBG </span>from the example above has the
input <span 
class="ecti-1200">price </span>and two outputs <span 
class="ecti-1200">marketVolume </span>and <span 
class="ecti-1200">profit</span>, the first being round-specific and the latter
being player-specific. The domain of all three variables is supposed to be numeric. This will result
in Round objects with the three game-dependent attributes <span 
class="ecti-1200">price, marketVolume </span>and
<span 
class="ecti-1200">profit </span>of which the first and the last are of type array of numbers and the second is of
type number. If <span 
class="ecti-1200">easyBG </span>specifies a score function, two more attributes with the name
<span 
class="ecti-1200">roundScore </span>and <span 
class="ecti-1200">accumulatedScore </span>of type array of numbers will be added to its Round
objects.
<!--l. 303--><p class="noindent" >In other words, each player-specific input or output variable is translated into an attribute with the
name of the variable and type array of string or array of number. The length of this array is the
number of players that are currently playing the game. The realisation of the input or output
variable for player <span 
class="cmmi-12">i</span>, after the input has been decided upon or the output has been calculated, is
stored in this array at index <span 
class="cmmi-12">i</span>, with <span 
class="cmmi-12">i </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmmi-12">playerIDs </span><span 
class="cmr-12">= </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmr-12">0</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n</span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">}</span>. A round-specific output variable
is translated in an attribute of type string or number which is used to store the realisation of this
output variable.
<!--l. 305--><p class="noindent" >If a BGE implementation uses <span 
class="cmmi-12">playerIDs</span><span 
class="cmmi-12">&#x2260;</span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmr-12">0</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">}</span>, an additional mapping function <span 
class="cmmi-12">mf</span>
with
                                                                                         
                                                                                         
<table 
class="align">
                            <tr><td 
class="align-odd"><span 
class="cmmi-12">mf</span> <span 
class="cmr-12">:</span> <span 
class="cmmi-12">playerIDs </span><span 
class="cmsy-10x-x-120">&#x2192;{</span><span 
class="cmr-12">0</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">}</span></td>                            <td 
class="align-even"></td>                            <td 
class="align-label"><a 
 id="x1-54001r3"></a>(4.3)                            </td></tr></table>
is needed, in order to retrieve a player-specific variable value or to access the corresponding Player
object.
<!--l. 311--><p class="noindent" >The following example illustrates how Round objects are used in the game engine module.
Assuming player <span 
class="cmmi-12">p</span><span 
class="cmr-12">1 </span>from the last section is playing <span 
class="ecti-1200">easyBG</span>, the entrance hall module is
implemented so that <span 
class="cmmi-12">playerIDs </span><span 
class="cmr-12">= </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmr-12">0</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">} </span>and the game is in the third round. <span 
class="cmmi-12">P</span><span 
class="cmr-12">1 </span>decides
to set up a price of 50<span 
class="feymr-10x-x-120">&#x20AC; </span>per ton and the market volume of this period as well as his
profit is calculated as 300 tons and 8000<span 
class="feymr-10x-x-120">&#x20AC;</span>. This results in <span 
class="cmmi-12">game.rounds</span><span 
class="cmr-12">[2]</span><span 
class="cmmi-12">.price</span><span 
class="cmr-12">[1] = 50</span>,
<span 
class="cmmi-12">game.rounds</span><span 
class="cmr-12">[2]</span><span 
class="cmmi-12">.marketV olume </span><span 
class="cmr-12">= 300 </span>and <span 
class="cmmi-12">game.rounds</span><span 
class="cmr-12">[2]</span><span 
class="cmmi-12">.profit</span><span 
class="cmr-12">[1] = 8000</span>. The command to
retrieve <span 
class="ecti-1200">p1&#8217;s </span>profit of the previous round in the game code would be <br 
class="newline" /><span 
class="cmmi-12">game.get</span><span 
class="cmr-12">(</span><span 
class="cmsy-10x-x-120">&#x2032;</span><span 
class="cmmi-12">profit</span><span 
class="cmsy-10x-x-120">&#x2032;</span><span 
class="cmmi-12">,game.getCurrentRound</span><span 
class="cmr-12">() </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1</span><span 
class="cmmi-12">, </span><span 
class="cmr-12">1)</span>.
<!--l. 313--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">4.3.2.3   </span> <a 
 id="x1-550004.3.2.3"></a>Game and simulation flow</h5>
<!--l. 316--><p class="noindent" >This section summarises all necessary steps that must be taken by the entrance hall
and game engine module in order to enable game play or simulation, using <span 
class="ecti-1200">easyBG </span>as
example.
                                                                                         
                                                                                         
<!--l. 318--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-560004.3.2.3"></a><span 
class="ecbx-1200">Entrance hall.</span></span>
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-56002x1">First player <span 
class="cmmi-12">p</span><span 
class="cmr-12">0 </span>joins the game. Create <span 
class="cmmi-12">p</span><span 
class="cmr-12">0</span>_<span 
class="cmmi-12">obj </span>and set <span 
class="cmmi-12">name </span><span 
class="cmr-12">= </span><span 
class="cmmi-12">p</span><span 
class="cmr-12">0</span>, <span 
class="cmmi-12">isBot </span><span 
class="cmr-12">= </span><span 
class="cmmi-12">false </span>and
      <span 
class="cmmi-12">abort </span><span 
class="cmr-12">= </span><span 
class="cmmi-12">false</span>. The abort attribute is set true if a player leaves a game before finishing
      it or if he does not decide within the maximal decision time. Additional information
      such as nickname, email etc. can be asked for as well.
      </li>
      <li 
  class="enumerate" id="x1-56004x2">Instantiate new Game object and store it in the variable <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj</span>. Set <span 
class="cmmi-12">ID </span>to an
      unique value, <span 
class="cmmi-12">name </span><span 
class="cmr-12">= </span><span 
class="cmmi-12">easyBG</span>, <span 
class="cmmi-12">isOpen </span><span 
class="cmr-12">= </span><span 
class="cmmi-12">true </span>and <span 
class="cmmi-12">currentRound </span><span 
class="cmr-12">= 0</span>. Add <span 
class="cmmi-12">p</span><span 
class="cmr-12">0</span>_<span 
class="cmmi-12">obj</span>
      to the <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj.players </span>array.
      </li>
      <li 
  class="enumerate" id="x1-56006x3">Wait for other players and add their objects when they join.
      </li>
      <li 
  class="enumerate" id="x1-56008x4">Start the game (the game engine module) when <span 
class="cmmi-12">playerCount </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmr-12">[</span><span 
class="cmmi-12">minplayers,</span><span 
class="cmmi-12">maxplayers</span><span 
class="cmr-12">]</span><span 
class="cmmi-12">. </span>If this is only a simulation, skip the previous steps, instantiate a game
      object with a valid number of artificial agents and immediately start the game.</li></ol>
<!--l. 325--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-570004.3.2.3"></a><span 
class="ecbx-1200">Game engine.</span></span>
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-57002x1">Load  the  game  code  of  <span 
class="ecti-1200">easyBG  </span>from  the  database  and  invoke  it.  For  example,
      easyBG holds the round-specific output variable <span 
class="cmmi-12">marketV olume</span>. In the game code this
      corresponds  with  the  line  <span 
class="cmmi-12">game.addRoundV ariable</span><span 
class="cmr-12">(</span><span 
class="cmmi-12">marketV olume</span>_<span 
class="cmmi-12">obj</span><span 
class="cmr-12">)</span>.  Running
      this piece of code will add <span 
class="cmmi-12">marketV olume</span>_<span 
class="cmmi-12">obj </span>to <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj</span>&#8217;s array of output
      variables. Recalling the security considerations in section <a 
href="#x1-470004.2.2.2">4.2.2.2<!--tex4ht:ref: subsub:security --></a> it is possible to execute
      the game code either on the server- or on the client-side. An implementation which
      chooses the first option should assure that <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj </span>is renamed to <span 
class="cmmi-12">game </span>for any
      game code execution. A client-side implementation should not bother since one client
      only plays one game at a time and <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj </span>can be named as <span 
class="cmmi-12">game </span>in the first
      place. In this option, however, it must be assured that the game code and the initial
      state of <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj </span>at the end of the entrance hall module are transmitted to every
      client participating in the game.
      </li>
      <li 
  class="enumerate" id="x1-57004x2">Set the initial values of all variables. As seen in section <a 
href="#x1-330004.2.1.2">4.2.1.2<!--tex4ht:ref: subsub:variables --></a> output and also input
      variables may define an initial value which forms the initial game state <span 
class="cmmi-12">S</span><sub><span 
class="cmr-8">0</span></sub>.
      </li>
      <li 
  class="enumerate" id="x1-57006x3">Start the first or the next round of the game creating a new Round object. Add this
      object to <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj</span>&#8217;s array of rounds.
                                                                                         
                                                                                         
      </li>
      <li 
  class="enumerate" id="x1-57008x4">Present questionnaire(s) to the players if this is a real game and if questionnaire(s)
      exists which must be shown before this round.
      </li>
      <li 
  class="enumerate" id="x1-57010x5">Wait for the input values of the players if this is a real game. If this is only a simulation,
      calculate the input values calling the <span 
class="cmmi-12">calculationFunction </span>of each input variable.
      </li>
      <li 
  class="enumerate" id="x1-57012x6">Calculate the results of this round by calling the <span 
class="cmmi-12">calculationFunction </span>of each output
      variable after all inputs have been submitted. This includes the execution of the score
      function(s) as seen in section <a 
href="#x1-370004.2.1.3">4.2.1.3<!--tex4ht:ref: subsub:score --></a>. Write these values to the Round object. In case of
      a client-side execution setting the server must first collect the inputs from each player
      and redistribute them to each client.
      <!--l. 334--><p class="noindent" >After the calculation on the client-side it might be considered that each client has to
      transmit the Round object back to the server for fraud detection since a player could
      manually alter a variable value in the Browser&#8217;s Javascript console. If such a fraud is
      detected, which means if not all Round objects submitted are completely identical, the
      server might abandon the game or take other measures.
      <!--l. 336--><p class="noindent" >Some games need incomplete information, which means the players have to be prevented
      in general from using the Javascript console in order to debug into the calculation
      process and check variable values. Client-side code can be rendered unreadable using
      code obfuscators<span class="footnote-mark"><a 
href="thesis3.html#fn1x4"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-57013f1"></a> .
      A BGE implementation is a big project, even an experienced Javascript developer
      would need a long time to find the calculation process in such an obfuscated code.
      Additionally, techniques exist to completely disable the User&#8217;s Javascript console<span class="footnote-mark"><a 
href="thesis4.html#fn2x4"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-57014f2"></a> .
      </li>
      <li 
  class="enumerate" id="x1-57016x7">Present the results of this round to the players displaying for example a chart of all
      variables for which a Chart object was supplied.
      </li>
      <li 
  class="enumerate" id="x1-57018x8">If this was the last round of the game: Present the final score to each player and save
      <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj </span>(now containing the complete game history) to the database. In case of
      a client-side execution each client must first transmit the final state of its Game object
      to the server and the server must save one of them.
      <!--l. 341--><p class="noindent" >If this was not the last round of the game: Increment the <span 
class="cmmi-12">currentRound </span>attribute of
      <span 
class="cmmi-12">easyBG</span>_<span 
class="cmmi-12">obj </span>and go back to step 3.</li></ol>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!--l. 1--><p class="noindent" >
                                                                                         
                                                                                         
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;5</span><br /><a 
 id="x1-580005"></a>Implementation</h2>
<!--l. 4--><p class="noindent" >This chapter describes which technologies can be used to implement BGE and how a model
realisation of the BGE modules can look like. A prototype is available on <br 
class="newline" /><span 
class="ecti-1200">http://games.fkmt.de</span>.
<!--l. 6--><p class="noindent" >Currently implemented BGs on this instance are the <span 
class="ecti-1200">beergame </span><span class="cite">[<a 
href="#Xbeergame">Ste89</a>]</span>, <span 
class="ecti-1200">SaltSeller </span><span class="cite">[<a 
href="#Xsaltseller">KUS<sup><span 
class="cmr-8">+</span></sup>15</a>]</span>,
SaltSeller for many players (with a simplified market model), the example game from
the BMDL paper <span class="cite">[<a 
href="#Xbmdl1">TTK<sup><span 
class="cmr-8">+</span></sup>02</a>]</span>, the <span 
class="ecti-1200">oligopoly game </span>as well as <span 
class="ecti-1200">stone-paper-scissors</span>. The
game code of the beergame and of stone-paper-scissors is included in the appendix.
<hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-58001r1"></a><a 
 id="x1-63001r1"></a>
                                                                                         
                                                                                         
<!--l. 9--><p class="noindent" ><img 
src="figures/architecture.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5.1: </span><span  
class="content">BGE architecture overview</span></div><!--tex4ht:label?: x1-58001r1 -->
                                                                                         
                                                                                         
<!--l. 12--><p class="noindent" ></div><hr class="endfigure">
<h3 class="sectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-590005.1"></a>Choice of technology</h3>
<!--l. 17--><p class="noindent" >Figure <a 
href="#x1-58001r1">5.1<!--tex4ht:ref: fig:arch --></a> provides an architecture overview of this implementation of BGE. The following
sections describe in detail which technologies are being used and for what reason this is
done.
<!--l. 19--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.1.1   </span> <a 
 id="x1-600005.1.1"></a>BGD object model</h4>
<!--l. 22--><p class="noindent" >The first question to arise is the choice of the object-oriented programming language that is used
to implement BGD. Recalling the UML diagram from figure <a 
href="#x1-31001r1">4.1<!--tex4ht:ref: fig:uml --></a> it is obvious that its most
straightforward implementation contains a lot of dynamic types:
      <ul class="itemize1">
      <li class="itemize">The type of (function)parameters and attributes or the return type are often decided
      only at runtime, depending on the game which is currently played. A (game)parameter
      for instance might be a string or a numerical value and the return type of the <br 
class="newline" /><span 
class="cmmi-12">getParameter</span><span 
class="cmr-12">() </span>method is consequently either a string or a number.
      </li>
      <li class="itemize">Some functions accept optional parameters as for example an optional Chart object.
      </li>
      <li class="itemize">Some objects must be extended at runtime. The content of the Round object for
      example is entirely dependent on the game that is currently played.</li></ul>
<!--l. 28--><p class="noindent" >As conclusion it seems advisable to refrain from using a static programming language such as Java,
C or C# and to prefer a scripting language such as Perl, Python or JavaScript. In addition, all of
these three scripting languages natively support first-class functions which facilitates the
implementation as seen in section <a 
href="#x1-330004.2.1.2">4.2.1.2<!--tex4ht:ref: subsub:variables --></a>.
<!--l. 30--><p class="noindent" >The success of a BGE implementation depends on whether the platform can be deployed securely
without posing potential risks to the server. The list of security measures from section <a 
href="#x1-470004.2.2.2">4.2.2.2<!--tex4ht:ref: subsub:security --></a> in
order to run untrusted code on the server is neither complete nor easy to achieve. As a
consequence, the second option of running all untrusted code in the browser is preferred. This has
also the advantage that the server becomes a mere orchestrator and that the clients
take all the load for the calculation of the games&#8217; market models. JavaScript being
natively supported by all browsers is therefore the favoured programming language
for this BGD implementation and taken as assumption for the remaining part of this
chapter.
                                                                                         
                                                                                         
<!--l. 32--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.1.2   </span> <a 
 id="x1-610005.1.2"></a>Client-server-communication: the WebSocket Protocol</h4>
<!--l. 35--><p class="noindent" >In a multiplayer BG a great deal of realtime synchronization must take place between the server
and the participating players/clients. An implementation with client-side game code execution
must support at least the following communication steps:
      <ul class="itemize1">
      <li class="itemize">A client must be able to request to play a certain game.
      </li>
      <li class="itemize">The server must join clients together who want to play the same game and inform the
      players to either wait for other players or to start the game if a sufficient number of
      players has been reached.
      </li>
      <li class="itemize">The players submit input decisions or questionnaire answers to the server.
      </li>
      <li class="itemize">The  server  must  collect  these  inputs  and  redistribute  them  to  the  clients  for
      output-calculation after all players have submitted their inputs.
      </li>
      <li class="itemize">If a player does not answer within the maximal decision time or leaves the game before
      it has finished the server must disconnect this client, record the abort and use default
      input values for this player for the rounds to come.
      </li>
      <li class="itemize">The clients must submit their output calculation results after each round or at least
      at the end of the game so that the server can store the game history to the database.</li></ul>
<!--l. 45--><p class="noindent" >The type of communication channel between client and server over the internet is defined by a
communication protocol supported by the browser as well as by the server. Communication
protocols are part of the application layer of the OSI model and rely on transport protocols such as
TCP or UDP.
<!--l. 47--><p class="noindent" >HTTP is a frequently used communication protocol in the internet. Here, any message or
data or response from the server must be triggered by a request from the client. The
communication is uni-directional since a given instance of HTTP cannot be used to
send data in both directions, but only from the client to the server or the other way
around.
<!--l. 49--><p class="noindent" >Previous experiences of implementing a multiplayer BG <span class="cite">[<a 
href="#Xsaltseller">KUS<sup><span 
class="cmr-8">+</span></sup>15</a>]</span> have shown that using HTTP
for communication and synchronization between server and clients leads to a rather complex
implementation. The game and the round objects must know different states. A round may for
example know the states <span 
class="ecti-1200">running </span>and <span 
class="ecti-1200">done </span>depending on whether some or all inputs have been
submitted by the players. Depending on the combination of the current game state and round state
different actions must be taken (e.g.&#x00A0;calculate outputs if all inputs are submitted) and a certain
html page must be rendered or the HTTP request must be redirected to the same or to another
location.
                                                                                         
                                                                                         
<!--l. 51--><p class="noindent" >Since every communication in HTTP must be initiated by the client, each client must send a
HTTP AJAX request in a fixed interval (e.g.&#x00A0;each second) checking the new game and round
state, which is called HTTP polling. Assuming there are two players A and B. If A has already
submitted its input value but B has not done yet, the last round state A knows is <span 
class="ecti-1200">running</span>.
After B has also submitted its input the round state changes to <span 
class="ecti-1200">done </span>and A sees with a
maximal delay of one second that its own round state and the true round state are
different. This triggers a reload of the page and the new state combination leads to some
action, in this case maybe the calculation of the outputs and the rendering of a result
page.
<!--l. 53--><p class="noindent" >As a summary, the use of HTTP in <span class="cite">[<a 
href="#Xsaltseller">KUS<sup><span 
class="cmr-8">+</span></sup>15</a>]</span> led to
      <ul class="itemize1">
      <li class="itemize">network overhead for HTTP polling, where a better multiplayer synchronization (with
      a smaller polling interval) results in bigger overhead,
      </li>
      <li class="itemize">a bad user experience due to page reloads,
      </li>
      <li class="itemize">a highly complex code with many HTTP redirects and different state combinations.</li></ul>
<!--l. 60--><p class="noindent" >A lot would be gained if the server could also initiate the communication and for example inform
its clients that all inputs have been submitted. Such a behaviour can be realised for instance
using the WebSocket Protocol <span class="cite">[<a 
href="#Xwebsocket">FM11</a>]</span> which has been introduced in 2011 and which is
now implemented in all major browsers. It establishes a full-duplex (bi-directional)
communication channel between server and client through which both can send data at any
time.
<!--l. 62--><p class="noindent" >As a main advantage, the WebSocket Protocol significantly facilitates the implementation of the
necessary communication steps. It is used for that reason as communication protocol within the
playing environment of BGE. All other environments do not need sophisticated synchronization
between server and clients, they only load resources from the server. HTTP was built
for that use case and is therefore used in all other environments except the playing
environment. The following part of this section describes the specification of the WebSocket
Protocol.
<!--l. 64--><p class="noindent" >In inter-process communication (IPC), sockets are the endpoints of a communication channel on
which both processes can send and receive data. Inter-process communication between two
processes on different machines can be established over a computer network such as the internet.
An internet socket is defined by the unique internet address of the machine (IP address), the
delivery slot of this instance of communication (port number) and a the name of the
transport protocol used (e.g. TCP or UDP), since different protocols can use the same port
<span class="cite">[<a 
href="#Xbsd">Sec86</a>]</span>.
<!--l. 66--><p class="noindent" >Web browsers do not allow to establish a raw communication channel based on e.g. TCP because
this would allow malicious scripts to attack various services on the internet listening on such a
connection which are not prepared to deal with harmful input. WebSockets add a layer on top of
TCP enabling such a bi-directional communication channel between two processes that are
explicitly prepared for it.
                                                                                         
                                                                                         
<!--l. 68--><p class="noindent" >For that reason the protocol specifies an URI-based addressing
mechanism<span class="footnote-mark"><a 
href="thesis5.html#fn1x5"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-61001f1"></a> ,
for example <span 
class="ecti-1200">wss://server.example.com/secureChat</span>. Therefore, a WebSocket connection is identified
by a scheme component (ws or wss for a TLS secured connection), a host, a port (optional,
defaults to 80/443) and a resource (optional, consists of path and/or query). Since several
hosts can be hosted one one machine and since it is possible to specify a resource this
implies that multiple WebSocket services can share one port and/or one IP address
<span class="cite">[<a 
href="#Xwebsocket">FM11</a>]</span>.
<!--l. 70--><p class="noindent" >In order to establish a WebSocket connection the client and the server must perform the
WebSocket handshake. WebSockets use TCP and can be optionally secured with TLS. The
client initialises the handshake with a HTTP GET request with Upgrade header. Using
HTTP and not another protocol for the handshake allows the WebSocket protocol to
coexist with the existing HTTP infrastructure sharing port 80/443 with HTTP clients
[Ibid.].
<!--l. 72--><p class="noindent" >In order to establish a WebSocket connection with the chat service mentioned above, a client
would open a TLS connection to <span 
class="ecti-1200">sever.example.com </span>and send a HTTPS GET request for
the resource&#x00A0;<span 
class="ecti-1200">\secureChat</span>. Among others this request must specify the Upgrade, Host
<span 
class="ecti-1200">(server.example.com)</span>, Origin <span 
class="ecti-1200">(api.mallory.com) </span>and Sec-WebSocket-Key Headers. The <span 
class="ecti-1200">Origin</span>
Header field is set by the browser indicating the origin of the script trying to access the service.
Typically, a server could only allow trusted scripts e.g. from <span 
class="ecti-1200">example.com </span>in the example above
and reject an unknown script from <span 
class="ecti-1200">mallory.com</span>. This does not replace authentication or input
validation because non-browser clients can also establish the WebSocket connection and can easily
fake the Origin header [Ibid.].
<!--l. 74--><p class="noindent" ><span 
class="ecti-1200">Sec-WebSocket-Key </span>is a base64-encoded 16 byte nonce which the server must concatenate with a
predefined GUID. If he accepts the client&#8217;s connection he must send a HTTP response with status
code 101 (Switching Protocols) which includes the <span 
class="ecti-1200">Sec-WebSocket-Accept </span>Header containing the
hashed value. The WebSocket connection cannot be established if this value doesn&#8217;t correspond
with the expected value. With this mechanism the server has to prove that he has received
and understood the client&#8217;s handshake accepting only WebSocket connections. This
prevents an attacker to send a message over another protocol as e.g. HTTP that looks
like a WebSocket message [Ibid.]. It also prevents from tricking non-WebSocket servers
to echo a valid WebSocket handshake response in order to establish an unauthorised
connection<span class="footnote-mark"><a 
href="thesis6.html#fn2x5"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-61002f2"></a> 
<span class="footnote-mark"><a 
href="thesis7.html#fn3x5"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-61003f3"></a>.
                                                                                         
                                                                                         
<!--l. 76--><p class="noindent" >After the WebSocket connection has been established both server and client can send and receive
data which must be framed as specified by the base framing protocol [Ibid.]. Frames may be
fragmented which means that the payload data can be splitted into several frames. This has the
advantage that intermediaries who know the protocol and which have seen the handshake can do
fragmentation according to network needs. It also implies that both client and server can start to
send a message before knowing its size and thus do not have to buffer it completely before
sending it. Among others, a frame specifies the content type (text, binary, reserved,
control frame or continuation of a fragment), the payload length and an optional masking
key.
<!--l. 78--><p class="noindent" >Clients must always mask every frame with a new 32 bit random nonce which is unpredictable
from within the end application providing the data. Servers must never mask a frame. If one party
violates this rules, the connection must be closed. The idea behind is that the client application
cannot predict how the data appears on the wire. Otherwise there is a chance that cache poisoning
attacks can be leveraged on transparent proxies which are often used for example in enterprise
networks to cache content <span class="cite">[<a 
href="#Xhack">HCB<sup><span 
class="cmr-8">+</span></sup>11</a>]</span>. In some cases, such intermediaries do not properly
implement the HTTP Upgrade mechanism causing the WebSocket handshake to succeed while still
interpreting the following traffic as HTTP traffic. If an attacking script is then able to predict how
the sent data appears on the wire it can send a WebSocket message to an attacking server which
looks like a valid HTTP GET request which is for example fetching a script such as <span 
class="ecti-1200">Google</span>
<span 
class="ecti-1200">Analytics </span>with the host <span 
class="ecti-1200">google.com</span>. The server will then send a response containing a
compromised script. For the proxy this looks like a valid response from Google and he now
caches the compromised script instead of the real one. All users of the proxy requesting
Google Analytics will then receive this compromised script instead of the real Google
Analytics.
<h4 class="subsectionHead"><span class="titlemark">5.1.3   </span> <a 
 id="x1-620005.1.3"></a>Server-side JavaScript</h4>
<!--l. 84--><p class="noindent" >WebSocket implementations are available for all server-side technologies such as Java EE, .Net,
Python or PHP. However, the event-like character of a WebSocket connection seems to be well
suited for JavaScript&#8217;s event-based, asynchronous execution model.
<!--l. 86--><p class="noindent" >
<h5 class="subsubsectionHead"><span class="titlemark">5.1.3.1   </span> <a 
 id="x1-630005.1.3.1"></a>Asynchronous execution model of JavaScript</h5>
<!--l. 89--><p class="noindent" >In the browser, when performing an I/O operations such as requesting remote content via an
AJAX call, or when waiting for an user interaction or setting a timeout, JavaScript does not block
the process and does not wait for the operation to complete, but continues to run other code that
follows next. As soon as the server delivers the content or the user clicks a button or the timer has
run down, the code associated with the operation is executed. Listing <a 
href="#x1-63001r1">5.1<!--tex4ht:ref: lst:javascript --></a> demonstrates this
behaviour for a programme that asynchronously fetches the HTML content of a website using the
jQuery library.
<!--l. 91-->
                                                                                         
                                                                                         
<a 
 id="x1-63002"></a>
 <br /> <div class="caption" 
><span class="id">Listing&#x00A0;5.1: </span><span  
class="content">JavaScript&#8217;s asynchronous execution model</span></div><!--tex4ht:label?: x1-63001r5.1 --><div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-63003r1"></a></span><span 
class="ectt-1000">jQuery</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">http</span><span 
class="ectt-1000">://</span><span 
class="ectt-1000">games</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">fkmt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">de</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">callback</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">AJAX</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">call</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63004r2"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">callback</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">data</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63005r3"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">console</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">log</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">data</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Prints</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">HTML</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">content</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">requested</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">website</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63006r4"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63007r5"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">pi</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculatePi</span><span 
class="ectt-1000">(1000000);</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Calculates</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Pi</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">with</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">M</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">decimal</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">places</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-63008r6"></a></span><span 
class="ectt-1000">console</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">log</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">Done</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Pi</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">pi</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Prints</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Done</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Pi</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">3.14..."</span>
 
</div>
<!--l. 99--><p class="noindent" >In most programming languages which use a synchronous execution model, a similar
programme would wait for the response from the requested website and then print its HTML
content on the standard output. After that it would start calculating Pi and finally
print <span 
class="ecti-1200">Done. Pi = 3,14... </span>Hovewer, the JavaScript programme from listing <a 
href="#x1-63001r1">5.1<!--tex4ht:ref: lst:javascript --></a> behaves
differently. In the first line, the HTTP GET request function gets executed with a callback
function passed to it as second parameter. Next, the calculation of Pi is immediately
started, without waiting for the network to respond. <span 
class="ecti-1200">Done. Pi = 3,14... </span>gets printed on
the standard output as soon as the result has been calculated. If in the meantime the
network has delivered, the callback function is executed and the HTML content is printed.
Otherwise the callback function printing HTML will be executed as soon as the network
responds.
<!--l. 101--><p class="noindent" >The JavaScript engine achieves this non-blocking behaviour for I/O and other asynchronous operations
using a call stack (also referred to as execution stack or just stack), a message queue and an event
loop<span class="footnote-mark"><a 
href="thesis8.html#fn4x5"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-63009f4"></a> 
<span class="footnote-mark"><a 
href="thesis9.html#fn5x5"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-63010f5"></a>.
Messages (events) with an associated callback function get enqueued in response to external
events, such as a user clicking a button or a response arriving from a HTTP request. The event
loop continuously polls the queue for the next message and puts the associated callback function
on the call stack if and only if it finds the stack empty.
<!--l. 103--><p class="noindent" >Running the file<span class="footnote-mark"><a 
href="thesis10.html#fn6x5"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-63011f6"></a> 
containing the example above, the first function to be put on the call stack is an implicit <span 
class="ecti-1200">eval()</span>
function containing all the code from the file, which is similar to the <span 
class="ecti-1200">main() </span>function in C or
in C-derived languages. Next, the <span 
class="ecti-1200">jQuery.get() </span>function is put on top of that. It calls
the <span 
class="ecti-1200">open() </span>and <span 
class="ecti-1200">send() </span>functions from the browser-dependant implementation of the
                                                                                         
                                                                                         
XMLHttpRequest<span class="footnote-mark"><a 
href="thesis11.html#fn7x5"><sup class="textsuperscript">7</sup></a></span><a 
 id="x1-63012f7"></a> 
Web API<span class="footnote-mark"><a 
href="thesis12.html#fn8x5"><sup class="textsuperscript">8</sup></a></span><a 
 id="x1-63013f8"></a> ,
which is typically implemented in C(++) as part of the browser&#8217;s rendering engine
and which runs separated from the JavaScript engine in another thread of the browser
process. The XMLHttpRequest implementation is from now on in charge for sending
the HTTP GET request to <span 
class="ecti-1200">http://games.fkmt.de </span>and waiting for the response, which
results in removing all corresponding function calls from the stack of the JavaScript
engine and adding it to the stack of the rendering engine. At an unknown time in future,
when the response from the network is available, the rendering engine enqueues the
callback associated with this event of the available response in the message queue of the
JavaScript engine. If and only if its call stack is then empty, the callback function will be put
on the call stack by the event loop, which is continuously waiting for new events to
arrive.
<!--l. 105--><p class="noindent" >In the meantime, immediately after calling <span 
class="ecti-1200">jQuery.get()</span>, <span 
class="ecti-1200">calculatePi(1000000) </span>is put on the stack
starting its calculation. After it returns, the result is printed on the standard output (the Browser&#8217;s
console). The call stack is now empty since the end of the file has been reached, which means the
implicit <span 
class="ecti-1200">eval() </span>function can be taken from stack as well. The event loop of the JavaScript engine
then continuously polls the message queue for the next event that has been enqueued in
the past or that will be enqueued in the future and puts its associated callback on the
stack and then pauses polling until the stack is empty again. In the example above,
this results in printing the HTML content of the requested website on the standard
output.
<h5 class="subsubsectionHead"><span class="titlemark">5.1.3.2   </span> <a 
 id="x1-640005.1.3.2"></a>JavaScript on the server: Node.js</h5>
<!--l. 111--><p class="noindent" >JavaScript is omnipresent as scripting language in web browsers, but its
deployment on server-side is quite new. Ryan Dahl introduced Node.js in 2009
as a "purely evented, non-blocking infrastructure to script highly concurrent
programs"<span class="footnote-mark"><a 
href="thesis13.html#fn9x5"><sup class="textsuperscript">9</sup></a></span><a 
 id="x1-64001f9"></a> .
Thus, the main idea behind Node.js is to provide the programmer with a server-side environment
where all I/O (file system, network, IPC, timers...) can only be done in a non-blocking,
asynchronous way. For that, Node.js uses the same concepts as a JavaScript engine, which are an
event loop and one single execution stack.
<!--l. 113--><p class="noindent" >In contrast to for example an Apache web server running a PHP or a Java application, Node.js
                                                                                         
                                                                                         
serves all clients within a single thread. This would not be possible if an I/O operations such as
querying the database from one request would block the other requests from being served. This is
why all I/O in Node.js is non-blocking. If client A requests something from the server&#8217;s
database, which is in computational terms a very slow operation and takes millions
of CPU clock cycles, Node will go on serving requests from other clients and call the
callback function associated with A&#8217;s request as soon as the content from the database is
available.
<!--l. 115--><p class="noindent" >In the conventional synchronous execution model, each client&#8217;s request is executed in a new thread
since a slow database operation would otherwise block the other clients from being served. Since
each new thread consumes a little of the server&#8217;s memory and the context switching also needs
some CPU time, the asynchronous model is well-suited to build scalable web applications which
can serve a lot of concurrent connections. The developer need not be experienced with complex
(thread-related) tasks such as synchronizing resources since each callback is finished and hence all
of its function calls have disappeared from the stack before another one is polled by the
event loop. It can thus be used to create efficient applications with comparably little
effort. Certainly, CPU-intensive tasks such as the calculation of Pi in listing <a 
href="#x1-63001r1">5.1<!--tex4ht:ref: lst:javascript --></a> block
such a single-threaded setting and must be either avoided or additional child processes
or clusters must be spawned <span class="cite">[<a 
href="#Xnodedoc">Nod15</a>]</span>, which might make implementations again more
difficult.
<!--l. 117--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-64002r2"></a>
                                                                                         
                                                                                         
<!--l. 119--><p class="noindent" ><img 
src="figures/node.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5.2: </span><span  
class="content">Node.js architecture overview. Source: stackoverflow.com/questions/36491385</span></div><!--tex4ht:label?: x1-64002r2 -->
                                                                                         
                                                                                         
<!--l. 122--><p class="noindent" ></div><hr class="endfigure">
<!--l. 123--><p class="noindent" >Figure <a 
href="#x1-64002r2">5.2<!--tex4ht:ref: fig:node --></a> shows an overview of the architecture of Node.js. The
API<span class="footnote-mark"><a 
href="thesis14.html#fn10x5"><sup class="textsuperscript">10</sup></a></span><a 
 id="x1-64003f10"></a> 
(Standard Library) of Node.js is written in JavaScript and enables the programmer among others
to access lower level functionality of the operating system via JavaScript. It is split into different
(core) modules providing built-in support for HTTP, TCP, UDP, DNS, TLS, filesystem
access, Processes, Buffers, Streams, Events and more. Apart from the core modules, the
programmer can import from a large number of other open-source modules via the node
package manager (NPM), which has grown the world&#8217;s largest ecosystem for open-source
libraries<span class="footnote-mark"><a 
href="thesis15.html#fn11x5"><sup class="textsuperscript">11</sup></a></span><a 
 id="x1-64004f11"></a> .
<!--l. 125--><p class="noindent" >All other parts than Node&#8217;s API are written in C or in C++. Node.js is built upon
Google&#8217;s JavaScript engine V8. One one hand, V8 is responsible for parsing the
user&#8217;s JavaScript programs and translating it to machine code. On the other hand,
V8 provides the Runtime environment, bridging native C++ functions and objects
into JavaScript objects. Like this, it is possible to "wrap C++ functions and data
structures within JavaScript objects so that they can be manipulated by JavaScript
scripts"<span class="footnote-mark"><a 
href="thesis16.html#fn12x5"><sup class="textsuperscript">12</sup></a></span><a 
 id="x1-64005f12"></a> .
Node.js uses V8 Object and Function Templates to achieve this behaviour. Browsers using V8
apply the same concept in order to expose native implementations of DOM, XMLHttpRequest or
other Web APIs to JavaScript and make them available for example as the global <span 
class="ecti-1200">Window</span>
object.
<!--l. 127--><p class="noindent" >In Node, most modules of the API have a native C++ counterpart (Node Bindings) providing the
actual functionality. For example, the <span 
class="ecti-1200">fs </span>module in <span 
class="ecti-1200">lib/fs.js </span>of the API is bound to <span 
class="ecti-1200">src/node_file.cc</span>
where file system related functionality such as open, read, write, stat and so on can be
found.
<!--l. 129--><p class="noindent" >However, Node&#8217;s design goal is to provide purely asynchronous, non-blocking I/O. For
example on the network or the file system, asynchronous means that an application
expresses interest in a remote resource or a file at one point and uses the data at a
different point of time and (memory) space. Non-blocking means that the process was
free to do other tasks in the meantime. In UNIX, regular file system I/O is always
blocking, while it might be blocking or non blocking in Windows, using a different
                                                                                         
                                                                                         
mechanism<span class="footnote-mark"><a 
href="thesis17.html#fn13x5"><sup class="textsuperscript">13</sup></a></span><a 
 id="x1-64006f13"></a> .
For asynchronous operations on network sockets, different operating systems provide different system
calls<span class="footnote-mark"><a 
href="thesis18.html#fn14x5"><sup class="textsuperscript">14</sup></a></span><a 
 id="x1-64007f14"></a> .
Node.js and other projects use the C-library <span 
class="ecti-1200">Libuv </span>in order to realise asynchronous,
non-blocking I/O on all major operating systems. It implements an event loop and
uses the same callback pattern as JavaScript in order to notify about an incoming
event<span class="footnote-mark"><a 
href="thesis19.html#fn15x5"><sup class="textsuperscript">15</sup></a></span><a 
 id="x1-64008f15"></a> 
as well as in order to specify the application logic connected to that certain event. Libuv was
created as part of the Node.js project as a replacement for <span 
class="ecti-1200">Libev </span>when Node was to be ported to
Windows. It can be described as a unified interface for asynchronous I/O on all major operating
systems. It tries to use the most efficient, non-blocking functionality that each operating system
provides for each different type of I/O. When there is no such functionality at all, as for example
with file system I/O in UNIX, Libuv uses a thread pool in order to emulate non-blocking
behaviour.
<!--l. 131--><p class="noindent" >An example: Listing <a 
href="#x1-64011r2">5.2<!--tex4ht:ref: lst:libuv --></a> shows a simple program that asynchronously reads from a file on the file
system, calling Libuv&#8217;s <span 
class="ecti-1200">uv_fs_open() </span>and <span 
class="ecti-1200">uv_fs_read() </span>functions. Both functions are passed
among others a pointer to the event loop, a request object and a callback function.
Libuv uses request objects to preserve the context between starting an asynchronous
operation and its callback. Thus, the request object is later passed to the callback as
parameter. For the rest of this example, the two callbacks are named <span 
class="ecti-1200">on_open </span>and
<span 
class="ecti-1200">on_read</span>.
      <dl class="description"><dt class="description">
<span 
class="ecbx-1200">Open.</span> </dt><dd 
class="description">The <span 
class="ecti-1200">uv_fs_open() </span>call is also passed a path to the file to be opened. Libuv then calls
      the <span 
class="ecti-1200">open()</span><span class="footnote-mark"><a 
href="thesis20.html#fn16x5"><sup class="textsuperscript">16</sup></a></span><a 
 id="x1-64009f16"></a> 
      facility of the operating system the example program is executed on. If this can be done
      only in a blocking way, such as on UNIX, Libuv gives this task to a thread pool. Many
      CPU cycles later, the file system responds with a file descriptor. Libuv then writes this
      file descriptor to the request object and calls <span 
class="ecti-1200">on_open</span>, passing it the request object as
      parameter. Since the example program is supposed to read from a file, <span 
class="ecti-1200">on_open  </span>calls
      <span 
class="ecti-1200">uv_fs_read()</span>, passing it the file descriptor representing the file to read from.
      </dd><dt class="description">
<span 
class="ecbx-1200">Read.</span> </dt><dd 
class="description">The <span 
class="ecti-1200">uv_fs_read() </span>call is also passed a buffer. Libuv calls the corresponding <span 
class="ecti-1200">read()</span>
                                                                                         
                                                                                         
      system call<span class="footnote-mark"><a 
href="thesis21.html#fn17x5"><sup class="textsuperscript">17</sup></a></span><a 
 id="x1-64010f17"></a> ,
      which writes into the buffer. Again, a thread pool is used if necessary. After the data
      has been read, Libuv writes the number of read bytes to the request object and calls
      <span 
class="ecti-1200">on_read </span>with the request object as parameter.</dd></dl>
<!--l. 137--><p class="noindent" >The event loop and thus a whole Libuv program run as long as there are events to watch out for.
The simple example program from listing <a 
href="#x1-64011r2">5.2<!--tex4ht:ref: lst:libuv --></a> terminates after the open and read have finished.
This is described by the two short-lived request objects that preserve the context between start
and end of the asynchronous operations. In more elaborate examples, a request represents an
asynchronous operation on a long-lived <span 
class="ecti-1200">handle </span>object. Handles are used to express interests in
events on I/O devices, processes or timers. Examples would be a handle on a TCP socket (e.g. for
writing a server) or a handle on a pipe (e.g. for streaming from/into a file or for inter-process
communication). In this case, the event loop terminates after the socket or the pipe have been
closed.
<!--l. 139-->
                                                                                         
                                                                                         
<!--l. 139--><p class="noindent" ><a 
 id="x1-64011r2"></a><a 
 id="x1-64035r3"></a><hr class="float"><div class="float" 
>
                                                                                         
                                                                                         
<a 
 id="x1-64012"></a>
  <div class="caption" 
><span class="id">Listing&#x00A0;5.2: </span><span  
class="content">Libuv example program. <br 
class="newline" />Based on https://github.com/nikhilm/uvbook/tree/master/code/uvcat</span></div><!--tex4ht:label?: x1-64011r5.1 --><div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-64013r1"></a></span><span 
class="ectt-1000">...</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Other</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">includes</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64014r2"></a></span><span 
class="ectt-1000">#</span><span 
class="ectt-1000">include</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">uv</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">h</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Include</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Libuv</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64015r3"></a></span><span 
class="ectt-1000">static</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">char</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">buffer</span><span 
class="ectt-1000">[1024];</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64016r4"></a></span><span 
class="ectt-1000">static</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_buf_t</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_buffer</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64017r5"></a></span><span 
class="ectt-1000">uv_fs_t</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">open_request</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Create</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">two</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">request</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">objects</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64018r6"></a></span><span 
class="ectt-1000">uv_fs_t</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">read_request</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64019r7"></a></span><span 
class="ectt-1000">void</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">on_read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">uv_fs_t</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">request</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64020r8"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fprintf</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">stdout</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">The</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">data</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">%</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">n</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_buffer</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">base</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64021r9"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fprintf</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">stdout</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bytes</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">%</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">\</span><span 
class="ectt-1000">n</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">request</span><span 
class="ectt-1000">-&#x003E;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64022r10"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64023r11"></a></span><span 
class="ectt-1000">void</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">on_open</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">uv_fs_t</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">request</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64024r12"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_buffer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_buf_init</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">buffer</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">sizeof</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">buffer</span><span 
class="ectt-1000">));</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64025r13"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_fs_read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">uv_default_loop</span><span 
class="ectt-1000">(),</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;</span><span 
class="ectt-1000">read_request</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64026r14"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">request</span><span 
class="ectt-1000">-&#x003E;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Contains</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">file</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">descriptor</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64027r15"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_buffer</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">...</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">on_read</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64028r16"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64029r17"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">argv</span><span 
class="ectt-1000">[1]</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">contains</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">file</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">path</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64030r18"></a></span><span 
class="ectt-1000">int</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">main</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">int</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">argc</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">char</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">**</span><span 
class="ectt-1000">argv</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64031r19"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_fs_open</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">uv_default_loop</span><span 
class="ectt-1000">(),</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;</span><span 
class="ectt-1000">open_request</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">argv</span><span 
class="ectt-1000">[1],</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">...</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">on_open</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64032r20"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">uv_run</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">uv_default_loop</span><span 
class="ectt-1000">(),</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">UV_RUN_DEFAULT</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Runs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">event</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">loop</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64033r21"></a></span><span 
class="ectt-1000">}</span>
 
                                                                                         
                                                                                         
</div><hr class="endfloat" />
</div>
<!--l. 163--><p class="noindent" >Recalling figure <a 
href="#x1-64002r2">5.2<!--tex4ht:ref: fig:node --></a>, how is Libuv to be integrated into the architecture of Node.js? The Node
Bindings embed V8 and use it to expose Libuv&#8217;s functionality to the JavaScript API. Listing <a 
href="#x1-64035r3">5.3<!--tex4ht:ref: lst:node --></a>
translates the C-program from listing <a 
href="#x1-64011r2">5.2<!--tex4ht:ref: lst:libuv --></a> into a (ES6) JavaScript program. After saving its content
to a file named for example <span 
class="ecti-1200">readfile.js</span>, the program can be executed with the command <span 
class="ecti-1200">node</span>
<span 
class="ecti-1200">readfile.js /path/to/file</span>. This will
      <ul class="itemize1">
      <li class="itemize">create a new V8 instance,
      </li>
      <li class="itemize">create a C++ Process object,
      </li>
      <li class="itemize">expose this object with V8 as the blueprint for the global <span 
class="ecti-1200">process </span>object of the Node
      API<span class="footnote-mark"><a 
href="thesis22.html#fn18x5"><sup class="textsuperscript">18</sup></a></span><a 
 id="x1-64034f18"></a> ,
      </li>
      <li class="itemize">additionally add a function called <span 
class="ecti-1200">binding() </span>to the process object, which is not described
      in the API but which allows JS code to access the C++ Bindings (this is used in the
      API core modules),
      </li>
      <li class="itemize">make V8 compile and run the startup script in <span 
class="ecti-1200">src/node.js </span>passing it the process object,
      </li>
      <li class="itemize">let the startup script install global objects and functions and the module loader in the
      user space, the latter enabling <span 
class="ecti-1200">require(moduleName) </span>to load the corresponding (core)
      module from the API,
      </li>
      <li class="itemize">read the content of <span 
class="ecti-1200">readfile.js </span>and run it,
      </li>
      <li class="itemize">due to <span 
class="ecti-1200">require(&#8217;fs&#8217;) </span>in the source code: load the file system core module and call its
      <span 
class="ecti-1200">read() </span>and <span 
class="ecti-1200">open() </span>functions,
      </li>
      <li class="itemize">via <span 
class="ecti-1200">process.binding(&#8217;fs&#8217;)</span>, the file system core module calls Read() and Open() from the
      C++ Bindings,
      </li>
      <li class="itemize">these functions call Libuv&#8217;s <span 
class="ecti-1200">uf_fs_open() </span>and <span 
class="ecti-1200">uv_fs_read()</span>, create two request objects
      and install the callbacks,
      </li>
      <li class="itemize">start Libuv&#8217;s event loop calling <span 
class="ecti-1200">uv_run() </span>and loop as long for incoming events as there
      are active handles or requests.</li></ul>
                                                                                         
                                                                                         
<!--l. 179-->
<a 
 id="x1-64036"></a>
 <br /> <div class="caption" 
><span class="id">Listing&#x00A0;5.3: </span><span  
class="content">Example program in JavaScript using Node.js.</span></div><!--tex4ht:label?: x1-64035r5.1 --><div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-64037r1"></a></span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">use</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">strict</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64038r2"></a></span><span 
class="ectt-1000">const</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">require</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">fs</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Load</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">file</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">system</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">core</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">module</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64039r3"></a></span><span 
class="ectt-1000">fs</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">open</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">process</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">argv</span><span 
class="ectt-1000">[1],</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">r</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">err</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fd</span><span 
class="ectt-1000">)=&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Arrow</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">functions</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ES6</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64040r4"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">err</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fd</span><span 
class="ectt-1000">)=&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">...</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">is</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">here</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">same</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">as</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">err</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fd</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">...</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64041r5"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">const</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">buf</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Buffer</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">alloc</span><span 
class="ectt-1000">(1024);</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Safe</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">buffer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">alloc</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">Node</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">v</span><span 
class="ectt-1000">.5.10.1+)</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64042r6"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">fs</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">fd</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">buf</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1024,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">null</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">err</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bytesRead</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">buffer</span><span 
class="ectt-1000">)=&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64043r7"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">console</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">log</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">The</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">data</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">buffer</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">toString</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">utf8</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">));</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64044r8"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">console</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">log</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bytes</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bytesRead</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64045r9"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">});</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-64046r10"></a></span><span 
class="ectt-1000">});</span>
 
</div>
<h5 class="subsubsectionHead"><span class="titlemark">5.1.3.3   </span> <a 
 id="x1-650005.1.3.3"></a>The big picture: Two event loops and WebSockets</h5>
<!--l. 195--><p class="noindent" >WebSockets, as stated at the beginning of this chapter, fit perfectly into the asynchronous,
event-based execution model of JavaScript and Node.js. Both server and client can send an event,
which is nothing more than a string, together with payload data at any time of the connection to
the other side. Here, a listener must be defined for that specific event specifying a callback
function. Whenever this specific event is sent, the listener is aware of the listened event and
executes a callback function with the payload data passed as parameter. Table <a 
href="#x1-70002r1">5.1<!--tex4ht:ref: tab:engine --></a> in the next
chapter specifies the concrete events and payload data that are used for the playing
environment.
<!--l. 198--><p class="noindent" >Figure <a 
href="#x1-65001r3">5.3<!--tex4ht:ref: fig:loops --></a> summarises the main idea of this BGE implementation: Architecture-wide use of the
expressive JavaScript programming language and of event-driven, asynchronous programming.
WebSockets, needed for the complex synchronisation in the playing environment, fit seamlessly into
that concept.
<!--l. 200--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-65001r3"></a>
                                                                                         
                                                                                         
<!--l. 202--><p class="noindent" ><img 
src="figures/loops.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5.3: </span><span  
class="content">BGE architecture: Two event loops and WebSockets.</span></div><!--tex4ht:label?: x1-65001r3 -->
                                                                                         
                                                                                         
<!--l. 205--><p class="noindent" ></div><hr class="endfigure">
<!--l. 207--><p class="noindent" >Following this reasoning, Node.js is seen to be an ideal server-side
technology for the implementation of BGE. The WebSocket library
<span 
class="ecti-1200">Socket.io</span><span class="footnote-mark"><a 
href="thesis23.html#fn19x5"><sup class="textsuperscript">19</sup></a></span><a 
 id="x1-65002f19"></a> 
is very easy to use and drastically simplifies realtime synchronizations
between server and clients. The web server realised with the framework
<span 
class="ecti-1200">Express</span><span class="footnote-mark"><a 
href="thesis24.html#fn20x5"><sup class="textsuperscript">20</sup></a></span><a 
 id="x1-65003f20"></a>  in combination with
the command-line tool <span 
class="ecti-1200">forever</span><span class="footnote-mark"><a 
href="thesis25.html#fn21x5"><sup class="textsuperscript">21</sup></a></span><a 
 id="x1-65004f21"></a> 
proved to be sufficient for setting up and maintaining the architecture on a Linux server with very
limited physical resources.
<!--l. 209--><p class="noindent" >Yet the main reason for choosing Node.js was another. Using JavaScript on the server significantly
facilitates the development process and maintains a very high flexibility since both client and
server speak the same language. In the beginning it was for example considered to execute game
code on the server-side. After the security measures from section <a 
href="#x1-470004.2.2.2">4.2.2.2<!--tex4ht:ref: subsub:security --></a> turned out to be very hard
to realise, the already existing BGE code could be shifted to the client without having to change
anything. With Node.js, native JavaScript objects such as the whole Game object serialised as
JSON become the data exchange format between server and client. This is &#8211; especially in
combination with WebSockets &#8211; a very powerful feature. Sending an object over the internet at any
point in the program code and in any direction becomes almost as simple as calling a
function.
<h4 class="subsectionHead"><span class="titlemark">5.1.4   </span> <a 
 id="x1-660005.1.4"></a>NoSQL Database</h4>
<!--l. 213--><p class="noindent" >HTTP is a stateless protocol. Due to this fact the database played a central role in the HTTP
implementation of the SaltSeller business game <span class="cite">[<a 
href="#Xsaltseller">KUS<sup><span 
class="cmr-8">+</span></sup>15</a>]</span>. Whenever some change occurred, as for
example the calculation of a round&#8217;s outputs or the game-abort of some player, this change needed
to be written to the database. The next HTTP request then fetched the newest state from the
database and kept on working with that. Especially when such a system has to serve a lot of
games simultaneously, such a frequent database access might become a performance
issue.
<!--l. 215--><p class="noindent" >The WebSocket Protocol is stateful, which means that the connection between server and client is
persistent until the client closes or refreshes the tab or redirects or gets redirected to
another HTML page. The use case of WebSockets should therefore be well considered
                                                                                         
                                                                                         
since establishing such a connection needs more resources than establishing a HTTP
connection.
<!--l. 217--><p class="noindent" >For the playing environment of BGE it is indeed worth that effort. Apart from the much simpler
implementation, the database becomes a backup tool for later game data analysis rather than a
system critical component. In this implementation of BGE, where all calculations are performed by
the clients, the game object is initialised on the client side and grows as the game evolves (section
<a 
href="#x1-500004.3">4.3<!--tex4ht:ref: sec:bge --></a>). Only after the game has finished the clients transmit the Game object, now containing
the complete game history, to the server, where it gets written to the database. The
number of database accesses thus significantly decreases, improving the performance of the
architecture.
<!--l. 219--><p class="noindent" >In consequence, performance indicators such as transactions per second or the maximum number
of records that can be stored need not play a major role for the choice of a database technology.
Even if a lot of games are played simultaneously the database is unlikely to become the bottleneck
of the architecture.
<!--l. 221--><p class="noindent" >Much more important are the costs or the effort for saving JavaScript JSON objects. Relational
databases are a firmly established technology, using relations (tables) with scalar values
(strings, numbers) for data storage. They have been developed for more than 40 years
and are widely in use in all industries employing information technology. Their query
language SQL is based on the sound mathematical concept of relational algebra and is
standardised for almost 20 years. In order to save objects of any object oriented programming
language as well as their relationships among each other into a relational database,
a mapping mechanism is needed which is referred to as Object Relational Mapping
(ORM).
<!--l. 223--><p class="noindent" >An ORM for the object model of BGD would typically map the Game object to the two
relations <span 
class="ecti-1200">game </span>and <span 
class="ecti-1200">round</span>. One game consists of many rounds which means each record
in the round-table holds the ID of the game to which it belongs (foreign key). The
game relation holds everything which stays the same during an entire game, such as
information about the players, questionnaires, parameter values and so on. The round relation
contains the input and output values of each round of the game as well as questionnaire
results.
<!--l. 225--><p class="noindent" >Since BGE generically supports round-based games with different data attributes, this mapping
cannot be static but must be created dynamically for every individual game. This asks for
implementing a model factory which translates a specific game into CREATE TABLE and
INSERT INTO statements of a certain relational database management system (RDBMS).
Such an implementation is expensive. Depending on the experience of the developer,
the number of RDBMSs supported and the test coverage it should take about 10 to
20 full development days. Furthermore, changes applied to an existing game may also
affect the data model, for example when introducing a new variable or parameter or
questionnaire. If such a change is to be translated into ALTER TABLE statements instead of
dropping and recreating the relations, the effort for implementing such an ORM further
increases.
<!--l. 227--><p class="noindent" >Document-oriented databases, often referred to as NoSQL, non-relational databases or object
databases, are a rather young technology. Their main idea is to save documents such as
                                                                                         
                                                                                         
YAML<span class="footnote-mark"><a 
href="thesis26.html#fn22x5"><sup class="textsuperscript">22</sup></a></span><a 
 id="x1-66001f22"></a> ,
XML or JSON directly without an additional mapping. Since they are quite new, their query
languages are not standardised. Each NoSQL database comes with its own query syntax which
must be learned by developers or data analysts and which may support more or less
features.
<!--l. 229--><p class="noindent" >MongoDB<span class="footnote-mark"><a 
href="thesis27.html#fn23x5"><sup class="textsuperscript">23</sup></a></span><a 
 id="x1-66002f23"></a> 
was one of the first document-oriented databases to arise. It is said to have a rich query
language<span class="footnote-mark"><a 
href="thesis28.html#fn24x5"><sup class="textsuperscript">24</sup></a></span><a 
 id="x1-66003f24"></a>  and a
big community<span class="footnote-mark"><a 
href="thesis29.html#fn25x5"><sup class="textsuperscript">25</sup></a></span><a 
 id="x1-66004f25"></a> 
<span class="footnote-mark"><a 
href="thesis30.html#fn26x5"><sup class="textsuperscript">26</sup></a></span><a 
 id="x1-66005f26"></a>. A
rich query language means that subsets of the stored data can be retrieved based on various
different query criteria. A large community signifies that many online resources such
as forums or blog entries exist which allows to familiarise more easily with the new
technology. Both points are important if a NoSQL database becomes a potential candidate for
BGE.
<!--l. 231--><p class="noindent" >The ACID properties are another important criterion for the choice of a database
technology. ACID stands for <span 
class="ecti-1200">Atomicity</span>, <span 
class="ecti-1200">Consistency</span>, <span 
class="ecti-1200">Isolation </span>and <span 
class="ecti-1200">Durability </span>and is fully
supported by relational databases. Atomicity and Isolation signifies that a transaction
(a series of read, write and/or update operations) either completes or fails as a
whole and that a concurrency model exists which serialises concurrent data access of
different clients. A NoSQL database such as MongoDB does not support this natively.
By default, MongoDB only guarantees write operations on a single document to be
                                                                                         
                                                                                         
atomic<span class="footnote-mark"><a 
href="thesis31.html#fn27x5"><sup class="textsuperscript">27</sup></a></span><a 
 id="x1-66006f27"></a> .
Thus, there are several possibilities how concurrent transactions might run into race conditions, if
not prevented by a proper implementation. A series of read and write (depending on what has
been read) on a single document might be interrupted and invalidated by another write
operation. The same applies for updates on multiple documents, where a document
can be seen as the equivalent of a table in a relational database. MongoDB provides
functionality and design patterns such as <span 
class="ecti-1200">findAndModify()</span>, embedded documents or
isolation<span class="footnote-mark"><a 
href="thesis32.html#fn28x5"><sup class="textsuperscript">28</sup></a></span><a 
 id="x1-66007f28"></a> 
in order to avoid race conditions. However, unlike with RDBMSs, this must be taken care off
by the developer on the application level. In the assessment of a database technology
the use-case must be therefore well evaluated. The potential gain from not having to
implement ORM might be outweighed by a more complex implementation assuring ACID
conformity.
<!--l. 233--><p class="noindent" >BGE uses the database mainly to save game sessions and to retrieve this data later for
game-analysis. A Game object is a single document in terms of NoSQL, writing it to the
database is thus an atomic operation. The read operations for data analysis cannot violate
ACID since only transactions containing write operations are in danger to do so. The
database is also used to save or update game code after creating or editing a business
game. The game code is saved together with an unique game name, the authors&#8217; names
and a game description in a single document. Writing it to the database is thus an
atomic operation. This implementation of the development environment from section
<a 
href="#x1-510004.3.1">4.3.1<!--tex4ht:ref: subsec:bge:d&a --></a> uses simple updates when a game is edited. In this case the update transaction is
also atomic since it is equivalent to a single write operation on a single document. The
current game code is saved together with every game session. An example: two clients
concurrently edit a game with a time difference of 1 ms and a third client starts a new game
session of this game between the two edits. The game version of the first client will be
persistent in the database for approximately 1 ms and it will be saved to the game session
of the third client. After that the game version of the second client is written to the
database.
<!--l. 235--><p class="noindent" >As a conclusion, the use-case of BGE contains no danger to run into race conditions whatsoever.
MongoDB is therefore chosen for this implementation of BGE since it is able to save JavaScript
JSON objects natively without having to implement an expensive mapping mechanism. The new
query syntax has proven to be expressive and can be easily learned thanks to a big community and
a JavaScript-like notation.
<h3 class="sectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-670005.2"></a>Module realisation</h3>
                                                                                         
                                                                                         
<!--l. 240--><p class="noindent" >This section describes how the BGE modules <span 
class="cmmi-12">startpage</span>, <span 
class="ecti-1200">online editor</span>, <span 
class="ecti-1200">feedback screen</span>, <span 
class="ecti-1200">entrance</span>
<span 
class="ecti-1200">hall</span>, <span 
class="ecti-1200">game engine </span>as well as the Game analysis environment are implemented on this prototype of
BGE.
<!--l. 242--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.2.1   </span> <a 
 id="x1-680005.2.1"></a>Startpage</h4>
<!--l. 245--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-68001r4"></a>
                                                                                         
                                                                                         
<!--l. 247--><p class="noindent" ><img 
src="figures/startpage.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5.4: </span><span  
class="content">Startpage module</span></div><!--tex4ht:label?: x1-68001r4 -->
                                                                                         
                                                                                         
<!--l. 250--><p class="noindent" ></div><hr class="endfigure">
<!--l. 252--><p class="noindent" >Figure <a 
href="#x1-68001r4">5.4<!--tex4ht:ref: fig:startpage --></a> shows a realisation of the startpage module with all the business games that are
currently available on the BGE implementation on <span 
class="ecti-1200">http://games.fkmt.de</span>. The create, show, edit
and delete buttons link to the development environment as described in section <a 
href="#x1-510004.3.1">4.3.1<!--tex4ht:ref: subsec:bge:d&a --></a>. The other
buttons link to the playing, simulation and analysis environment.
<h4 class="subsectionHead"><span class="titlemark">5.2.2   </span> <a 
 id="x1-690005.2.2"></a>Online editor and feedback screen</h4>
<!--l. 257--><p class="noindent" >The online editor module is used in the development, simulation and playing environment. In the
development environment it enables to create new business games or to show or to edit the
game code of existing games. In the simulation environment the editor displays the
results or the errors of the simulation. In the playing environment it is optionally used if
turned on in the source code in order to present game results to the players (below the
charts).
<!--l. 259--><p class="noindent" >The feedback screen is used for game validation in the development environment. It shows
syntactic or semantic errors when creating or editing a game as described in section
<a 
href="#x1-440004.2.2.1">4.2.2.1<!--tex4ht:ref: subsub:verification --></a>. Figure <a 
href="#x1-69001r5">5.5<!--tex4ht:ref: fig:editor --></a> shows the editor and feedback screen module displaying a semantic
error.
<!--l. 261--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-69001r5"></a>
                                                                                         
                                                                                         
<!--l. 263--><p class="noindent" ><img 
src="figures/editor.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5.5: </span><span  
class="content">Editor and feedback screen module</span></div><!--tex4ht:label?: x1-69001r5 -->
                                                                                         
                                                                                         
<!--l. 266--><p class="noindent" ></div><hr class="endfigure">
<!--l. 268--><p class="noindent" >The editor is based on the open-source Eclipse project
<span 
class="ecti-1200">Orion</span><span class="footnote-mark"><a 
href="thesis33.html#fn29x5"><sup class="textsuperscript">29</sup></a></span><a 
 id="x1-69002f29"></a>  which
aims to create a browser based integrated development environment (IDE). It uses the open-source JavaScript
parser <span 
class="ecti-1200">Esprima</span><span class="footnote-mark"><a 
href="thesis34.html#fn30x5"><sup class="textsuperscript">30</sup></a></span><a 
 id="x1-69003f30"></a> 
for the syntax analysis of the game code. Esprima is furthermore used together with the <span 
class="ecti-1200">escodegen</span>
project<span class="footnote-mark"><a 
href="thesis35.html#fn31x5"><sup class="textsuperscript">31</sup></a></span><a 
 id="x1-69004f31"></a> 
for reformatting the source code after loading it from the database (show or edit). Reformatting is
also used for the presentation of simulation results.
<h4 class="subsectionHead"><span class="titlemark">5.2.3   </span> <a 
 id="x1-700005.2.3"></a>Entrance hall and game engine</h4>
<!--l. 273--><p class="noindent" >The entrance hall and the game engine module enable game play and simulation as
described in section <a 
href="#x1-520004.3.2">4.3.2<!--tex4ht:ref: subsec:bge:simplay --></a>. The entrance hall is implemented so that the game starts
automatically after the minimal number of players is reached and in such a way that
<span 
class="cmmi-12">playerIDs </span><span 
class="cmr-12">= </span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmr-12">0</span><span 
class="cmmi-12">,</span><span 
class="cmmi-12">&#x2026;</span><span 
class="cmmi-12">,n </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmr-12">1</span><span 
class="cmsy-10x-x-120">}</span>.
<!--l. 275--><p class="noindent" >The game engine implements client-side game code execution. Table <a 
href="#x1-70002r1">5.1<!--tex4ht:ref: tab:engine --></a> provides an overview of
the WebSocket events on server and client and the corresponding actions they trigger. The list is
nearly complete. It only misses the <span 
class="ecti-1200">abort </span>event which is emitted by the client if a player
disconnects from the game during game play (closes or refreshes the tab) or does not provide
inputs within the maximal decision time. The server then marks the game as aborted in
the corresponding Player object and uses default input values or the last input values
submitted for the rounds to come in order to allow the other players to continue the
game.
<!--l. 277--><p class="noindent" >This implementation of the game engine module uses Google
Charts<span class="footnote-mark"><a 
href="thesis36.html#fn32x5"><sup class="textsuperscript">32</sup></a></span><a 
 id="x1-70001f32"></a> 
for rendering Chart objects. Figure <a 
href="#x1-70003r6">5.6<!--tex4ht:ref: fig:play --></a> shows an example game session of the <span 
class="ecti-1200">SaltSeller</span>
business game after two rounds have been played. Figure <a 
href="#x1-70004r7">5.7<!--tex4ht:ref: fig:questionnaire --></a> gives an example of a
questionnaire.
                                                                                         
                                                                                         
<div class="table">
                                                                                         
                                                                                         
<!--l. 280--><p class="noindent" ><a 
 id="x1-70002r1"></a><hr class="float"><div class="float" 
>
                                                                                         
                                                                                         
<div class="tabular"> <table id="TBL-6" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-6-1g"><col 
id="TBL-6-1"></colgroup><colgroup id="TBL-6-2g"><col 
id="TBL-6-2"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-6-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-1-1"  
class="td11"> <!--l. 282--><p class="noindent" ><span 
class="ecbx-1200">Client</span>                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-1-2"  
class="td11"> <!--l. 282--><p class="noindent" ><span 
class="ecbx-1200">Server</span>                                          </td></tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-2-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-2-1"  
class="td11"> <!--l. 284--><p class="noindent" >- Client connects and is asked to submit
  nickname <br 
class="newline" />- <span 
class="ecbx-1200">Emit event "play"</span>. Data: nickname and
  gamename                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-2-2"  
class="td11"> <!--l. 286--><p class="noindent" >                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-3-1"  
class="td11"> <!--l. 286--><p class="noindent" >&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;&#x003E;     </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-3-2"  
class="td11"> <!--l. 286--><p class="noindent" ><span 
class="ecbx-1200">On "play"</span>: <br 
class="newline" />- load gamecode from database <br 
class="newline" />- Create Player object <br 
class="newline" />- Join existing or create new game <br 
class="newline" />-  <span 
class="ecbx-1200">Emit  "wait  join"  </span>if  minimal  player
  number not yet reached <br 
class="newline" />-  Otherwise:  <span 
class="ecbx-1200">emitAll  "init" </span>Data:  game
  code, player objects                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-4-1"  
class="td11"> <!--l. 292--><p class="noindent" ><span 
class="ecbx-1200">On "init"</span>: <br 
class="newline" />- Instantiate new Game object <br 
class="newline" />- Run game code <br 
class="newline" />- Render input fields and questionnaires <br 
class="newline" />- Wait for input or show questionnaire <br 
class="newline" />- <span 
class="ecbx-1200">Emit "input" </span>Data: inputs of all players
  or save questionnaire results to the Game
  object when user submits.                         </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-4-2"  
class="td11"> <!--l. 297--><p class="noindent" >&#x003C;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;    </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-5-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-5-1"  
class="td11"> <!--l. 298--><p class="noindent" >&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;&#x003E;     </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-5-2"  
class="td11"> <!--l. 298--><p class="noindent" ><span 
class="ecbx-1200">On "input"</span>: <br 
class="newline" />-  Save  each  incoming  input  data  within
  the object that manages currently running
  games <br 
class="newline" />-  After  all  players  have  submitted  input:
  <span 
class="ecbx-1200">emitAll "calculate" </span>Data: input data of
  all players.                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-6-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-6-1"  
class="td11"> <!--l. 301--><p class="noindent" ><span 
class="ecbx-1200">On "calculate"</span>: <br 
class="newline" />- Create round object and write incoming
  input data to it <br 
class="newline" />- Calculate round results (output variables)
  from inputs and write to round object <br 
class="newline" />- Draw charts <br 
class="newline" />-   If   last   round:   show   game   results,
  <span 
class="ecbx-1200">emit  "finish" </span>Data:  whole  Game  object
  (contains complete game history) <br 
class="newline" />-  Not  last  round:  increment  round  index,
  <span 
class="ecbx-1200">emit  "result"  </span>Data:  calculated  round
  object                                                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-6-2"  
class="td11"> <!--l. 307--><p class="noindent" >                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-7-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-7-1"  
class="td11"> <!--l. 307--><p class="noindent" >&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;&#x003E;     </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-7-2"  
class="td11"> <!--l. 307--><p class="noindent" ><span 
class="ecbx-1200">On "result"</span>: <br 
class="newline" />- NiceToHave: Fraud detection <br 
class="newline" />- <span 
class="ecbx-1200">Emit "set input"</span>                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-8-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-8-1"  
class="td11"> <!--l. 310--><p class="noindent" >                                      </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-8-2"  
class="td11"> <!--l. 310--><p class="noindent" ><span 
class="ecbx-1200">On "finish"</span>: <br 
class="newline" />- Save Game object to database                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-9-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-9-1"  
class="td11"> <!--l. 312--><p class="noindent" ><span 
class="ecbx-1200">On "set input"</span>: <br 
class="newline" />- Wait for input or show questionnaire <br 
class="newline" />- <span 
class="ecbx-1200">Emit "input" </span>Data: inputs of all players
  or save questionnaire results to the Game
  object after user submits.                          </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-9-2"  
class="td11"> <!--l. 314--><p class="noindent" >&#x003C;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-10-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-10-1"  
class="td11">                                       </td></tr></table></div>
                                                                                         
                                                                                         
<br /> <div class="caption" 
><span class="id">Table&#x00A0;5.1: </span><span  
class="content">Socket events on client and server </span></div><!--tex4ht:label?: x1-70002r1 -->
                                                                                         
                                                                                         
</div><hr class="endfloat" />
</div>
<!--l. 321--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-70003r6"></a>
                                                                                         
                                                                                         
<!--l. 323--><p class="noindent" ><img 
src="figures/play.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5.6: </span><span  
class="content">Screenshot of two players playing the <span 
class="ecti-1200">SaltSeller </span>business game after two rounds
have been played</span></div><!--tex4ht:label?: x1-70003r6 -->
                                                                                         
                                                                                         
<!--l. 326--><p class="noindent" ></div><hr class="endfigure">
<!--l. 328--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-70004r7"></a>
                                                                                         
                                                                                         
<!--l. 330--><p class="noindent" ><img 
src="figures/questionnaire.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5.7: </span><span  
class="content">Example of a questionnaire which is displayed after the game has finished</span></div><!--tex4ht:label?: x1-70004r7 -->
                                                                                         
                                                                                         
<!--l. 333--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">5.2.4   </span> <a 
 id="x1-710005.2.4"></a>Game analysis</h4>
<!--l. 338--><p class="noindent" >The entire game data of all game sessions of a specific business game which has been
played on this instance of BGE can be downloaded as JSON file using the <span 
class="ecti-1200">Download</span>
<span 
class="ecti-1200">game data </span>button on the startpage. JSON is a well readable data exchange format
(compared to XML for example) and libraries and utilities exist for all programming
languages.
<!--l. 340--><p class="noindent" >Future implementations might provide an advanced analysis environment (see the next section)
which can reduce the need for data analysts to learn the MongoDB query syntax or to write
wrappers around the JSON files.
                                                                                         
                                                                                         
<h3 class="sectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-720005.3"></a>Dependencies</h3>
<!--l. 343--><p class="noindent" >Table <a 
href="#x1-72001r2">5.2<!--tex4ht:ref: table:dep --></a> provides a brief overview of the third party libraries used in BGE. <div class="table">
                                                                                         
                                                                                         
<!--l. 345--><p class="noindent" ><a 
 id="x1-72001r2"></a><hr class="float"><div class="float" 
>
                                                                                         
                                                                                         
<div class="tabular"> <table id="TBL-7" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-7-1g"><col 
id="TBL-7-1"></colgroup><colgroup id="TBL-7-2g"><col 
id="TBL-7-2"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-1-1"  
class="td11"> <!--l. 348--><p class="noindent" ><span 
class="ecbx-1200">Library</span>                       </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-1-2"  
class="td11"> <!--l. 348--><p class="noindent" ><span 
class="ecbx-1200">Description</span>                                               </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-2-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-2-1"  
class="td11"> <!--l. 350--><p class="noindent" >Node.js <br 
class="newline" />https://nodejs.org               </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-2-2"  
class="td11"> <!--l. 350--><p class="noindent" >Event-driven,  non-blocking  JavaScript  Runtime  for
  the server                                                           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-3-1"  
class="td11"> <!--l. 352--><p class="noindent" >MongoDb <br 
class="newline" />https://www.mongodb.org    </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-3-2"  
class="td11"> <!--l. 352--><p class="noindent" >NoSQL database                                                  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-4-1"  
class="td11"> <!--l. 354--><p class="noindent" >mongodb <br 
class="newline" />https://www.npmjs.com/<br 
class="newline" />package/mongodb               </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-4-2"  
class="td11"> <!--l. 355--><p class="noindent" >MongoDb driver for Node.js                                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-5-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-5-1"  
class="td11"> <!--l. 357--><p class="noindent" >express.js <br 
class="newline" />http://expressjs.com            </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-5-2"  
class="td11"> <!--l. 359--><p class="noindent" >Web server framework for Node.js                           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-6-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-6-1"  
class="td11"> <!--l. 361--><p class="noindent" >socket.io <br 
class="newline" />http://socket.io                  </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-6-2"  
class="td11"> <!--l. 363--><p class="noindent" >WebSocket implementation for Node.js                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-7-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-7-1"  
class="td11"> <!--l. 365--><p class="noindent" >esprima <br 
class="newline" />http://esprima.org/             </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-7-2"  
class="td11"> <!--l. 367--><p class="noindent" >Open-source JavaScript parser                                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-8-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-8-1"  
class="td11"> <!--l. 369--><p class="noindent" >escodegen <br 
class="newline" />https://github.com/<br 
class="newline" />estools/escodegen                </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-8-2"  
class="td11"> <!--l. 371--><p class="noindent" >JavaScript code generator (for reformatting)             </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-9-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-9-1"  
class="td11"> <!--l. 373--><p class="noindent" >csurf,              bodyparser,
  cookieparser                       </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-9-2"  
class="td11"> <!--l. 373--><p class="noindent" >Middleware used by express.js for CSRF protection
  and body/url parsing                                            </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-10-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-10-1"  
class="td11"> <!--l. 375--><p class="noindent" >jade                                 </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-10-2"  
class="td11"> <!--l. 375--><p class="noindent" >Template rendering engine for Node.js (used to insert
  CSRF tokens)                                                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-11-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-11-1"  
class="td11"> <!--l. 377--><p class="noindent" >Google  charts  https://dev
  elopers.google.com/chart/     </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-11-2"  
class="td11"> <!--l. 377--><p class="noindent" >JavaScript Chart API                                           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-12-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-12-1"  
class="td11"> <!--l. 379--><p class="noindent" >Eclipse orion                      </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-12-2"  
class="td11"> <!--l. 379--><p class="noindent" >Editor for the web-browser                                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-13-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-13-1"  
class="td11"> <!--l. 381--><p class="noindent" >JQuery                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-13-2"  
class="td11"> <!--l. 381--><p class="noindent" >JavaScript frontend utilities                                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-14-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-14-1"  
class="td11"> <!--l. 383--><p class="noindent" >Foundation <br 
class="newline" />http://foundation.zurb.com   </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-14-2"  
class="td11"> <!--l. 383--><p class="noindent" >CSS framework                                                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-15-"><td  style="white-space:wrap; text-align:left;" id="TBL-7-15-1"  
class="td11">                          </td></tr></table></div>
<br /> <div class="caption" 
><span class="id">Table&#x00A0;5.2: </span><span  
class="content">BGE dependencies </span></div><!--tex4ht:label?: x1-72001r2 -->
                                                                                         
                                                                                         
</div><hr class="endfloat" />
</div>
<h3 class="sectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-730005.4"></a>Installation guide</h3>
<!--l. 394--><p class="noindent" >This section provides a brief installation guideline for a Debian based system (e.g. Ubuntu).
<!--l. 396--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.4.1   </span> <a 
 id="x1-740005.4.1"></a>Prerequisites</h4>
<!--l. 397--><p class="noindent" >Install Node.js
      <ul class="itemize1">
      <li class="itemize"><span 
class="ecti-1200">sudo apt-get install npm </span>&#8211;&#x003E; Installs the node package manager (NPM)
      </li>
      <li class="itemize"><span 
class="ecti-1200">sudo npm install -g npm </span>&#8211;&#x003E; Updates NPM to the latest version
      </li>
      <li class="itemize"><span 
class="ecti-1200">sudo ln -s /usr/bin/nodejs /usr/local/bin/node </span>&#8211;&#x003E; Syslink to the node environment,
      maybe only needed on Ubuntu
      </li>
      <li class="itemize"><span 
class="ecti-1200">sudo npm install -g n </span>&#8211;&#x003E; install node binary manager <br 
class="newline" />(https://www.npmjs.com/package/n)
      </li>
      <li class="itemize"><span 
class="ecti-1200">n stable </span>&#8211;&#x003E; install the newest stable version of node</li></ul>
<!--l. 405--><p class="noindent" >Install MongoDB
      <ul class="itemize1">
      <li class="itemize"><span 
class="ecti-1200">sudo apt-get install mongodb</span></li></ul>
<!--l. 410--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.4.2   </span> <a 
 id="x1-750005.4.2"></a>BGE installation</h4>
      <ul class="itemize1">
      <li class="itemize">Checkout or copy BGE code to some local folder
                                                                                         
                                                                                         
      </li>
      <li class="itemize">Go inside that folder
      </li>
      <li class="itemize"><span 
class="ecti-1200">npm install </span>&#8211;&#x003E; Reads package.json in order to locally (inside BGE folder) install all
      the dependencies needed for BGE (see last section)</li></ul>
<!--l. 418--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.4.3   </span> <a 
 id="x1-760005.4.3"></a>Run it locally</h4>
      <ul class="itemize1">
      <li class="itemize"><span 
class="ecti-1200">node server.js </span>&#8211;&#x003E; Starts the BGE server, will listen on port 3000
      </li>
      <li class="itemize">Start a browser, navigate to <span 
class="ecti-1200">localhost:3000</span></li></ul>
<!--l. 423--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.4.4   </span> <a 
 id="x1-770005.4.4"></a>Deployment</h4>
<!--l. 424--><p class="noindent" >Deployment of Node.js applications is quite straightforward. Set up / rent a linux server and follow
the installation guidelines. Then:
      <ul class="itemize1">
      <li class="itemize">use supervisor<span class="footnote-mark"><a 
href="thesis37.html#fn33x5"><sup class="textsuperscript">33</sup></a></span><a 
 id="x1-77001f33"></a> 
      or forever<span class="footnote-mark"><a 
href="thesis38.html#fn34x5"><sup class="textsuperscript">34</sup></a></span><a 
 id="x1-77002f34"></a> 
      or pm2 to watch the server process and keep it alive
      </li>
      <li class="itemize">redirect all incoming traffic to e.g. port 3000 so that node need not run with privileges<span class="footnote-mark"><a 
href="thesis39.html#fn35x5"><sup class="textsuperscript">35</sup></a></span><a 
 id="x1-77003f35"></a> 
      <span class="footnote-mark"><a 
href="thesis40.html#fn36x5"><sup class="textsuperscript">36</sup></a></span><a 
 id="x1-77004f36"></a>
      </li>
      <li class="itemize">more professional setups might consider Jenkins: <span 
class="ecti-1200">https://jenkins-ci.org/</span></li></ul>
                                                                                         
                                                                                         
<!--l. 1--><p class="noindent" >
                                                                                         
                                                                                         
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;6</span><br /><a 
 id="x1-780006"></a>Conclusion and outlook</h2>
<!--l. 4--><p class="noindent" >This chapter summarises the achievements of this thesis and lists features which might be
implemented in the future.
<h3 class="sectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-790006.1"></a>Conclusion</h3>
<!--l. 9--><p class="noindent" >This thesis provides a software architecture and a description of its implementation that allows to
develop, simulate, play and analyse any round-based business game in a browser. This system is
called Business Game Engine (BGE) while its description mechanism for round-based business
games is called Business Game Description (BGD).
<!--l. 11--><p class="noindent" >A first literature review showed how similar efforts have been carried out in Japan with the work
on BMDL, BMDS and YBG between 1997 and 2007.
<!--l. 13--><p class="noindent" >Then, a framework for general n-person round-based games as a 7-tuple of turn-based inputs, fixed
parameters, outputs, initial game state, state transition functions, score function and a stop
condition is introduced. This framework provides a clear definition of round-based games allowing
to mathematically describe each member of that class.
<!--l. 15--><p class="noindent" >In chapter <a 
href="#x1-230004">4<!--tex4ht:ref: cha:architecture --></a> the design of the proposed architecture is described in detail as one major
contribution of this thesis. In contrast to the work in Japan an object model is proposed, with
which a round-based game can be described using any general purpose object-oriented
programming language instead of defining a new programming language. This drastically simplifies
the implementation of such a system since we used an open-source Javascript parser and also
allows to make use of existing libraries. It maintains at the same time a very high flexibility
since game developers can use any feature of the programming language that is being
used.
<!--l. 17--><p class="noindent" >The second major contribution is the implementation of the proposed architecture. A prototype is
running on <span 
class="ecti-1200">http://games.fkmt.de</span>. It uses the most recent (web)technologies such as server-side
Javascript, NoSQL and WebSockets. The consistent use of Javascript allows to smoothly shift tasks
between server and client and to natively use JSON objects all around the architecture. Most of
the load has been shifted to the clients which allows a secure execution of untrusted game code
within the Browser&#8217;s sandbox as well as a deployment with very limited physical resources. The
general use of JSON objects in combination with WebSockets leads to a very efficient
communication and synchronization between server and client, enormously facilitating the
implementation of such a complex system. Finally, the use of a modern NoSQL database allowing
to save JSON objects directly avoids the need for an expensive object-relational mapping
(ORM).
<!--l. 19--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">6.2   </span> <a 
 id="x1-800006.2"></a>Future work</h3>
<!--l. 22--><p class="noindent" >Future work might be done on the definition and implementation of BGD (roles, table-based
output) as well as on the entrance hall module and the analysis environment.
                                                                                         
                                                                                         
<!--l. 24--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.2.1   </span> <a 
 id="x1-810006.2.1"></a>Roles</h4>
<!--l. 27--><p class="noindent" >BGD could be extended with a role functionality. A business game could then have several roles
and one of these roles would be assigned to each player. The inputs, outputs, parameters,
state-transition-functions and score function could then be made dependent on the player&#8217;s role.
The beergame for example knows the roles retailer, wholesaler, distributor and factory, eventhough
it can also be implemented without roles (see appendix).
<!--l. 29--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.2.2   </span> <a 
 id="x1-820006.2.2"></a>Advanced entrance hall</h4>
<!--l. 32--><p class="noindent" >The entrance hall module could be extended functionally so that the entrance hall becomes a
separate html page. This page consists of <span 
class="cmmi-12">n </span>player slots and a start button, where <span 
class="cmmi-12">n </span>is the maximal
number of players that can participate in the game. Each player who joins the game gets assigned
to one player slot. The game creator, who is the first person joining the game, can additionally
assign empty slots to virtual opponents. He can start the game after the number of
assigned slots lies between the minimal and maximal number of players of the business
game.
<!--l. 34--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.2.3   </span> <a 
 id="x1-830006.2.3"></a>Advanced analysis environment</h4>
<!--l. 37--><p class="noindent" >This prototype implementation provides a download functionality for all prior played game sessions
of a specific BG as JSON file. Data analysts who want to filter this data for specific criteria
either have to query MongoDB directly (if they have been granted access to it) or need
to parse the JSON data and implement their own analysis environment around that.
This can be done relatively easy since JSON utilities exist for all recent programming
languages.
<!--l. 39--><p class="noindent" >Nevertheless future implementations might implement an advanced analysis environment directly.
This environment might query the database for global or local game criteria. Global criteria
might be <span 
class="ecti-1200">all games</span>, <span 
class="ecti-1200">all games without player abort</span>, <span 
class="ecti-1200">all games with questionnaire data</span>
and so on. Local criteria might be realised in form of query rules as shown in figure
<a 
href="#x1-83001r1">6.1<!--tex4ht:ref: fig:analysis --></a>.
<!--l. 41--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-83001r1"></a>
                                                                                         
                                                                                         
<!--l. 43--><p class="noindent" ><img 
src="figures/analysis.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;6.1: </span><span  
class="content">Example UI for a local query criteria rule generator</span></div><!--tex4ht:label?: x1-83001r1 -->
                                                                                         
                                                                                         
<!--l. 46--><p class="noindent" ></div><hr class="endfigure">
<!--l. 48--><p class="noindent" >The result of this query, using global and/or local game criteria, might again be a JSON file. An
advanced analysis environment might also implement a relational mapping of JSON game data so
that the query result can be displayed in tables in an online view or provided as table based
csv-export for example for spreadsheet programs. If implemented in a generic way, such a mapping
might be the basis of an ORM so that BGE can be used together with relational databases as
well.
<h4 class="subsectionHead"><span class="titlemark">6.2.4   </span> <a 
 id="x1-840006.2.4"></a>Tabular output</h4>
<!--l. 53--><p class="noindent" >In the current implementation, variable outcomes are visualised with charts, giving all players
complete information about that variable. A chart furthermore only visualises one variable at a
time. Rendering output as tables might be used to address both issues, enabling incomplete
information as well as displaying related things in one place.
<!--l. 55--><p class="noindent" >Listing <a 
href="#x1-84001r1">6.1<!--tex4ht:ref: lst:table --></a> shows how table-based output could be realised in the BGD game code using the
example of the order input variable in the beergame which should have incomplete
information.
<!--l. 57-->
                                                                                         
                                                                                         
<!--l. 57--><p class="noindent" ><a 
 id="x1-84001r1"></a><a 
 id="x1-86001r1"></a><a 
 id="x1-87001r2"></a><hr class="float"><div class="float" 
>
                                                                                         
                                                                                         
<a 
 id="x1-84002"></a>
          <div class="caption" 
><span class="id">Listing&#x00A0;6.1:         </span><span  
class="content">BGD         table         extension:         orders         in         the
 beergame</span></div><!--tex4ht:label?: x1-84001r6.2 --><div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-84003r1"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Custom</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">showing</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">each</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">beergame</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">only</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84004r2"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">he</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">is</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">allowed</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">see</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">incomplete</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">information</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84005r3"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderTable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84006r4"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84007r5"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84008r6"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">header</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">Order</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">round</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">+1);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84009r7"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">columns</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[];</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84010r8"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">First</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">row</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Will</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">be</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">printed</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bold</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">by</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">default</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84011r9"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">columns</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">push</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Round</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">number</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">from</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">client</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84012r10"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Go</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">through</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">all</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">rounds</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">and</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">add</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">from</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">client</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84013r11"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84014r12"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderDelay</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">orderReceivingDelay</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84015r13"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">for</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">roundIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">roundIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">roundIndex</span><span 
class="ectt-1000">++)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84016r14"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderRoundNumber</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">roundIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderDelay</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84017r15"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">===</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">retailer</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84018r16"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">customerDemand</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderRoundNumber</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84019r17"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">wholesaler</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">distributor</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">factory</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84020r18"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">order</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderRoundNumber</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">-1);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84021r19"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84022r20"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">columns</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">push</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">roundIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84023r21"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84024r22"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Each</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">custom</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">defined</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">table</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">must</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">such</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">an</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">object</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84025r23"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84026r24"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Register</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">tables</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">architecture</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84027r25"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">registerTables</span><span 
class="ectt-1000">([</span><span 
class="ectt-1000">orderTable</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">otherCustomTable</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">preDefinedTable</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">...]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84028r26"></a></span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84029r27"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84030r28"></a></span><span 
class="ectt-1000">There</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">might</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">be</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">other</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">pre</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">defined</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">tables</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">such</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">as</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84031r29"></a></span><span 
class="ectt-1000">roundResultTable</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">all</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">players</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">variable</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">results</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">last</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">round</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84032r30"></a></span><span 
class="ectt-1000">or</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerResultTable</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">all</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">variable</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">results</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">this</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">for</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">all</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">rounds</span><span 
class="ectt-1000">).</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84033r31"></a></span><span 
class="ectt-1000">These</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">tables</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">could</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">also</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">be</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">registered</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">with</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">registerTables</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">method</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-84034r32"></a></span><span 
class="ectt-1000">*/</span>
 
                                                                                         
                                                                                         
</div><hr class="endfloat" />
</div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!--l. 174--><p class="noindent" >
                                                                                         
                                                                                         
<a 
 id="x1-84035r95"></a>
<h2 class="appendixHead"><span class="titlemark">Appendix&#x00A0;A</span><br /><a 
 id="x1-85000A"></a>Appendix</h2>
                                                                                         
                                                                                         
<h3 class="sectionHead"><span class="titlemark">A.1   </span> <a 
 id="x1-86000A.1"></a>Stone-paper-scissors</h3>
<!--l. 2-->
<a 
 id="x1-86002"></a>
 <br /> <div class="caption" 
><span class="id">Listing&#x00A0;A.1: </span><span  
class="content">Game code of stone-paper-scissors</span></div><!--tex4ht:label?: x1-86001rA.1 --><div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-86003r1"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">Schnick</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Schnack</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Schnuck</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86004r2"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">maxRounds</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">10,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86005r3"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=1</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86006r4"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86007r5"></a></span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86008r6"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">minPlayers</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">2,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">===2</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86009r7"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">maxPlayers</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">2,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">===2</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86010r8"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">roundTimeOut</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">20,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86011r9"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=15</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86012r10"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86013r11"></a></span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86014r12"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Choice</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">Set</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Left</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">term</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">must</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">beat</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">right</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">term</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">order</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">make</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86015r13"></a></span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">winner</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">work</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86016r14"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceSet</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86017r15"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Stone</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86018r16"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Scissors</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86019r17"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Paper</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86020r18"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">];</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86021r19"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceSet</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">["</span><span 
class="ectt-1000">cockroach</span><span 
class="ectt-1000">",</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">nuclear</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bomb</span><span 
class="ectt-1000">",</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">foot</span><span 
class="ectt-1000">"];</span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86022r20"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86023r21"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Input</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Stone</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Scissors</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">or</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Paper</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86024r22"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86025r23"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choice</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86026r24"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">choice</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86027r25"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">scrollDown</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86028r26"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">values</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceSet</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86029r27"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">default</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceSet</span><span 
class="ectt-1000">[0]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86030r28"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">},</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86031r29"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bot</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86032r30"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86033r31"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addInputVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">choice</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86034r32"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bot</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86035r33"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Error</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86036r34"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">randomInt</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">randomInt</span><span 
class="ectt-1000">(0,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">2);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86037r35"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceSet</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">randomInt</span><span 
class="ectt-1000">];</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86038r36"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86039r37"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86040r38"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86041r39"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Integer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">variable</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-1</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">looses</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">round</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">he</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">wins</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">for</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">tie</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86042r40"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86043r41"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">winner</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86044r42"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">roundWinner</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86045r43"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">type</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86046r44"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86047r45"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86048r46"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86049r47"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86050r48"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcWinner</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86051r49"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86052r50"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=-1</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86053r51"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003C;=1</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86054r52"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86055r53"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86056r54"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86057r55"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addPlayerVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">winner</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86058r56"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcWinner</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86059r57"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86060r58"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86061r59"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player1Choice</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceToInt</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">choice</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0));</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86062r60"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player2Choice</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceToInt</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">choice</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1));</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86063r61"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">diff</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86064r62"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">===</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86065r63"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">diff</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player1Choice</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player2Choice</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86066r64"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86067r65"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">diff</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player2Choice</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">player1Choice</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86068r66"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86069r67"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">diff</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">===</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-1</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">||</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">diff</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">===</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">2)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86070r68"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86071r69"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">diff</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">===</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86072r70"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86073r71"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86074r72"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-1;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86075r73"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86076r74"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86077r75"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86078r76"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceToInt</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">choice</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86079r77"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86080r78"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">for</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceSet</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">length</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">++)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86081r79"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">choice</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">===</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">choiceSet</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">])</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86082r80"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86083r81"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">break</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86084r82"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86085r83"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86086r84"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86087r85"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86088r86"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86089r87"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Score</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Function</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86090r88"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86091r89"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">scoreFunction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86092r90"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86093r91"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86094r92"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">roundWinner</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86095r93"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcWinner</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86096r94"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86097r95"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86098r96"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">winner</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86099r97"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">caption</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Game</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">score</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86100r98"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">type</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">lineChart</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86101r99"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">unit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">points</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86102r100"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xInit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">utils</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getWeekNumber</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">new</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Date</span><span 
class="ectt-1000">()),</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86103r101"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xIncrement</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86104r102"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-86105r103"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addScore</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">scoreFunction</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">winner</span><span 
class="ectt-1000">);</span>
 
</div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<h3 class="sectionHead"><span class="titlemark">A.2   </span> <a 
 id="x1-87000A.2"></a>Beergame</h3>
<!--l. 2-->
<a 
 id="x1-87001r2"></a>
<a 
 id="x1-87002"></a>
 <br /> <div class="caption" 
><span class="id">Listing&#x00A0;A.2: </span><span  
class="content">Game code of the beergame</span></div><!--tex4ht:label?: x1-87001rA.2 --><div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-87003r1"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87004r2"></a></span><span 
class="ectt-1000">Beer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">distribution</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">for</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">players</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">with</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">different</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">roles</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">Retailer</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87005r3"></a></span><span 
class="ectt-1000">Wholesaler</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Distributor</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Factory</span><span 
class="ectt-1000">).</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87006r4"></a></span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Role</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">behaviour</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">is</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">not</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">yet</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">implemented</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">maybe</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">version</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">2.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87007r5"></a></span><span 
class="ectt-1000">Therefore</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Retailer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">R</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">2</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Wholesaler</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">W</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87008r6"></a></span><span 
class="ectt-1000">Player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">3</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Distributor</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">D</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Factory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">F</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87009r7"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87010r8"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">maxRounds</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">30,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87011r9"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=1</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87012r10"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87013r11"></a></span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87014r12"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">show</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">more</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">players</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">avoid</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">horizon</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">effects</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87015r13"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">minPlayers</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">===4</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87016r14"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">maxPlayers</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">===4</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87017r15"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">roundTimeOut</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">90,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87018r16"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=15</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87019r17"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87020r18"></a></span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87021r19"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">orderReceivingDelay</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87022r20"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87023r21"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87024r22"></a></span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87025r23"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">round</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(=1</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87026r24"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">shipping</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">productionDelay</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87027r25"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=1</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87028r26"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87029r27"></a></span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87030r28"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">weeks</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87031r29"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventoryHoldingCosts</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0.5,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87032r30"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0.5</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">case</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87033r31"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">backlogCosts</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87034r32"></a></span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">$</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">case</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87035r33"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87036r34"></a></span><span 
class="ectt-1000">Order</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">cases</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">input</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">variable</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87037r35"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87038r36"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">order</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87039r37"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87040r38"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87041r39"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">textField</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87042r40"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">type</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">number</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87043r41"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">default</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">6,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87044r42"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87045r43"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87046r44"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87047r45"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87048r46"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">},</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87049r47"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderBot</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87050r48"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87051r49"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderChart</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87052r50"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">caption</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Beer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87053r51"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">type</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">lineChart</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87054r52"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">unit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">cases</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">beer</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87055r53"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xInit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">utils</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getWeekNumber</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">new</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Date</span><span 
class="ectt-1000">()),</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87056r54"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xIncrement</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87057r55"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87058r56"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addInputVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">order</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderChart</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87059r57"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderBot</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87060r58"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87061r59"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">as</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">described</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Sterman</span><span 
class="ectt-1000">&#8217;</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Paper</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">first</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">four</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">rounds</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87062r60"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">everybody</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cases</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87063r61"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87064r62"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87065r63"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87066r64"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">after</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">rounds</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">players</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">can</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">order</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">as</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">they</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">want</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87067r65"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87068r66"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">randomInt</span><span 
class="ectt-1000">(6,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">20);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87069r67"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87070r68"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87071r69"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87072r70"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87073r71"></a></span><span 
class="ectt-1000">Collective</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">and</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">individual</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">score</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">functions</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87074r72"></a></span><span 
class="ectt-1000">Aim</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">players</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Minimize</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">total</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">collective</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cost</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87075r73"></a></span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">whole</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">beer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">distributing</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">organisation</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">while</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">only</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">having</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87076r74"></a></span><span 
class="ectt-1000">local</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">information</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">about</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">individual</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">for</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87077r75"></a></span><span 
class="ectt-1000">backlog</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">and</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">each</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">round</span><span 
class="ectt-1000">).</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87078r76"></a></span><span 
class="ectt-1000">--&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">score</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">are</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">negative</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87079r77"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87080r78"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">scoreFunction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87081r79"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MAX_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87082r80"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87083r81"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">totalCost</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87084r82"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87085r83"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87086r84"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalCostss</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87087r85"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">caption</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Total</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cost</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87088r86"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">type</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">columnChart</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87089r87"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">unit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Euros</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87090r88"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xInit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">utils</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getWeekNumber</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">new</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Date</span><span 
class="ectt-1000">()),</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87091r89"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xIncrement</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87092r90"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87093r91"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addScore</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">scoreFunction</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalCostss</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87094r92"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">collectiveScoreFunction</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87095r93"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87096r94"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87097r95"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">for</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getNumberOfPlayers</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">++)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87098r96"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">roundScore</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">));</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87099r97"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87100r98"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87101r99"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87102r100"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addCollectiveScore</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">collectiveScoreFunction</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87103r101"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87104r102"></a></span><span 
class="ectt-1000">Customer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">demand</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">cases</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">variable</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87105r103"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87106r104"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">customerDemand</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87107r105"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">customerDemand</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87108r106"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87109r107"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">getCustDemand</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87110r108"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87111r109"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87112r110"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87113r111"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87114r112"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87115r113"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addRoundVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">customerDemand</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87116r114"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">getCustDemand</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87117r115"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87118r116"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87119r117"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">The</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">first</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">four</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">weeks</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">play</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">are</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">used</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">familiarize</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87120r118"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">subjects</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">with</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">mechanics</span><span 
class="ectt-1000">...</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87121r119"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&amp;&amp;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">3)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87122r120"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87123r121"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">There</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">is</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">an</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">unannounced</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">one</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">time</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">increase</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">customer</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87124r122"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">demand</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">eight</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cases</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">5"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87125r123"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">3)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87126r124"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">8;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87127r125"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87128r126"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87129r127"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87130r128"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87131r129"></a></span><span 
class="ectt-1000">Incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">beer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cases</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">from</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">next</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bigger</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">supply</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">chain</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87132r130"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87133r131"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incomingInventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87134r132"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">incomingInventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87135r133"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87136r134"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcIncoming</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87137r135"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87138r136"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87139r137"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87140r138"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87141r139"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87142r140"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addPlayerVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">incomingInventory</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87143r141"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcIncoming</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87144r142"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">always</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">starts</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">at</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">for</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1)</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87145r143"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87146r144"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87147r145"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incomingRoundNumber</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">shipping</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">productionDelay</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87148r146"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">R</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">W</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">D</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">is</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">defined</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">by</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">outgoing</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87149r147"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">next</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bigger</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">supply</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">chain</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">after</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">shipping</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">delay</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87150r148"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">3)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87151r149"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">outgoingInventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incomingRoundNumber</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87152r150"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87153r151"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Factory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">Player</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4):</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">is</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">what</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Factory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ordered</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">produce</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87154r152"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">===</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">3)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87155r153"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incomingRoundNumber</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">3);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87156r154"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87157r155"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87158r156"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87159r157"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87160r158"></a></span><span 
class="ectt-1000">Total</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">are</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">from</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">next</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">smaller</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87161r159"></a></span><span 
class="ectt-1000">supply</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">chain</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">plus</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">an</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">eventual</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlog</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">from</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">last</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87162r160"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87163r161"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87164r162"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87165r163"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcTotalOrders</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87166r164"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87167r165"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87168r166"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87169r167"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87170r168"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87171r169"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addPlayerVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87172r170"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcTotalOrders</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87173r171"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87174r172"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87175r173"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderRoundNumber</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">orderReceivingDelay</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87176r174"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ordersFromDownstream</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87177r175"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">R</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">receives</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">from</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">customers</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87178r176"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">===</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87179r177"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ordersFromDownstream</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">customerDemand</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderRoundNumber</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87180r178"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">W</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">D</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">F</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">receive</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">from</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">next</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">smaller</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">supply</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87181r179"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">chain</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87182r180"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87183r181"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ordersFromDownstream</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orderRoundNumber</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87184r182"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87185r183"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87186r184"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Total</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">are</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">an</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">eventual</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlog</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87187r185"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">from</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">last</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87188r186"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlogLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87189r187"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87190r188"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87191r189"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlogLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-1</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87192r190"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87193r191"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlogLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87194r192"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87195r193"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlogLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ordersFromDownstream</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87196r194"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87197r195"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87198r196"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87199r197"></a></span><span 
class="ectt-1000">Outgoing</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">beer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cases</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">which</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">are</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">shipped</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">to</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">next</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">smaller</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87200r198"></a></span><span 
class="ectt-1000">supply</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">chain</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87201r199"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87202r200"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">outgoingInventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87203r201"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">outgoingInventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87204r202"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">4,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87205r203"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcOutgoing</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87206r204"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87207r205"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003E;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87208r206"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87209r207"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87210r208"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87211r209"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addPlayerVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">outgoingInventory</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87212r210"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcOutgoing</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87213r211"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MIN_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87214r212"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87215r213"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">incomingInventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87216r214"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87217r215"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87218r216"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculate</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">number</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">outgoing</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">beer</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cases</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87219r217"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87220r218"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87221r219"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87222r220"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87223r221"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87224r222"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87225r223"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87226r224"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87227r225"></a></span><span 
class="ectt-1000">A</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">negative</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">means</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlog</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87228r226"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87229r227"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87230r228"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87231r229"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">12,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87232r230"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcInventory</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87233r231"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">%1===0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87234r232"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87235r233"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventChart</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87236r234"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">caption</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Inventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87237r235"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">type</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">columnChart</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87238r236"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">unit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Cases</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">beer</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87239r237"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xInit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">utils</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getWeekNumber</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">new</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Date</span><span 
class="ectt-1000">()),</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87240r238"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xIncrement</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87241r239"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87242r240"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addPlayerVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventChart</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87243r241"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcInventory</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87244r242"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-0.5;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87245r243"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87246r244"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87247r245"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">incomingInventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87248r246"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87249r247"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87250r248"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlog</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">of</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">last</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">week</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87251r249"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">is</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">already</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">in</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">total</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">orders</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87252r250"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">else</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87253r251"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventoryLastWeek</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">incoming</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalOrders</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87254r252"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87255r253"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87256r254"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87257r255"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87258r256"></a></span><span 
class="ectt-1000">Backlog</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87259r257"></a></span><span 
class="ectt-1000">Costs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">are</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">negative</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">--&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bigger</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">number</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">the</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">better</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87260r258"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87261r259"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlogCost</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87262r260"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">backlogCost</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87263r261"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87264r262"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcBacklogCost</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87265r263"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003C;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87266r264"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87267r265"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlogChart</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87268r266"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">caption</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Backlog</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87269r267"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">type</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">columnChart</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87270r268"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">unit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Euros</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87271r269"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xInit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">utils</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getWeekNumber</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">new</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Date</span><span 
class="ectt-1000">()),</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87272r270"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xIncrement</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87273r271"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87274r272"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addPlayerVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">backlogCost</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlogChart</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87275r273"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcBacklogCost</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87276r274"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87277r275"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87278r276"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87279r277"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87280r278"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">backlogCosts</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87281r279"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87282r280"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87283r281"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87284r282"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87285r283"></a></span><span 
class="ectt-1000">Inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">holding</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87286r284"></a></span><span 
class="ectt-1000">Costs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">are</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">negative</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87287r285"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87288r286"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">invHolding</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87289r287"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventoryHoldingCost</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87290r288"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87291r289"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcInvHolding</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87292r290"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003C;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87293r291"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87294r292"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">invHoldingChart</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87295r293"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">caption</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">holding</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87296r294"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">type</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">columnChart</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87297r295"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">unit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">Euros</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87298r296"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xInit</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">utils</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getWeekNumber</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">new</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Date</span><span 
class="ectt-1000">()),</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87299r297"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">xIncrement</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">1</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87300r298"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87301r299"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addPlayerVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">invHolding</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">invHoldingChart</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87302r300"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcInvHolding</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87303r301"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87304r302"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87305r303"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87306r304"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">if</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x003E;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87307r305"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getParameter</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventoryHoldingCosts</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">-1</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87308r306"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87309r307"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87310r308"></a></span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87311r309"></a></span><span 
class="ectt-1000">/*</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87312r310"></a></span><span 
class="ectt-1000">Total</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">backlog</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">inventory</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">holding</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">costs</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87313r311"></a></span><span 
class="ectt-1000">Costs</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">are</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">a</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">negative</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87314r312"></a></span><span 
class="ectt-1000">*/</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87315r313"></a></span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">totalCost</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87316r314"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">name</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">totalCost</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87317r315"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">initialValue</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">0,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87318r316"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calculationFunction</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcTotalCost</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87319r317"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">validation</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">[</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">&#x003C;=0</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87320r318"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">};</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87321r319"></a></span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">addPlayerVariable</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">totalCost</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87322r320"></a></span><span 
class="ectt-1000">function</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">calcTotalCost</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">{</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87323r321"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">MAX_VALUE</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87324r322"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">getCurrentRound</span><span 
class="ectt-1000">();</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87325r323"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bc</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">backlogCost</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87326r324"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">var</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ihc</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">game</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">get</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">inventoryHoldingCost</span><span 
class="ectt-1000">"</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">cr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">playerIndex</span><span 
class="ectt-1000">);</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87327r325"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">bc</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">ihc</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87328r326"></a></span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">return</span><span 
class="ectt-1000">&#x00A0;</span><span 
class="ectt-1000">result</span><span 
class="ectt-1000">;</span><span 
class="ectt-1000">&#x00A0;</span><br /><span class="label"><a 
 id="x1-87329r327"></a></span><span 
class="ectt-1000">}</span>
 
</div>
                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!--l. 178--><p class="noindent" >
                                                                                         
                                                                                         
<a 
 id="Q1-1-109"></a>
                                                                                         
                                                                                         
<!--l. 2--><p class="noindent" >
                                                                                         
                                                                                         
<h2 class="likechapterHead"><a 
 id="x1-88000A.2"></a>Bibliography</h2>
           <div class="thebibliography">
           <p class="bibitem" ><span class="biblabel">
 [ASS03]  <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xtax2"></a>Aarseth,  E.,  Smedstad,  S.,  and  Sunnana,  L.  (2003)  A  multidimensional
           typology of games. <span 
class="ecti-1200">Level Up Conference Proceedings</span>, pp. 48&#8211;53.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Ber14]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xweb"></a>Bernard,  R.R.  (2014)  Characterizing  business  games  used  in  distance
           education. <span 
class="ecti-1200">Developments in Business Simulation and Experiential Learning</span>, 33,
           pp. 124&#8211;130.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [EA07]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xtax3"></a>Elverdam, C. and Aarseth, E. (2007) Game Classification and Game Design
           Construction Through Critical Analysis. <span 
class="ecti-1200">Games and Culture</span>, 2(1), pp. 3&#8211;22.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Eil63]    <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xeilon"></a>Eilon, S. (1963) Management games. <span 
class="ecti-1200">Journal of the Operational Research</span>
           <span 
class="ecti-1200">Society</span>, 14(2), pp. 137&#8211;149.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Far98]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xfaria"></a>Faria,  A.J.  (1998)  Business  simulation  games:  Current  usage  levels  -  An
           update. <span 
class="ecti-1200">Simulation &amp; Gaming</span>, 29(3), pp. 295&#8211;308.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [FM11]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xwebsocket"></a>Fette,  I.  and  Melnikov,  A.  (2011)  The  WebSocket  Protocol.  RFC  6455,
           retrieved on 15 Dec. 2015, URL <a 
href="http://tools.ietf.org/html/rfc6455" class="url" ><span 
class="ectt-1200">http://tools.ietf.org/html/rfc6455</span></a>.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [For61]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XJForrester1961"></a>Forrester,  J.  (1961)  <span 
class="ecti-1200">Industrial  Dynamics</span>.  Pegasus  Communications,  MA,
           United States.
           </p>
                                                                                         
                                                                                         
           <p class="bibitem" ><span class="biblabel">
 [FSS<sup><span 
class="cmr-8">+</span></sup>99] <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbmdl3"></a>Fujimori,  H.,  Shirai,  H.,  Suzuki,  H.,  Kuno,  Y.,  Tsuda,  K.,  and  Terano,
           T.  (1999)  Business  game  development  toolkit  for  the  WWW  environment.
           In <span 
class="ecti-1200">Knowledge-Based Intelligent Information Engineering Systems, 1999. Third</span>
           <span 
class="ecti-1200">International Conference</span>, pp. 469&#8211;472, IEEE.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [GBN13] <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xgreco"></a>Greco, M., Baldissin, N., and Nonino, F. (2013) An exploratory taxonomy of
           business games. <span 
class="ecti-1200">Simulation &amp; Gaming</span>, 44(5), pp. 645&#8211;682.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [HCB<sup><span 
class="cmr-8">+</span></sup>11]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xhack"></a>Huang, L.S., Chen, E.Y., Barth, A., Rescorla, E., and Jackson, C. (2011)
           Talking to yourself for fun and profit. <span 
class="ecti-1200">Proceedings of W2SP</span>, pp. 1&#8211;11.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Hsu89]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xhsu"></a>Hsu, E. (1989) Role-event gaming simulation in management education: A
           conceptual framework and review. <span 
class="ecti-1200">Simulation &amp; Games</span>, 20(4), pp. 409&#8211;438.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Hä13]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xnodevsjava"></a>Härle      (2013)      Java      EE      vs.      Node.js.      Eine      persönliche
           Einschätzung.        Retrieved        on        15        Dec.        2015,        URL
           <a 
href="http://yourinspirationdotnow.blogspot.de/2013/11/java-ee-vs-nodejs-eine-personliche.html" class="url" ><span 
class="ectt-1200">http://yourinspirationdotnow.blogspot.de/2013/11/java-_ee-_vs-_nodejs-_eine-_personliche.html</span></a>.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Jac00]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsa2"></a>Jacobs, F.R. (2000) Playing the beer distribution game over the internet.
           <span 
class="ecti-1200">Production and Operations Management</span>, 9(1), pp. 31&#8211;39.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Jar63]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xjarmain"></a>Jarmain,  W.E.  (1963)  <span 
class="ecti-1200">Problems  in  industrial  dynamics</span>.  M.I.T.  Press,
           Cambridge.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [KT03]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbmdsagent1"></a>Kobayashi, M. and Terano, T. (2003) Learning agents in a business simulator.
           In <span 
class="ecti-1200">Proceedings of the International Symposium on Computational Intelligence in</span>
           <span 
class="ecti-1200">Robotics and Automation, 2003</span>, volume&#x00A0;3, pp. 1323&#8211;1327, IEEE.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [KUS<sup><span 
class="cmr-8">+</span></sup>15]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsaltseller"></a>Kiechle, F., Uhr, C., Schlereth, M., Zhang, Y., Burkard, L.O., Sonnenbichler,
           A.C.,  and  Geyer-Schulz,  A.  (2015)  Salt  Seller  -  Realization  of  a  Business
           Game.  In  <span 
class="ecti-1200">ICE-B  2015  -  Proceedings  of  the  12th  International  Conference</span>
                                                                                         
                                                                                         
           <span 
class="ecti-1200">on e-Business, Colmar, Alsace, France, 20-22 July, 2015.</span>, pp. 127&#8211;135, URL
           <a 
href="http://dx.doi.org/10.5220/0005503501270135" class="url" ><span 
class="ectt-1200">http://dx.doi.org/10.5220/0005503501270135</span></a>.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [LG77]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XJLarreche1977"></a>Larréché, J.C. and Gatignon, H. (1977) <span 
class="ecti-1200">Markstrat &#8211; A Marketing Strategy</span>
           <span 
class="ecti-1200">Game: Teaching Notes</span>. Scientific Press, Palo Alto.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [MG00]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xtax1"></a>Maier, F.H. and Größler, A. (2000) What are we talking about? - A taxonomy
           of computer simulations to support learning. <span 
class="ecti-1200">System Dynamics Review</span>, 16(2),
           pp. 135&#8211;148.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Nod15]  <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xnodedoc"></a>Node.js Foundation (2015) Node.js v5.1.1 documentation. Retrieved on 10
           Dec. 2015, URL <a 
href="https://nodejs.org/api/" class="url" ><span 
class="ectt-1200">https://nodejs.org/api/</span></a>.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [RCZS14] <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xrokicki_competitive_2014"></a>Rokicki, M., Chelaru, S., Zerr, S., and Siersdorfer, S. (2014) Competitive
           Game  Designs  for  Improving  the  Cost  Effectiveness  of  Crowdsourcing.  In
           <span 
class="ecti-1200">Proceedings  of  the  23rd  ACM  International  Conference  on  Conference  on</span>
           <span 
class="ecti-1200">Information and Knowledge Management</span>, CIKM &#8217;14, pp. 1469&#8211;1478, ACM, New
           York, NY, USA, URL <a 
href="http://doi.acm.org/10.1145/2661829.2661946" class="url" ><span 
class="ectt-1200">http://doi.acm.org/10.1145/2661829.2661946</span></a>.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [RH11]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xskill"></a>Riedel, J. and Hauge, J.B. (2011) State of the art of serious games for business
           and industry. In <span 
class="ecti-1200">Proceedings of the 17th International Conference on Concurrent</span>
           <span 
class="ecti-1200">Enterprising (ICE), 2011</span>, pp. 1&#8211;8, IEEE.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [RM57]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xricciardi"></a>Ricciardi, F.M. and Marting, E. (1957) <span 
class="ecti-1200">Top management decision simulation:</span>
           <span 
class="ecti-1200">The AMA approach</span>. American Management Association.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [RR00]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsa1"></a>Ravid,  G.  and  Rafaeli,  S.  (2000)  Multi  player,  internet  and  java  based
           simulation games: Learning and research in implementing a computerized version
           of the &#8220;Beer distribution supply game&#8221;. <span 
class="ecti-1200">Simulation Series</span>, 32(2), pp. 15&#8211;22.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Sec86]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbsd"></a>Sechrest, S. (1986) An Introductory 4.4 BSD Interprocess Communication
           Tutorial.   <span 
class="ecti-1200">Computer   Science   Research   Group,   Department   of   Electrical</span>
           <span 
class="ecti-1200">Engineering and Computer Science, University of California, Berkeley</span>.
                                                                                         
                                                                                         
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Ste89]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbeergame"></a>Sterman,  J.D.  (1989)  Modeling  managerial  behavior:  Misperceptions  of
           feedback in a dynamic decision making experiment. <span 
class="ecti-1200">Management science</span>, 35(3),
           pp. 321&#8211;339.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Ste14]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsterman"></a>Sterman,  J.  (2014)  Interactive  web-based  simulations  for  strategy  and
           sustainability: The MIT Sloan LearningEdge management flight simulators, Part
           I. <span 
class="ecti-1200">System Dynamics Review</span>, 30(1-2), pp. 89&#8211;121.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Str15]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xstratx"></a>Stratx Simulations (2015) Markstrat. <a 
href="http://web.stratxsimulations.com/simulation/strategic-marketing-simulation" class="url" ><span 
class="ectt-1200">http://web.stratxsimulations.com/simulation/strategic-_marketing-_simulation</span></a>,
           retrieved on 15 Dec. 2015.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [STT<sup><span 
class="cmr-8">+</span></sup>03] <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbmdsagent2"></a>Shirai, H., Tanabu, M., Terano, T., Kuno, Y., Suzuki, H., and Tsuda, K.
           (2003) Game development toolkit for business people in Japan. <span 
class="ecti-1200">Simulation &amp;</span>
           <span 
class="ecti-1200">Gaming</span>, 34(3), pp. 437&#8211;446.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Sum04]  <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsummers"></a>Summers, G.J. (2004) Today&#8217;s business simulation industry. <span 
class="ecti-1200">Simulation &amp;</span>
           <span 
class="ecti-1200">Gaming</span>, 35(2), pp. 208&#8211;241.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Tan08]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xybg1"></a>Tanabu,  M.  (2008)  Facilitating  business  gaming  simulation  modeling.
           <span 
class="ecti-1200">Developments in Business Simulation and Experiential Learning</span>, 35, pp. 360&#8211;367.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Tan11]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xjapanisch"></a>Tanabu, M. (2011) Design and implementation of a language for business
           simulation games (japanese). <span 
class="ecti-1200">Yokohama Business Review</span>, 32(2), pp. 267&#8211;292,
           URL <a 
href="http://ci.nii.ac.jp/naid/40019252737/en/" class="url" ><span 
class="ectt-1200">http://ci.nii.ac.jp/naid/40019252737/en/</span></a>.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [TS10]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xybg2"></a>Tanabu, M. and Shirai, H. (2010) A Platform for Business Games - From
           Game Playing to Game Making: The Case of Yokohama National University.
           <span 
class="ecti-1200">Developments in Business Simulation and Experiential Learning</span>, 37.
           </p>
                                                                                         
                                                                                         
           <p class="bibitem" ><span class="biblabel">
 [TSK<sup><span 
class="cmr-8">+</span></sup>99] <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbmdl2"></a>Terano,  T.,  Suzuki,  H.,  Kuno,  Y.,  Fujimori,  H.,  Shirai,  H.,  Nishio,
           C.,    Ogura,    N.,    and    Takahuashi,    M.    (1999)    Understanding    your
           business    through    home-made    simulator    development.    <span 
class="ecti-1200">Developments</span>
           <span 
class="ecti-1200">in     Business     Simulation     and     Experiential     Learning</span>,     26,     URL
           <a 
href="https://journals.tdl.org/absel/index.php/absel/article/view/930/899" class="url" ><span 
class="ectt-1200">https://journals.tdl.org/absel/index.php/absel/article/view/930/899</span></a>.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [TTK<sup><span 
class="cmr-8">+</span></sup>02]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbmdl1"></a>Tsuda, K., Terano, T., Kuno, Y., Shirai, H., and Suzuki, H. (2002) A compiler
           for  business  simulations:  Toward  business  model  development  by  yourselves.
           <span 
class="ecti-1200">Information Sciences</span>, 143(1), pp. 99&#8211;114.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [US14]   <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xuskov_serious_2014"></a>Uskov,  A.  and  Sekar,  B.  (2014)  Serious  games,  gamification  and  game
           engines to support framework activities in engineering: Case studies, analysis,
           classifications  and  outcomes.  In  <span 
class="ecti-1200">2014  IEEE  International  Conference  on</span>
           <span 
class="ecti-1200">Electro/Information Technology (EIT)</span>, pp. 618&#8211;623.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [Wol93]  <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xwolfe93"></a>Wolfe, J. (1993) A History of Business Teaching Games in English-speaking
           and Post-socialist Countries: The Origination and Diffusion of a Management
           Education  and  Development  Technology.  <span 
class="ecti-1200">Simulation  &amp;  Gaming</span>,  24(4),  pp.
           446&#8211;463, URL <a 
href="http://dx.doi.org/10.1177/1046878193244003" class="url" ><span 
class="ectt-1200">http://dx.doi.org/10.1177/1046878193244003</span></a>.
           </p>
           <p class="bibitem" ><span class="biblabel">
 [YTT09] <span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xbmdsinvest"></a>Yamashita, Y., Takahashi, H., and Terano, T. (2009) Learning a selection
           problem of investment projects and capital structure through business game. In
           <span 
class="ecti-1200">New Advances in Intelligent Decision Technologies</span>, pp. 41&#8211;50, Springer.
</p>
           </div>
 
</body></html> 

                                                                                         


